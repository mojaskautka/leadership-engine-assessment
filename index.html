<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Leadership Tradeoffs Assessment | LeaderFactor</title>
  <meta name="description" content="Discover your leadership engine and understand how you default under pressure. A mini-assessment revealing your leadership tradeoffs.">

  <!-- Open Graph / Social -->
  <meta property="og:title" content="Leadership Tradeoffs Assessment | LeaderFactor">
  <meta property="og:description" content="Every breath you take embodies a tradeoff. Do you know the leadership tradeoffs you're making?">
  <meta property="og:type" content="website">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fustat:wght@300;400;500;600;700&family=Spectral:ital,wght@0,400;0,600;0,700;1,400;1,600;1,700&display=swap" rel="stylesheet">

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- React -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>

  <style>
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      padding: 0;
      font-family: 'Fustat', sans-serif;
      background-color: #101322;
    }
    .spectral {
      font-family: 'Spectral', serif;
    }
    .fustat {
      font-family: 'Fustat', sans-serif;
    }

    /* Custom scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
    }
    ::-webkit-scrollbar-track {
      background: #101322;
    }
    ::-webkit-scrollbar-thumb {
      background: #3a3d4e;
      border-radius: 4px;
    }
    ::-webkit-scrollbar-thumb:hover {
      background: #4a4d5e;
    }

    /* Animations */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .animate-fade-in {
      animation: fadeIn 0.5s ease-out forwards;
    }

    @keyframes pulse-glow {
      0%, 100% { box-shadow: 0 0 20px rgba(118, 140, 18, 0.3); }
      50% { box-shadow: 0 0 30px rgba(6, 109, 177, 0.3); }
    }
    .pulse-glow {
      animation: pulse-glow 3s ease-in-out infinite;
    }

    /* ====================================
       LANDING PAGE - ANIMATED BACKGROUND
       ==================================== */
    .landing-page {
      min-height: 100vh;
      position: relative;
      overflow-x: hidden;
      background: #0f111a;
    }

    .landing-content {
      position: relative;
      z-index: 10;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      padding: 2rem;
      padding-top: 28vh;
    }

    .animated-background {
      position: fixed;
      inset: 0;
      z-index: 1;
      overflow: hidden;
      pointer-events: none;
    }

    .gradient-base {
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, #0f111a 0%, #1a1d2e 100%);
    }

    .gradient-base::after {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg,
        rgba(118, 140, 18, 0.05) 0%,
        rgba(6, 109, 177, 0.05) 50%,
        rgba(128, 43, 100, 0.05) 100%
      );
      opacity: 0.8;
      animation: gradientShift 20s ease infinite;
    }

    @keyframes gradientShift {
      0%, 100% { opacity: 0.8; }
      50% { opacity: 1; }
    }

    /* Organic Glow Orbs */
    .orb {
      position: absolute;
      border-radius: 50%;
      filter: blur(80px);
      opacity: 0;
      animation: orbFloat 20s ease-in-out infinite;
    }

    .orb-1 {
      width: 500px;
      height: 500px;
      background: radial-gradient(circle, rgba(118, 140, 18, 0.3) 0%, transparent 70%);
      top: -10%;
      left: -10%;
      animation-delay: 0s;
      animation-duration: 25s;
    }

    .orb-2 {
      width: 600px;
      height: 600px;
      background: radial-gradient(circle, rgba(6, 109, 177, 0.25) 0%, transparent 70%);
      top: 20%;
      right: -15%;
      animation-delay: 5s;
      animation-duration: 30s;
    }

    .orb-3 {
      width: 450px;
      height: 450px;
      background: radial-gradient(circle, rgba(128, 43, 100, 0.3) 0%, transparent 70%);
      bottom: -5%;
      left: 20%;
      animation-delay: 10s;
      animation-duration: 28s;
    }

    .orb-4 {
      width: 550px;
      height: 550px;
      background: radial-gradient(circle, rgba(6, 109, 177, 0.2) 0%, transparent 70%);
      bottom: 30%;
      right: 10%;
      animation-delay: 15s;
      animation-duration: 35s;
    }

    @keyframes orbFloat {
      0%, 100% {
        opacity: 0.2;
        transform: translate(0, 0) scale(1);
      }
      25% {
        opacity: 0.3;
        transform: translate(30px, -50px) scale(1.1);
      }
      50% {
        opacity: 0.25;
        transform: translate(-20px, 30px) scale(0.9);
      }
      75% {
        opacity: 0.35;
        transform: translate(40px, 20px) scale(1.05);
      }
    }

    /* ====================================
       TYPING SECTION - REDUCED FONT SIZES
       ==================================== */
    .typing-section {
      text-align: left;
      max-width: 700px;
      margin-bottom: 3rem;
      min-height: 220px;
    }

    .typed-line {
      margin-bottom: 1.5rem;
      min-height: 1.6em;
    }

    .typed-line p {
      font-family: 'Fustat', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      font-size: 1rem;
      font-weight: 400;
      line-height: 1.6;
      color: #ffffff;
      margin: 0;
      letter-spacing: -0.01em;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      text-rendering: optimizeLegibility;
      font-feature-settings: 'kern' 1;
      transform: translateZ(0);
      backface-visibility: hidden;
      min-height: 1.6em;
      display: block;
    }

    @media (min-width: 640px) {
      .typed-line p {
        font-size: 1.125rem;
      }
    }

    @media (min-width: 768px) {
      .typed-line p {
        font-size: 1.25rem;
      }
    }

    @media (min-width: 1024px) {
      .typed-line p {
        font-size: 1.375rem;
      }
    }

    @media (min-width: 1440px) {
      .typed-line p {
        font-size: 1.5rem;
      }
    }

    /* Emphasis styling */
    .emphasis-word {
      color: rgba(255, 255, 255, 0.95);
      font-weight: 500;
      letter-spacing: 0.02em;
      background: linear-gradient(135deg, rgba(128, 43, 100, 0.25) 0%, transparent 100%);
      padding: 0 0.15em;
      border-radius: 2px;
    }

    .emphasis-you {
      font-weight: 600;
      color: #ffffff;
      letter-spacing: 0.05em;
    }

    .cursor {
      display: inline-block;
      color: rgba(255, 255, 255, 0.7);
      font-family: 'Fustat', monospace;
      margin-left: 2px;
      animation: cursorBlink 1.06s steps(1, end) infinite;
    }

    @keyframes cursorBlink {
      0%, 49.9% { opacity: 1; }
      50%, 100% { opacity: 0; }
    }

    /* ====================================
       FORM CONTAINER
       ==================================== */
    /* Two-column layout for form section */
    .form-section-layout {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 4rem;
      width: 100%;
      max-width: 1100px;
      margin: 0 auto;
      margin-top: -12vh;
      padding: 0 2rem;
      padding-bottom: 8rem;
      opacity: 0;
      animation: formFadeIn 0.8s ease forwards;
    }

    .form-headline-column {
      flex: 1;
      max-width: 520px;
      position: relative;
      padding: 3rem 1.5rem;
      overflow: visible;
    }

    @media (max-width: 767px) {
      .form-headline-column {
        padding: 2rem;
      }
    }

    .form-headline {
      font-family: 'Fustat', sans-serif;
      font-size: 3rem;
      font-weight: 600;
      line-height: 1.15;
      color: #ffffff;
      margin: 0;
      letter-spacing: -0.02em;
      position: relative;
      z-index: 15;
    }

    .form-subtext {
      font-family: 'Fustat', sans-serif;
      font-size: 1.125rem;
      color: rgba(255, 255, 255, 0.6);
      margin: 1.25rem 0 0 0;
      line-height: 1.5;
    }

    .form-column {
      flex: 0 0 420px;
    }

    .form-container {
      width: 100%;
      max-width: 500px;
      margin: 0 auto;
    }

    /* Scroll indicator with text */
    .scroll-section {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.75rem;
    }

    .scroll-text {
      font-family: 'Fustat', sans-serif;
      font-size: 0.9375rem;
      color: rgba(255, 255, 255, 0.5);
      margin: 0;
    }

    .scroll-text.fade-in {
      animation: scrollTextFadeIn 0.6s ease-out forwards;
    }

    @keyframes scrollTextFadeIn {
      from {
        opacity: 0;
        transform: translateY(-5px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes formFadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .form-border {
      position: relative;
      padding: 3px;
      border-radius: 24px;
      background: linear-gradient(135deg,
        rgba(118, 140, 18, 0.3) 0%,
        rgba(6, 109, 177, 0.3) 50%,
        rgba(128, 43, 100, 0.3) 100%
      );
      clip-path: polygon(0 0, 0 0, 0 100%, 0 100%);
      animation: borderDraw 1s ease-in-out forwards;
    }

    @keyframes borderDraw {
      to { clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%); }
    }

    .landing-form {
      background: rgba(26, 29, 46, 0.8);
      backdrop-filter: blur(20px);
      border-radius: 22px;
      padding: 2.5rem;
      opacity: 0;
      animation: formContentFade 0.6s ease forwards 0.6s;
    }

    @keyframes formContentFade {
      to { opacity: 1; }
    }

    @media (min-width: 768px) {
      .landing-form {
        padding: 3rem;
      }
    }

    /* ====================================
       FORM FIELDS
       ==================================== */
    .form-field {
      position: relative;
      margin-bottom: 2rem;
    }

    .form-input {
      width: 100%;
      padding: 1.25rem 1.5rem;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      color: #ffffff;
      font-size: 1rem;
      transition: all 0.3s ease;
      outline: none;
      font-family: 'Fustat', sans-serif;
    }

    .form-input:hover {
      background: rgba(255, 255, 255, 0.08);
      border-color: rgba(255, 255, 255, 0.15);
    }

    .form-input:focus {
      background: rgba(255, 255, 255, 0.08);
      border-color: rgba(6, 109, 177, 0.5);
      box-shadow: 0 0 0 3px rgba(6, 109, 177, 0.1),
                  0 4px 12px rgba(0, 0, 0, 0.2);
    }

    /* Floating Label */
    .form-label {
      position: absolute;
      left: 1.5rem;
      top: 50%;
      transform: translateY(-50%);
      color: rgba(255, 255, 255, 0.5);
      font-size: 1rem;
      pointer-events: none;
      transition: all 0.3s ease;
      font-family: 'Fustat', sans-serif;
    }

    .form-label.active,
    .form-input:focus + .form-label {
      top: -0.75rem;
      left: 1rem;
      font-size: 0.75rem;
      color: rgba(6, 109, 177, 0.9);
      background: rgba(26, 29, 46, 0.95);
      padding: 0 0.5rem;
    }

    /* ====================================
       SUBMIT BUTTON
       ==================================== */
    .submit-button {
      width: 100%;
      padding: 1.25rem;
      background: linear-gradient(135deg, #768C12 0%, #066DB1 50%, #802B64 100%);
      border: none;
      border-radius: 12px;
      color: #ffffff;
      font-size: 1.125rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      font-family: 'Fustat', sans-serif;
    }

    .submit-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(118, 140, 18, 0.4),
                  0 0 40px rgba(6, 109, 177, 0.2);
    }

    .submit-button:active {
      transform: translateY(0);
    }

    /* ====================================
       TRUST SIGNALS
       ==================================== */
    .trust-signals {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.75rem;
      margin-top: 1.5rem;
      font-size: 0.875rem;
      color: rgba(255, 255, 255, 0.6);
      font-family: 'Fustat', sans-serif;
    }

    .separator {
      color: rgba(255, 255, 255, 0.3);
    }

    /* ====================================
       LOGO
       ==================================== */
    .logo-container {
      margin-top: 2rem;
      text-align: center;
      display: flex;
      justify-content: center;
    }

    .leaderfactor-logo {
      height: 22px;
      width: auto;
      opacity: 0.7;
      transition: opacity 0.3s ease;
    }

    .leaderfactor-logo:hover {
      opacity: 0.9;
    }

    /* ====================================
       SCROLL INDICATOR
       ==================================== */
    .scroll-indicator {
      position: absolute;
      bottom: 2rem;
      left: 50%;
      transform: translateX(-50%);
      z-index: 20;
      opacity: 0;
      animation: scrollIndicatorFade 0.8s ease forwards 1.5s;
    }

    @keyframes scrollIndicatorFade {
      to { opacity: 1; }
    }

    .chevron-down {
      color: rgba(255, 255, 255, 0.4);
      animation: bounce 2s infinite;
    }

    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(10px); }
    }

    /* ====================================
       PREVIEW SECTION
       ==================================== */
    /* ====================================
       ENHANCED PREVIEW SECTION
       ==================================== */
    .preview-section {
      width: 100%;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 6rem 2rem;
      position: relative;
      z-index: 10;
    }

    .preview-content {
      max-width: 1200px;
      margin: 0 auto;
      width: 100%;
    }

    .preview-title {
      font-family: 'Fustat', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      font-size: 2rem;
      font-weight: 600;
      color: #ffffff;
      text-align: center;
      margin-bottom: 4rem;
      letter-spacing: -0.02em;
      line-height: 1.2;
      opacity: 0;
      transform: translateY(20px);
      transition: all 0.8s ease;
    }

    .preview-title.visible {
      opacity: 1;
      transform: translateY(0);
    }

    @media (min-width: 768px) {
      .preview-title {
        font-size: 2.5rem;
      }
    }

    @media (min-width: 1024px) {
      .preview-title {
        font-size: 3rem;
      }
    }

    .preview-cta {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      background: none;
      border: none;
      font-family: 'Fustat', sans-serif;
      font-size: 0.9375rem;
      font-weight: 500;
      color: rgba(255, 255, 255, 0.6);
      cursor: pointer;
      margin: 0 auto 3rem auto;
      padding: 0.5rem 0;
      opacity: 0;
      transform: translateY(10px);
      transition: all 0.6s ease 0.2s;
    }

    .preview-cta.visible {
      opacity: 1;
      transform: translateY(0);
    }

    .preview-cta:hover {
      color: rgba(255, 255, 255, 0.9);
    }

    .preview-cta .cta-arrow {
      transition: transform 0.3s ease;
    }

    .preview-cta:hover .cta-arrow {
      transform: translateY(-3px);
    }

    /* ====================================
       PRE-ASSESSMENT SCREENS
       ==================================== */
    .pre-assessment-screen {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      position: relative;
      padding: 2rem;
      padding-top: 20vh;
    }

    /* Back button - universal */
    .back-button {
      position: fixed;
      top: 2rem;
      left: 2rem;
      z-index: 100;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.625rem 1rem;
      background: rgba(255, 255, 255, 0.08);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      color: rgba(255, 255, 255, 0.7);
      font-family: 'Fustat', sans-serif;
      font-size: 0.875rem;
      font-weight: 400;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .back-button:hover {
      background: rgba(255, 255, 255, 0.12);
      color: rgba(255, 255, 255, 0.9);
      border-color: rgba(255, 255, 255, 0.2);
    }

    .back-button svg {
      width: 16px;
      height: 16px;
    }

    @media (max-width: 767px) {
      .back-button {
        top: 1rem;
        left: 1rem;
        padding: 0.5rem 0.75rem;
        font-size: 0.8125rem;
      }

      /* Ensure screen content clears the back button on mobile */
      .screen-content {
        padding-top: 3.5rem;
      }
    }

    /* Skip button for progressive reveal */
    .skip-reveal-button {
      position: fixed;
      top: 2rem;
      right: 2rem;
      z-index: 100;
      padding: 0.625rem 1rem;
      background: rgba(255, 255, 255, 0.08);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      color: rgba(255, 255, 255, 0.6);
      font-family: 'Fustat', sans-serif;
      font-size: 0.875rem;
      font-weight: 400;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .skip-reveal-button:hover {
      background: rgba(255, 255, 255, 0.12);
      color: rgba(255, 255, 255, 0.85);
      border-color: rgba(255, 255, 255, 0.2);
    }

    @media (max-width: 767px) {
      .skip-reveal-button {
        top: 1rem;
        right: 1rem;
        padding: 0.5rem 0.75rem;
        font-size: 0.8125rem;
      }
    }

    /* Progress indicator */
    .progress-indicator {
      position: fixed;
      top: 2rem;
      left: 50%;
      transform: translateX(-50%);
      z-index: 100;
    }

    .progress-dots {
      display: flex;
      gap: 1rem;
    }

    .progress-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.2);
      transition: all 0.3s ease;
    }

    .progress-dot.active {
      background: rgba(255, 255, 255, 0.7);
      transform: scale(1.3);
    }

    .progress-dot.complete {
      background: rgba(118, 140, 18, 0.7);
    }

    /* Screen content */
    .screen-content {
      max-width: 800px;
      width: 100%;
      position: relative;
      z-index: 10;
    }

    /* Typed headline */
    .screen-headline {
      margin-bottom: 2.5rem;
      text-align: left;
    }

    .screen-headline h1 {
      font-family: 'Fustat', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      font-size: 2.25rem;
      font-weight: 400;
      line-height: 1.3;
      color: #ffffff;
      letter-spacing: -0.02em;
      -webkit-font-smoothing: antialiased;
      margin: 0;
    }

    @media (min-width: 768px) {
      .screen-headline h1 {
        font-size: 2.75rem;
      }
    }

    .screen-headline .cursor {
      display: inline-block;
      color: rgba(255, 255, 255, 0.7);
      margin-left: 2px;
      animation: cursorBlink 1.06s steps(1, end) infinite;
    }

    /* Screen body */
    .screen-body {
      display: flex;
      flex-direction: column;
      gap: 2.5rem;
      opacity: 0;
      transform: translateY(20px);
      transition: all 0.6s ease;
    }

    .screen-body.visible {
      opacity: 1;
      transform: translateY(0);
    }

    @media (min-width: 768px) {
      .screen-body {
        flex-direction: row;
        align-items: flex-start;
        gap: 4rem;
      }
    }

    .body-text {
      flex: 1;
      text-align: left;
    }

    .body-text p {
      font-family: 'Fustat', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      font-size: 1.125rem;
      font-weight: 400;
      line-height: 1.7;
      color: rgba(255, 255, 255, 0.75);
      margin: 0 0 1.25rem 0;
    }

    .body-text p:last-child {
      margin-bottom: 0;
    }

    .body-text .bullet-list {
      margin-top: 0.75rem;
    }

    .body-text .bullet-item {
      display: flex;
      align-items: flex-start;
      gap: 0.75rem;
      margin-bottom: 0.75rem;
      font-family: 'Fustat', sans-serif;
      font-size: 1.125rem;
      color: rgba(255, 255, 255, 0.75);
      line-height: 1.5;
    }

    .body-text .bullet-item::before {
      content: '•';
      color: rgba(118, 140, 18, 0.8);
      font-weight: bold;
    }

    .screen-visual {
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .screen-visual svg {
      filter: drop-shadow(0 4px 12px rgba(0, 0, 0, 0.2));
    }

    /* Footer / button */
    .screen-footer {
      margin-top: 0.5rem;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      gap: 1rem;
      opacity: 0;
      transform: translateY(20px);
      transition: all 0.6s ease 0.2s;
    }

    .screen-footer.visible {
      opacity: 1;
      transform: translateY(0);
    }

    .continue-button {
      padding: 1rem 2.5rem;
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.12) 0%, rgba(255, 255, 255, 0.05) 100%);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 50px;
      color: #ffffff;
      font-family: 'Fustat', sans-serif;
      font-size: 1rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
    }

    .continue-button:hover {
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.2) 0%, rgba(255, 255, 255, 0.1) 100%);
      border-color: rgba(255, 255, 255, 0.35);
      transform: translateY(-2px);
    }

    .continue-button:active {
      transform: translateY(0);
    }

    .auto-advance-hint {
      font-family: 'Fustat', sans-serif;
      font-size: 0.8125rem;
      color: rgba(255, 255, 255, 0.35);
    }

    /* Pre-assessment responsive */
    @media (max-width: 767px) {
      .pre-assessment-screen {
        padding-top: 15vh;
      }

      .screen-headline h1 {
        font-size: 1.75rem;
      }

      .body-text p,
      .body-text .bullet-item {
        font-size: 1rem;
      }

      .screen-visual svg {
        width: 280px;
        height: 280px;
      }

      .continue-button {
        width: 100%;
        text-align: center;
      }

      .screen-footer {
        align-items: stretch;
      }
    }

    /* ====================================
       POST-ASSESSMENT SCREENS
       ==================================== */

    .post-assessment-screen,
    .calculating-screen {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      position: relative;
      padding: 2rem;
    }

    /* ====================================
       CALCULATING SCREEN
       ==================================== */

    .calculating-content {
      text-align: center;
      max-width: 600px;
      position: relative;
      z-index: 10;
    }

    .calculating-headline h2 {
      font-family: 'Fustat', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      font-size: 2rem;
      font-weight: 400;
      color: rgba(255, 255, 255, 0.9);
      letter-spacing: -0.01em;
      margin-bottom: 3rem;
      min-height: 3rem;
    }

    @media (min-width: 768px) {
      .calculating-headline h2 {
        font-size: 2.5rem;
      }
    }

    .calculating-headline .cursor {
      display: inline-block;
      color: rgba(255, 255, 255, 0.7);
      margin-left: 2px;
      animation: cursorBlink 1.06s steps(1, end) infinite;
    }

    .pattern-animation {
      display: flex;
      justify-content: center;
      align-items: center;
      opacity: 0;
      transform: scale(0.8);
      transition: all 0.6s ease;
    }

    .pattern-animation.visible {
      opacity: 1;
      transform: scale(1);
    }

    /* Pattern visualization animations */
    @keyframes patternPulse {
      0%, 100% { transform: scale(1); opacity: 0.6; }
      50% { transform: scale(1.8); opacity: 0; }
    }

    @keyframes nodeAppear {
      0% { transform: scale(0); opacity: 0; }
      100% { transform: scale(1); opacity: 1; }
    }

    @keyframes lineGrow {
      0% { stroke-dashoffset: 100; }
      100% { stroke-dashoffset: 0; }
    }

    .pattern-node {
      animation: nodeAppear 0.4s ease forwards;
    }

    .pattern-line {
      stroke-dasharray: 100;
      stroke-dashoffset: 100;
      animation: lineGrow 0.6s ease forwards;
    }

    .pattern-pulse {
      animation: patternPulse 1.5s ease-out infinite;
    }

    /* ====================================
       ENGINE EDUCATION SCREEN
       ==================================== */

    .engine-screen-content {
      max-width: 900px;
      width: 100%;
      position: relative;
      z-index: 10;
    }

    /* Engine Headline */
    .engine-headline {
      text-align: center;
      margin-bottom: 3rem;
    }

    .engine-headline h1 {
      font-family: 'Fustat', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      font-size: 2rem;
      font-weight: 400;
      line-height: 1.3;
      color: rgba(255, 255, 255, 0.9);
      letter-spacing: -0.02em;
      margin: 0;
      min-height: 3rem;
    }

    @media (min-width: 768px) {
      .engine-headline h1 {
        font-size: 2.75rem;
      }
    }

    @media (min-width: 1024px) {
      .engine-headline h1 {
        font-size: 3.25rem;
      }
    }

    .engine-name {
      font-weight: 600;
      letter-spacing: 0.02em;
    }

    .engine-headline .cursor {
      display: inline-block;
      color: rgba(255, 255, 255, 0.7);
      margin-left: 4px;
      animation: cursorBlink 1.06s steps(1, end) infinite;
    }

    /* Engine Content Layout */
    .engine-content {
      margin-bottom: 3rem;
      opacity: 0;
      transform: translateY(20px);
      transition: all 0.6s ease;
    }

    .engine-content.visible {
      opacity: 1;
      transform: translateY(0);
    }

    .content-layout {
      display: flex;
      flex-direction: column;
      gap: 3rem;
    }

    @media (min-width: 768px) {
      .content-layout {
        flex-direction: row;
        align-items: center;
        gap: 4rem;
      }
    }

    .engine-description {
      flex: 1;
      text-align: left;
    }

    .intro-text {
      font-family: 'Fustat', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      font-size: 1.125rem;
      font-weight: 500;
      color: rgba(255, 255, 255, 0.9);
      margin: 0 0 1.5rem 0;
    }

    .engine-strengths {
      list-style: none;
      padding: 0;
      margin: 0 0 2rem 0;
    }

    .engine-strengths li {
      font-family: 'Fustat', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      font-size: 1.0625rem;
      line-height: 1.7;
      color: rgba(255, 255, 255, 0.8);
      margin-bottom: 1rem;
      padding-left: 1.5rem;
      position: relative;
      opacity: 0;
      transform: translateX(-20px);
      transition: all 0.5s ease;
    }

    .engine-strengths li.visible {
      opacity: 1;
      transform: translateX(0);
    }

    .engine-strengths li::before {
      content: '•';
      position: absolute;
      left: 0;
      color: rgba(255, 255, 255, 0.5);
      font-weight: 700;
    }

    .engine-default {
      font-family: 'Fustat', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      font-size: 1.125rem;
      font-weight: 500;
      line-height: 1.6;
      color: rgba(255, 255, 255, 0.85);
      font-style: italic;
      padding-top: 1.5rem;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
      margin: 0;
      opacity: 0;
      transition: opacity 0.6s ease;
    }

    .engine-default.visible {
      opacity: 1;
    }

    /* Engine Visual */
    .engine-visual {
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .engine-visual svg {
      filter: drop-shadow(0 4px 16px rgba(0, 0, 0, 0.3));
    }

    /* Engine Footer / Button */
    .engine-footer {
      text-align: center;
      margin-top: 2rem;
      opacity: 0;
      transform: translateY(20px);
      transition: all 0.6s ease 0.2s;
    }

    .engine-footer.visible {
      opacity: 1;
      transform: translateY(0);
    }

    .reveal-button {
      padding: 1.25rem 3rem;
      background: linear-gradient(135deg, #768C12 0%, #066DB1 50%, #802B64 100%);
      border: none;
      border-radius: 12px;
      color: #ffffff;
      font-family: 'Fustat', sans-serif;
      font-size: 1.125rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    }

    .reveal-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(118, 140, 18, 0.4);
    }

    .reveal-button:active {
      transform: translateY(0);
    }

    .reveal-button:focus-visible {
      outline: 2px solid #066DB1;
      outline-offset: 4px;
    }

    /* Post-assessment responsive */
    @media (max-width: 767px) {
      .engine-headline h1 {
        font-size: 1.75rem;
      }

      .calculating-headline h2 {
        font-size: 1.5rem;
      }

      .intro-text {
        font-size: 1rem;
      }

      .engine-strengths li {
        font-size: 0.9375rem;
      }

      .engine-default {
        font-size: 1rem;
      }

      .engine-visual svg {
        width: 200px;
        height: 200px;
      }

      .reveal-button {
        width: 100%;
      }

      .pattern-animation svg {
        width: 240px;
        height: 160px;
      }
    }

    /* ====================================
       RESULTS PAGE - NARRATIVE + CARDS
       ==================================== */

    /* Mobile: Override min-h-screen for results page hero */
    @media (max-width: 767px) {
      .min-h-screen.flex.flex-col.justify-center.items-center {
        min-height: auto;
        padding-top: 5rem;
        padding-bottom: 3rem;
      }
    }

    .results-section {
      margin-bottom: 5rem;
      padding: 0 1rem;
    }

    .section-narrative {
      max-width: 65ch;
      margin: 0 auto 3rem;
    }

    .cards-eyebrow {
      font-family: 'Fustat', sans-serif;
      font-size: 0.984rem;
      font-weight: 500;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: rgba(255, 255, 255, 0.35);
      margin-bottom: 0.875rem;
      text-align: center;
    }

    .section-headline {
      font-family: 'Spectral', serif;
      font-size: 1.75rem;
      font-weight: 600;
      font-style: italic;
      color: #ffffff;
      margin-bottom: 1.5rem;
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    @media (min-width: 768px) {
      .section-headline {
        font-size: 2rem;
      }
    }

    .section-narrative p {
      font-family: 'Fustat', sans-serif;
      font-size: 1.125rem;
      line-height: 1.75;
      color: rgba(255, 255, 255, 0.88);
      margin-bottom: 1.5rem;
    }

    .section-narrative p:last-child {
      margin-bottom: 0;
    }

    .narrative-highlight {
      color: #ffffff;
      font-weight: 500;
    }

    .narrative-cost {
      color: rgba(251, 146, 60, 0.9);
    }

    .section-cards {
      display: grid;
      grid-template-columns: 1fr;
      gap: 1.5rem;
      max-width: 900px;
      margin: 0 auto;
    }

    @media (min-width: 640px) {
      .section-cards {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    @media (min-width: 900px) {
      .section-cards.three-col {
        grid-template-columns: repeat(3, 1fr);
      }
    }

    .summary-card {
      padding: 1.75rem;
      border-radius: 1.25rem;
      background: rgba(255, 255, 255, 0.04);
      border: 1px solid rgba(255, 255, 255, 0.08);
      transition: all 0.3s ease;
    }

    .summary-card:hover {
      background: rgba(255, 255, 255, 0.07);
      border-color: rgba(255, 255, 255, 0.15);
      transform: translateY(-2px);
    }

    .card-icon {
      font-size: 2rem;
      margin-bottom: 1rem;
      display: block;
    }

    .card-label {
      font-family: 'Fustat', sans-serif;
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: rgba(255, 255, 255, 0.5);
      margin-bottom: 0.5rem;
    }

    .card-title {
      font-family: 'Fustat', sans-serif;
      font-size: 1.125rem;
      font-weight: 600;
      color: #ffffff;
      margin-bottom: 0.5rem;
    }

    .card-description {
      font-family: 'Fustat', sans-serif;
      font-size: 0.9375rem;
      line-height: 1.6;
      color: rgba(255, 255, 255, 0.7);
    }

    .card-quote {
      font-family: 'Spectral', serif;
      font-style: italic;
      font-size: 1rem;
      line-height: 1.6;
      color: rgba(255, 255, 255, 0.85);
    }

    /* Card variants */
    .summary-card.gift-card {
      border-left: 3px solid rgba(118, 140, 18, 0.6);
    }

    /* Domain-specific accent colors for skill cards */
    .summary-card.domain-lead-self {
      border-left: 3px solid rgba(118, 140, 18, 0.7);
    }

    .summary-card.domain-lead-team {
      border-left: 3px solid rgba(6, 109, 177, 0.7);
    }

    .summary-card.domain-lead-org {
      border-left: 3px solid rgba(128, 43, 100, 0.7);
    }

    .summary-card.cost-card {
      border-left: 3px solid rgba(251, 146, 60, 0.6);
      background: rgba(251, 146, 60, 0.05);
    }

    .summary-card.best-card {
      border-left: 3px solid rgba(6, 109, 177, 0.6);
    }

    .summary-card.warning-card {
      background: rgba(251, 146, 60, 0.08);
      border-color: rgba(251, 146, 60, 0.2);
    }

    .summary-card.balance-card {
      background: rgba(118, 140, 18, 0.08);
      border-color: rgba(118, 140, 18, 0.2);
    }

    .summary-card.partner-card {
      background: rgba(6, 109, 177, 0.08);
      border-color: rgba(6, 109, 177, 0.2);
    }

    .summary-card.tension-card {
      background: rgba(128, 43, 100, 0.08);
      border-color: rgba(128, 43, 100, 0.2);
    }

    /* Axis visualization in cards */
    .axis-card {
      padding: 1.5rem;
    }

    .axis-skill-name {
      font-family: 'Spectral', serif;
      font-size: 1rem;
      font-weight: 600;
      font-style: italic;
      color: #ffffff;
      margin-bottom: 1rem;
    }

    .axis-bar-container {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 0.75rem;
    }

    .axis-pole {
      font-family: 'Fustat', sans-serif;
      font-size: 0.8125rem;
      min-width: 70px;
      color: rgba(255, 255, 255, 0.5);
    }

    .axis-pole.active {
      color: #ffffff;
      font-weight: 600;
    }

    .axis-pole.right {
      text-align: right;
    }

    .axis-bar {
      flex: 1;
      height: 6px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 3px;
      position: relative;
    }

    .axis-marker {
      position: absolute;
      top: 50%;
      transform: translate(-50%, -50%);
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background: linear-gradient(135deg, #768C12, #066DB1);
      box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.15);
    }

    .axis-your-position {
      font-family: 'Fustat', sans-serif;
      font-size: 0.8125rem;
      color: rgba(255, 255, 255, 0.6);
      text-align: center;
    }

    /* Warning signs list */
    .warning-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .warning-list li {
      font-family: 'Fustat', sans-serif;
      font-size: 0.9375rem;
      line-height: 1.6;
      color: rgba(255, 255, 255, 0.8);
      padding: 0.75rem 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.08);
      display: flex;
      align-items: flex-start;
      gap: 0.75rem;
    }

    .warning-list li:last-child {
      border-bottom: none;
    }

    .warning-list li .warning-icon {
      flex-shrink: 0;
      margin-top: 2px;
    }

    /* Balance moves list */
    .balance-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .balance-list li {
      font-family: 'Fustat', sans-serif;
      font-size: 0.9375rem;
      line-height: 1.6;
      color: rgba(255, 255, 255, 0.8);
      padding: 0.75rem 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.08);
      display: flex;
      align-items: flex-start;
      gap: 0.75rem;
    }

    .balance-list li:last-child {
      border-bottom: none;
    }

    .balance-list li .balance-icon {
      flex-shrink: 0;
      margin-top: 2px;
    }

    /* Compatibility cards */
    .compat-persona {
      font-family: 'Spectral', serif;
      font-size: 1.125rem;
      font-weight: 600;
      font-style: italic;
      color: #ffffff;
      margin-bottom: 0.5rem;
    }

    .compat-persona.clickable-persona {
      color: rgba(255, 255, 255, 0.9);
      transition: color 0.2s, transform 0.2s;
    }

    .compat-persona.clickable-persona:hover {
      color: #ffffff;
      text-decoration: underline;
      text-underline-offset: 3px;
    }

    .compat-why {
      font-family: 'Fustat', sans-serif;
      font-size: 0.9375rem;
      line-height: 1.6;
      color: rgba(255, 255, 255, 0.75);
    }

    /* ====================================
       SHARE YOUR PATTERN SECTION
       ==================================== */

    .share-section {
      padding: 4rem 1rem 3rem;
      position: relative;
      z-index: 10;
    }

    .share-content {
      max-width: 700px;
      margin: 0 auto;
    }

    .share-heading {
      font-family: 'Spectral', serif;
      font-size: 1.75rem;
      font-weight: 600;
      font-style: italic;
      color: #ffffff;
      text-align: center;
      margin-bottom: 2.5rem;
    }

    @media (min-width: 768px) {
      .share-heading {
        font-size: 2rem;
      }
    }

    /* Card Preview */
    .card-preview-wrapper {
      display: flex;
      justify-content: center;
      margin-bottom: 2.5rem;
    }

    .shareable-card {
      width: 100%;
      max-width: 540px;
      height: 380px;
      padding: 2.5rem 2rem;
      border-radius: 1.5rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      position: relative;
      border: 1px solid rgba(255, 255, 255, 0.12);
      box-shadow: 0 12px 48px rgba(0, 0, 0, 0.4);
      background: linear-gradient(135deg, rgba(16, 19, 34, 0.98), rgba(16, 19, 34, 0.92));
      overflow: hidden;
    }

    @media (max-width: 640px) {
      .shareable-card {
        height: 320px;
        padding: 2rem 1.5rem;
      }
    }

    .card-gradient-overlay {
      position: absolute;
      inset: 0;
      border-radius: 1.5rem;
      opacity: 0.5;
      pointer-events: none;
    }

    /* Vignette effect */
    .shareable-card::after {
      content: '';
      position: absolute;
      inset: 0;
      border-radius: 1.5rem;
      background: radial-gradient(ellipse at center, transparent 30%, rgba(0, 0, 0, 0.25) 100%);
      pointer-events: none;
    }

    /* Corner Decorations */
    .corner-decoration {
      position: absolute;
      width: 45px;
      height: 45px;
      border: 2px solid rgba(255, 255, 255, 0.1);
      border-radius: 6px;
      pointer-events: none;
      z-index: 2;
    }

    .corner-decoration.top-left {
      top: 1.25rem;
      left: 1.25rem;
      border-right: none;
      border-bottom: none;
    }

    .corner-decoration.bottom-right {
      bottom: 1.25rem;
      right: 1.25rem;
      border-top: none;
      border-left: none;
    }

    @media (max-width: 640px) {
      .corner-decoration {
        width: 32px;
        height: 32px;
      }
    }

    /* Cluster Accent Bar */
    .cluster-accent-bar {
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 4px;
      border-radius: 1.5rem 0 0 1.5rem;
      opacity: 0.6;
      pointer-events: none;
      z-index: 2;
    }

    .card-inner {
      position: relative;
      z-index: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100%;
      width: 100%;
    }

    /* Glowing Icon */
    .shareable-card .card-icon {
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 1rem;
      filter: drop-shadow(0 0 20px rgba(255, 255, 255, 0.25));
      animation: icon-glow 4s ease-in-out infinite;
    }

    .shareable-card .card-icon svg {
      width: 56px;
      height: 56px;
    }

    @keyframes icon-glow {
      0%, 100% {
        transform: scale(1);
        filter: drop-shadow(0 0 20px rgba(255, 255, 255, 0.25));
      }
      50% {
        transform: scale(1.06);
        filter: drop-shadow(0 0 28px rgba(255, 255, 255, 0.35));
      }
    }

    @media (prefers-reduced-motion: reduce) {
      .shareable-card .card-icon {
        animation: none;
      }
    }

    @media (min-width: 640px) {
      .shareable-card .card-icon svg {
        width: 64px;
        height: 64px;
      }
      .shareable-card .card-icon {
        margin-bottom: 1.25rem;
      }
    }

    .card-persona-name {
      font-family: 'Spectral', serif;
      font-size: 1.75rem;
      font-weight: 700;
      font-style: italic;
      color: #ffffff;
      margin: 0;
      letter-spacing: -0.01em;
      text-shadow: 0 2px 12px rgba(0, 0, 0, 0.3);
    }

    @media (min-width: 640px) {
      .card-persona-name {
        font-size: 2.5rem;
      }
    }

    .card-cluster-name {
      font-family: 'Fustat', sans-serif;
      font-size: 0.8125rem;
      font-weight: 500;
      color: rgba(255, 255, 255, 0.65);
      text-transform: uppercase;
      letter-spacing: 0.15em;
      margin: 0.5rem 0 0 0;
    }

    @media (min-width: 640px) {
      .card-cluster-name {
        font-size: 1rem;
      }
    }

    /* Enhanced Divider */
    .card-divider-wrapper {
      position: relative;
      width: 60%;
      margin: 1.5rem 0;
    }

    .card-divider {
      width: 100%;
      height: 1px;
      background: rgba(255, 255, 255, 0.12);
    }

    .divider-accent {
      position: absolute;
      top: -1px;
      left: 50%;
      transform: translateX(-50%);
      width: 50%;
      height: 2px;
      border-radius: 1px;
    }

    @media (min-width: 640px) {
      .card-divider-wrapper {
        margin: 2rem 0;
      }
    }

    .card-insight {
      font-family: 'Fustat', sans-serif;
      font-size: 1rem;
      font-style: italic;
      font-weight: 400;
      line-height: 1.5;
      color: rgba(255, 255, 255, 0.92);
      margin: 0;
      max-width: 88%;
      text-shadow: 0 1px 6px rgba(0, 0, 0, 0.2);
    }

    @media (min-width: 640px) {
      .card-insight {
        font-size: 1.1875rem;
      }
    }

    .card-footer {
      position: absolute;
      bottom: 1.25rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    @media (min-width: 640px) {
      .card-footer {
        bottom: 1.25rem;
      }
    }

    .card-brand {
      font-family: 'Fustat', sans-serif;
      font-size: 0.6875rem;
      font-weight: 500;
      color: rgba(255, 255, 255, 0.4);
      letter-spacing: 0.05em;
    }

    /* Share Actions */
    .share-actions {
      text-align: center;
    }

    .share-prompt {
      font-family: 'Fustat', sans-serif;
      font-size: 1rem;
      color: rgba(255, 255, 255, 0.7);
      margin-bottom: 1.5rem;
    }

    .action-buttons {
      display: flex;
      gap: 1rem;
      justify-content: center;
      flex-wrap: wrap;
      margin-bottom: 1.5rem;
    }

    .share-button {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.875rem 1.5rem;
      font-family: 'Fustat', sans-serif;
      font-size: 0.9375rem;
      font-weight: 600;
      border: none;
      border-radius: 0.75rem;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .share-button.primary {
      background: linear-gradient(135deg, #768C12 0%, #066DB1 50%, #802B64 100%);
      color: #ffffff;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);
    }

    .share-button.primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(118, 140, 18, 0.3);
    }

    .share-button.secondary {
      background: rgba(255, 255, 255, 0.08);
      color: #ffffff;
      border: 1px solid rgba(255, 255, 255, 0.15);
    }

    .share-button.secondary:hover {
      background: rgba(255, 255, 255, 0.12);
      border-color: rgba(255, 255, 255, 0.25);
    }

    .share-button:active {
      transform: translateY(0);
    }

    @media (max-width: 500px) {
      .action-buttons {
        flex-direction: column;
      }

      .share-button {
        width: 100%;
        justify-content: center;
      }
    }

    /* Success Toast */
    .success-toast {
      padding: 0.875rem 1.25rem;
      background: rgba(118, 140, 18, 0.15);
      border: 1px solid rgba(118, 140, 18, 0.3);
      border-radius: 0.5rem;
      color: rgba(255, 255, 255, 0.9);
      font-family: 'Fustat', sans-serif;
      font-size: 0.875rem;
      text-align: center;
      animation: fadeInUp 0.3s ease;
    }

    /* Continue Section */
    .continue-section {
      margin-top: 3rem;
      padding-top: 2rem;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
    }

    .continue-card {
      padding: 2rem;
      border-radius: 1rem;
      background: rgba(255, 255, 255, 0.04);
      border: 1px solid rgba(255, 255, 255, 0.08);
      text-align: center;
    }

    .continue-title {
      font-family: 'Spectral', serif;
      font-size: 1.25rem;
      font-weight: 600;
      font-style: italic;
      color: #ffffff;
      margin: 0 0 0.75rem 0;
    }

    .continue-text {
      font-family: 'Fustat', sans-serif;
      font-size: 0.9375rem;
      color: rgba(255, 255, 255, 0.7);
      margin: 0 0 1.5rem 0;
    }

    .continue-link {
      display: inline-block;
      padding: 0.875rem 1.75rem;
      font-family: 'Fustat', sans-serif;
      font-size: 0.9375rem;
      font-weight: 600;
      color: #ffffff;
      background: linear-gradient(135deg, #768C12 0%, #066DB1 50%, #802B64 100%);
      border-radius: 0.75rem;
      text-decoration: none;
      transition: all 0.2s ease;
    }

    .continue-link:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(118, 140, 18, 0.3);
    }

    .retake-button {
      display: block;
      margin-top: 1.5rem;
      font-family: 'Fustat', sans-serif;
      font-size: 0.875rem;
      color: rgba(255, 255, 255, 0.5);
      background: none;
      border: none;
      cursor: pointer;
      transition: color 0.2s ease;
    }

    .retake-button:hover {
      color: rgba(255, 255, 255, 0.8);
    }

    .share-footer {
      margin-top: 2.5rem;
      padding-top: 1.5rem;
      border-top: 1px solid rgba(255, 255, 255, 0.08);
      text-align: center;
    }

    .share-footer p {
      font-family: 'Fustat', sans-serif;
      font-size: 0.75rem;
      color: rgba(255, 255, 255, 0.4);
      margin: 0;
    }

    /* Animation classes */
    .fade-in-up {
      opacity: 0;
      transform: translateY(20px);
      animation: fadeInUp 0.6s ease forwards;
    }

    @keyframes fadeInUp {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .stagger-1 { animation-delay: 0.1s; }
    .stagger-2 { animation-delay: 0.2s; }
    .stagger-3 { animation-delay: 0.3s; }
    .stagger-4 { animation-delay: 0.4s; }

    /* ====================================
       BENEFIT CARDS GRID
       ==================================== */
    .preview-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 2rem;
      max-width: 1100px;
      margin: 0 auto;
    }

    @media (min-width: 768px) {
      .preview-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    @media (min-width: 1024px) {
      .preview-grid {
        grid-template-columns: repeat(3, 1fr);
        gap: 2.5rem;
      }
    }

    /* ====================================
       BENEFIT CARD
       ==================================== */
    .benefit-card {
      position: relative;
      padding: 3rem 2rem;
      background: rgba(26, 29, 46, 0.6);
      backdrop-filter: blur(20px);
      border-radius: 24px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      overflow: hidden;
      cursor: pointer;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      opacity: 0;
      transform: translateY(30px);
    }

    .benefit-card.visible {
      opacity: 1;
      transform: translateY(0);
    }

    .benefit-card:hover {
      border-color: rgba(255, 255, 255, 0.2);
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
      transform: translateY(-8px);
    }

    .benefit-card.visible:hover {
      transform: translateY(-8px);
    }

    /* Background Number */
    .card-number {
      position: absolute;
      top: 1rem;
      right: 1.5rem;
      font-family: 'Fustat', sans-serif;
      font-size: 5rem;
      font-weight: 700;
      color: rgba(255, 255, 255, 0.03);
      line-height: 1;
      user-select: none;
      pointer-events: none;
    }

    /* Gradient Border Glow */
    .card-border-glow {
      position: absolute;
      inset: -2px;
      border-radius: 24px;
      opacity: 0;
      transition: opacity 0.4s ease;
      pointer-events: none;
    }

    .benefit-card:hover .card-border-glow {
      opacity: 1;
    }

    /* Color Schemes */
    .benefit-card.warm .card-border-glow {
      background: linear-gradient(135deg,
        rgba(128, 43, 100, 0.3) 0%,
        rgba(155, 61, 122, 0.3) 100%
      );
      box-shadow: 0 0 30px rgba(128, 43, 100, 0.2);
    }

    .benefit-card.cool .card-border-glow {
      background: linear-gradient(135deg,
        rgba(6, 109, 177, 0.3) 0%,
        rgba(0, 180, 216, 0.3) 100%
      );
      box-shadow: 0 0 30px rgba(6, 109, 177, 0.2);
    }

    .benefit-card.success .card-border-glow {
      background: linear-gradient(135deg,
        rgba(118, 140, 18, 0.3) 0%,
        rgba(138, 166, 20, 0.3) 100%
      );
      box-shadow: 0 0 30px rgba(118, 140, 18, 0.2);
    }

    /* Hover backgrounds */
    .benefit-card.warm:hover {
      background: linear-gradient(135deg,
        rgba(26, 29, 46, 0.9) 0%,
        rgba(128, 43, 100, 0.05) 100%
      );
    }

    .benefit-card.cool:hover {
      background: linear-gradient(135deg,
        rgba(26, 29, 46, 0.9) 0%,
        rgba(6, 109, 177, 0.05) 100%
      );
    }

    .benefit-card.success:hover {
      background: linear-gradient(135deg,
        rgba(26, 29, 46, 0.9) 0%,
        rgba(118, 140, 18, 0.05) 100%
      );
    }

    /* ====================================
       CARD CONTENT
       ==================================== */
    .card-content {
      position: relative;
      z-index: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
    }

    /* Illustration Container */
    .illustration-container {
      margin-bottom: 2rem;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .illustration {
      filter: drop-shadow(0 4px 12px rgba(0, 0, 0, 0.2));
      transition: transform 0.4s ease;
    }

    .benefit-card:hover .illustration {
      transform: scale(1.05);
    }

    /* Card Title */
    .card-title {
      font-family: 'Fustat', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      font-size: 1.25rem;
      font-weight: 600;
      color: #ffffff;
      margin-bottom: 1rem;
      line-height: 1.3;
      letter-spacing: -0.01em;
    }

    @media (min-width: 768px) {
      .card-title {
        font-size: 1.375rem;
      }
    }

    /* Card Description */
    .card-description {
      font-family: 'Fustat', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      font-size: 0.9375rem;
      font-weight: 400;
      line-height: 1.6;
      color: rgba(255, 255, 255, 0.7);
      margin: 0;
    }

    @media (min-width: 768px) {
      .card-description {
        font-size: 1rem;
      }
    }

    /* ====================================
       SVG ILLUSTRATION ANIMATIONS
       ==================================== */
    .illustration .draw-line {
      stroke-dasharray: 300;
      stroke-dashoffset: 300;
      transition: stroke-dashoffset 1.5s ease-out;
    }

    .benefit-card.visible .illustration .draw-line {
      stroke-dashoffset: 0;
    }

    .illustration .fade-in {
      opacity: 0;
      transition: opacity 0.6s ease;
      transition-delay: 0.5s;
    }

    .benefit-card.visible .illustration .fade-in {
      opacity: 1;
    }

    .illustration .scale-in {
      transform: scale(0);
      transition: transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
      transition-delay: 0.8s;
      transform-origin: center;
    }

    .benefit-card.visible .illustration .scale-in {
      transform: scale(1);
    }

    /* Hover animations */
    .benefit-card:hover .pulse-ring {
      animation: pulseRing 1.5s ease-out infinite;
    }

    .benefit-card:hover .rotate-on-hover {
      animation: gentleRotate 3s ease-in-out infinite;
    }

    .benefit-card:hover .bob-on-hover {
      animation: gentleBob 2s ease-in-out infinite;
    }

    @keyframes pulseRing {
      0% { transform: scale(1); opacity: 0.6; }
      100% { transform: scale(1.8); opacity: 0; }
    }

    @keyframes gentleRotate {
      0%, 100% { transform: rotate(0deg); }
      50% { transform: rotate(5deg); }
    }

    @keyframes gentleBob {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-3px); }
    }

    /* Card entrance delays */
    .benefit-card:nth-child(1) { transition-delay: 0s; }
    .benefit-card:nth-child(2) { transition-delay: 0.2s; }
    .benefit-card:nth-child(3) { transition-delay: 0.4s; }

    /* ====================================
       SKIP BUTTON
       ==================================== */
    .skip-button {
      position: absolute;
      top: 2rem;
      right: 2rem;
      padding: 0.5rem 1rem;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      color: rgba(255, 255, 255, 0.6);
      font-size: 0.875rem;
      cursor: pointer;
      transition: all 0.2s ease;
      font-family: 'Fustat', sans-serif;
      z-index: 30;
    }

    .skip-button:hover {
      background: rgba(255, 255, 255, 0.1);
      color: rgba(255, 255, 255, 0.8);
    }

    /* CTA Button Wrapper - reserves space to prevent layout shift */
    .cta-button-wrapper {
      margin-top: 2.5rem;
      min-height: 56px;
      display: flex;
      justify-content: flex-start;
      align-items: center;
    }

    /* CTA Button */
    .cta-button {
      padding: 1rem 2.5rem;
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.15) 0%, rgba(255, 255, 255, 0.05) 100%);
      border: 1px solid rgba(255, 255, 255, 0.25);
      border-radius: 50px;
      color: rgba(255, 255, 255, 0.95);
      font-family: 'Fustat', sans-serif;
      font-size: 1.1rem;
      font-weight: 500;
      letter-spacing: 0.5px;
      cursor: pointer;
      transition: all 0.4s ease;
      backdrop-filter: blur(10px);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
      opacity: 0;
      transform: translateY(10px);
      pointer-events: none;
    }

    .cta-button.visible {
      opacity: 1;
      transform: translateY(0);
      pointer-events: auto;
    }

    .cta-button:hover {
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.25) 0%, rgba(255, 255, 255, 0.1) 100%);
      border-color: rgba(255, 255, 255, 0.4);
      transform: translateY(-2px);
      box-shadow: 0 6px 25px rgba(0, 0, 0, 0.3);
    }

    .cta-button:active {
      transform: translateY(0);
    }

    /* ====================================
       RESPONSIVE
       ==================================== */
    @media (max-width: 767px) {
      .landing-content {
        padding: 1.5rem;
      }

      .typed-line p {
        font-size: 1.5rem;
      }

      .landing-form {
        padding: 2rem 1.5rem;
      }

      .form-input {
        padding: 1rem 1.25rem;
        font-size: 0.9375rem;
      }

      .submit-button {
        padding: 1rem;
        font-size: 1rem;
      }

      .trust-signals {
        font-size: 0.8125rem;
      }

      .preview-section {
        padding: 4rem 1.5rem;
      }

      .preview-title {
        font-size: 1.75rem;
        margin-bottom: 3rem;
      }

      .benefit-card {
        padding: 2.5rem 1.5rem;
      }

      .card-number {
        font-size: 4rem;
      }

      .illustration-container svg {
        width: 100px;
        height: 100px;
      }

      .cta-button {
        margin-top: 2rem;
        padding: 0.875rem 2rem;
        font-size: 1rem;
      }

      .form-section-layout {
        flex-direction: column;
        gap: 2.5rem;
        padding: 0 1.5rem;
        text-align: center;
      }

      .form-headline-column {
        max-width: 100%;
      }

      .form-headline {
        font-size: 2rem;
      }

      .form-subtext {
        font-size: 1rem;
        margin-top: 1rem;
      }

      .form-column {
        flex: 1;
        width: 100%;
      }

      .scroll-text {
        font-size: 0.875rem;
      }
    }

    /* Reduce motion for users who prefer it */
    @media (prefers-reduced-motion: reduce) {
      .orb, .cursor, .chevron-down, .form-container, .form-border, .landing-form, .scroll-indicator {
        animation: none !important;
      }
      .orb { opacity: 0.25; }
      .form-container { opacity: 1; }
      .form-border { clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%); }
      .landing-form { opacity: 1; }
      .scroll-indicator { opacity: 1; }
    }

    /* ====================================
       PERSONA GRID BACKGROUND - 10 CARDS
       ==================================== */
    .persona-grid-background {
      position: absolute;
      inset: 0;
      z-index: 5;
      display: flex;
      align-items: center;
      justify-content: center;
      pointer-events: none;
      overflow: visible;
    }

    .persona-grid-container {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 2rem;
      width: 100%;
      max-width: 1100px;
      padding: 2rem 3rem;
      filter: blur(10px);
      transform: translateX(-15%);
    }

    /* Subtle pulse animation */
    @keyframes gridCardPulse {
      0%, 100% { opacity: 0.35; }
      50% { opacity: 0.45; }
    }

    @keyframes gridCardFadeIn {
      from {
        opacity: 0;
        transform: scale(0.9);
      }
      to {
        opacity: 0.35;
        transform: scale(1);
      }
    }

    .persona-grid-card {
      opacity: 0;
      animation: gridCardFadeIn 0.6s ease-out forwards, gridCardPulse 4s ease-in-out infinite;
      will-change: opacity;
      transform: translateZ(0);
      backface-visibility: hidden;
    }

    /* Staggered delays for wave effect */
    .persona-grid-card:nth-child(1) { animation-delay: 0s, 0.6s; }
    .persona-grid-card:nth-child(2) { animation-delay: 0.3s, 0.9s; }
    .persona-grid-card:nth-child(3) { animation-delay: 0.6s, 1.2s; }
    .persona-grid-card:nth-child(4) { animation-delay: 0.9s, 1.5s; }
    .persona-grid-card:nth-child(5) { animation-delay: 1.2s, 1.8s; }
    .persona-grid-card:nth-child(6) { animation-delay: 0.15s, 0.75s; }
    .persona-grid-card:nth-child(7) { animation-delay: 0.45s, 1.05s; }
    .persona-grid-card:nth-child(8) { animation-delay: 0.75s, 1.35s; }
    .persona-grid-card:nth-child(9) { animation-delay: 1.05s, 1.65s; }
    .persona-grid-card:nth-child(10) { animation-delay: 1.35s, 1.95s; }

    .grid-card-inner {
      position: relative;
      padding: 1.25rem 1rem;
      background: linear-gradient(135deg,
        rgba(26, 29, 46, 0.95) 0%,
        rgba(26, 29, 46, 0.8) 100%
      );
      backdrop-filter: blur(10px);
      border-radius: 14px;
      border: 2px solid rgba(255, 255, 255, 0.2);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      overflow: hidden;
      min-width: 140px;
      height: 180px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    .grid-card-gradient {
      position: absolute;
      inset: 0;
      pointer-events: none;
      opacity: 0.6;
      border-radius: 12px;
    }

    .grid-card-icon {
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 0.75rem;
    }

    .grid-card-icon svg {
      width: 56px;
      height: 56px;
      filter: drop-shadow(0 2px 8px rgba(0, 0, 0, 0.3));
    }

    .grid-card-info {
      text-align: center;
    }

    .grid-persona-name {
      font-family: 'Fustat', sans-serif;
      font-size: 1rem;
      font-weight: 700;
      color: #ffffff;
      margin: 0 0 0.375rem 0;
      letter-spacing: -0.01em;
      line-height: 1.2;
    }

    .grid-persona-cluster {
      font-family: 'Fustat', sans-serif;
      font-size: 0.6875rem;
      font-weight: 600;
      color: rgba(255, 255, 255, 0.6);
      text-transform: uppercase;
      letter-spacing: 0.08em;
      margin: 0;
    }

    /* Responsive - tablets */
    @media (max-width: 1024px) {
      .persona-grid-container {
        gap: 1.5rem;
        padding: 2rem 2rem;
        filter: blur(8px);
      }

      .grid-card-inner {
        min-width: 120px;
        height: 160px;
      }

      .grid-card-icon svg {
        width: 48px;
        height: 48px;
      }
    }

    /* Responsive - mobile */
    @media (max-width: 767px) {
      .persona-grid-container {
        gap: 1.25rem;
        padding: 1.5rem 1.5rem;
        filter: blur(6px);
      }

      .grid-card-inner {
        padding: 0.75rem 0.5rem;
        min-width: 85px;
        height: 120px;
        border-width: 1.5px;
      }

      .grid-card-icon svg {
        width: 36px;
        height: 36px;
      }

      .grid-persona-name {
        font-size: 0.75rem;
      }

      .grid-persona-cluster {
        font-size: 0.5625rem;
      }
    }

    /* Reduce motion */
    @media (prefers-reduced-motion: reduce) {
      .persona-grid-card {
        animation: none !important;
        opacity: 0.35;
        opacity: 0.25;
      }
    }

    /* ====================================
       PERSONAS LIBRARY PAGE
       ==================================== */

    .personas-page {
      min-height: 100vh;
      background: linear-gradient(135deg, #0f111a 0%, #1a1d2e 50%, #0f111a 100%);
      padding: 2rem 1.5rem 4rem;
      position: relative;
    }

    .personas-page-header {
      max-width: 1200px;
      margin: 0 auto 3rem;
      text-align: center;
    }

    .personas-back-link {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      color: rgba(255, 255, 255, 0.6);
      font-family: 'Fustat', sans-serif;
      font-size: 0.875rem;
      text-decoration: none;
      margin-bottom: 2rem;
      transition: color 0.2s;
      cursor: pointer;
      background: none;
      border: none;
      padding: 0;
    }

    .personas-back-link:hover {
      color: rgba(255, 255, 255, 0.9);
    }

    .personas-page-title {
      font-family: 'Fustat', sans-serif;
      font-size: 0.875rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.2em;
      color: rgba(255, 255, 255, 0.5);
      margin: 0 0 0.75rem;
    }

    .personas-page-subtitle {
      font-family: 'Spectral', serif;
      font-size: 2.5rem;
      font-weight: 700;
      font-style: italic;
      color: #ffffff;
      margin: 0;
    }

    @media (max-width: 640px) {
      .personas-page-subtitle {
        font-size: 1.75rem;
      }
    }

    /* Personas Grid */
    .personas-library-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 1.5rem;
      max-width: 800px;
      margin: 0 auto;
    }

    @media (max-width: 640px) {
      .personas-library-grid {
        grid-template-columns: 1fr;
        max-width: 400px;
      }
    }

    /* Grid Card */
    .library-grid-card {
      position: relative;
      padding: 2rem 1.5rem 1.5rem;
      background: linear-gradient(135deg, rgba(26, 29, 46, 0.9), rgba(26, 29, 46, 0.7));
      border-radius: 1rem;
      border: 1px solid rgba(255, 255, 255, 0.1);
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: center;
      opacity: 0;
      animation: libraryCardFadeIn 0.5s ease-out forwards;
    }

    @keyframes libraryCardFadeIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .library-grid-card:hover {
      transform: translateY(-4px) scale(1.02);
      border-color: var(--cluster-color, rgba(255, 255, 255, 0.3));
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3), 0 0 0 1px var(--cluster-color, transparent);
    }

    /* Main persona illustration - highest visual hierarchy */
    .library-card-persona-icon {
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 1rem;
    }

    .library-card-persona-icon svg {
      width: 80px;
      height: 80px;
    }

    .library-card-name {
      font-family: 'Spectral', serif;
      font-size: 1.25rem;
      font-weight: 700;
      font-style: italic;
      color: #ffffff;
      margin: 0 0 0.75rem;
    }

    /* Cluster row with engine icon */
    .library-card-cluster-row {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
    }

    .library-card-cluster-icon svg {
      width: 20px;
      height: 20px;
    }

    .library-card-cluster {
      font-family: 'Fustat', sans-serif;
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: var(--cluster-color, rgba(255, 255, 255, 0.5));
      margin: 0;
    }

    /* Modal Overlay */
    .persona-modal-overlay {
      position: fixed;
      inset: 0;
      background: linear-gradient(135deg, #0f111a 0%, #1a1d2e 50%, #0f111a 100%);
      z-index: 1000;
      display: flex;
      align-items: flex-start;
      justify-content: center;
      padding: 2rem;
      opacity: 0;
      animation: modalOverlayFadeIn 0.3s ease-out forwards;
      overflow-y: auto;
    }

    /* Animated orbs for modal background */
    .persona-modal-overlay::before {
      content: '';
      position: fixed;
      top: 10%;
      left: 10%;
      width: 400px;
      height: 400px;
      background: radial-gradient(circle, rgba(118, 140, 18, 0.15) 0%, transparent 70%);
      border-radius: 50%;
      filter: blur(60px);
      pointer-events: none;
    }

    .persona-modal-overlay::after {
      content: '';
      position: fixed;
      bottom: 20%;
      right: 15%;
      width: 350px;
      height: 350px;
      background: radial-gradient(circle, rgba(6, 109, 177, 0.12) 0%, transparent 70%);
      border-radius: 50%;
      filter: blur(60px);
      pointer-events: none;
    }

    @keyframes modalOverlayFadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    .persona-modal {
      position: relative;
      width: 100%;
      max-width: 800px;
      max-height: none;
      background: rgba(26, 29, 46, 0.85);
      backdrop-filter: blur(20px);
      border-radius: 1.5rem;
      border: 1px solid rgba(255, 255, 255, 0.1);
      overflow: visible;
      transform: scale(0.95);
      opacity: 0;
      animation: modalScaleIn 0.3s ease-out 0.1s forwards;
      margin: 2rem 0;
    }

    @keyframes modalScaleIn {
      from {
        transform: scale(0.95);
        opacity: 0;
      }
      to {
        transform: scale(1);
        opacity: 1;
      }
    }

    @media (max-width: 640px) {
      .persona-modal-overlay {
        padding: 0;
        align-items: flex-start;
      }

      .persona-modal {
        max-height: 100vh;
        border-radius: 0;
        min-height: 100vh;
      }
    }

    .modal-close-btn {
      position: absolute;
      top: 1.5rem;
      right: 1.5rem;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      color: rgba(255, 255, 255, 0.7);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
      z-index: 10;
    }

    .modal-close-btn:hover {
      background: rgba(255, 255, 255, 0.2);
      color: #ffffff;
    }

    /* Modal Content */
    .modal-content {
      padding: 3rem 2.5rem;
    }

    @media (max-width: 640px) {
      .modal-content {
        padding: 2rem 1.5rem;
      }
    }

    /* Modal Hero */
    .modal-hero {
      text-align: center;
      margin-bottom: 3rem;
      padding-bottom: 2rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .modal-hero-icon {
      margin-bottom: 1.5rem;
    }

    .modal-hero-icon svg {
      width: 100px;
      height: 100px;
    }

    .modal-hero-name {
      font-family: 'Spectral', serif;
      font-size: 2.5rem;
      font-weight: 700;
      font-style: italic;
      color: #ffffff;
      margin: 0 0 0.75rem;
    }

    /* Cluster row with engine icon */
    .modal-hero-cluster-row {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      margin-bottom: 1.5rem;
    }

    .modal-hero-cluster-icon svg {
      width: 20px;
      height: 20px;
    }

    .modal-hero-cluster {
      font-family: 'Fustat', sans-serif;
      font-size: 0.875rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.15em;
      color: var(--cluster-color, rgba(255, 255, 255, 0.6));
      margin: 0;
    }

    .modal-hero-tagline {
      font-family: 'Spectral', serif;
      font-size: 1.25rem;
      font-style: italic;
      color: rgba(255, 255, 255, 0.8);
      margin: 0;
      max-width: 500px;
      margin: 0 auto;
    }

    @media (max-width: 640px) {
      .modal-hero-icon svg {
        width: 80px;
        height: 80px;
      }

      .modal-hero-name {
        font-size: 1.75rem;
      }

      .modal-hero-tagline {
        font-size: 1rem;
      }
    }

    /* Modal Sections */
    .modal-section {
      margin-bottom: 2.5rem;
    }

    .modal-section-title {
      font-family: 'Fustat', sans-serif;
      font-size: 0.75rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.15em;
      color: var(--cluster-color, rgba(255, 255, 255, 0.5));
      margin: 0 0 1rem;
    }

    .modal-section-text {
      font-family: 'Fustat', sans-serif;
      font-size: 1rem;
      line-height: 1.7;
      color: rgba(255, 255, 255, 0.85);
      margin: 0;
    }

    /* Skills Grid */
    .modal-skills-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 1rem;
    }

    @media (max-width: 640px) {
      .modal-skills-grid {
        grid-template-columns: 1fr;
      }
    }

    .modal-skill-card {
      padding: 1.25rem;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 0.75rem;
      border: 1px solid rgba(255, 255, 255, 0.08);
      text-align: center;
    }

    .modal-skill-name {
      font-family: 'Fustat', sans-serif;
      font-size: 0.9375rem;
      font-weight: 700;
      color: #ffffff;
      margin: 0 0 0.5rem;
    }

    .modal-skill-desc {
      font-family: 'Fustat', sans-serif;
      font-size: 0.8125rem;
      color: rgba(255, 255, 255, 0.6);
      margin: 0;
      line-height: 1.4;
    }

    /* Axis Bars */
    .modal-axis-list {
      display: flex;
      flex-direction: column;
      gap: 1.25rem;
    }

    .modal-axis-item {
      padding: 1rem 1.25rem;
      background: rgba(255, 255, 255, 0.03);
      border-radius: 0.75rem;
    }

    .modal-axis-skill {
      font-family: 'Fustat', sans-serif;
      font-size: 0.8125rem;
      font-weight: 600;
      color: rgba(255, 255, 255, 0.5);
      margin: 0 0 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
    }

    .modal-axis-bar-container {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .modal-axis-pole {
      font-family: 'Fustat', sans-serif;
      font-size: 0.8125rem;
      font-weight: 500;
      color: rgba(255, 255, 255, 0.4);
      min-width: 80px;
    }

    .modal-axis-pole.active {
      color: #ffffff;
      font-weight: 700;
    }

    .modal-axis-pole.right {
      text-align: right;
    }

    .modal-axis-bar {
      flex: 1;
      height: 6px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 3px;
      position: relative;
    }

    .modal-axis-marker {
      position: absolute;
      top: 50%;
      transform: translate(-50%, -50%);
      width: 14px;
      height: 14px;
      background: var(--cluster-color, #ffffff);
      border-radius: 50%;
      box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.2);
    }

    /* Warning Signs */
    .modal-warning-signs {
      margin-top: 1rem;
    }

    .modal-warning-label {
      font-family: 'Fustat', sans-serif;
      font-size: 0.875rem;
      font-weight: 600;
      color: rgba(251, 146, 60, 0.9);
      margin: 0 0 0.75rem;
    }

    .modal-warning-list {
      list-style: none;
      padding: 0;
      margin: 0;
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .modal-warning-item {
      font-family: 'Fustat', sans-serif;
      font-size: 0.9375rem;
      color: rgba(255, 255, 255, 0.75);
      padding-left: 1.5rem;
      position: relative;
    }

    .modal-warning-item::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0.5em;
      width: 6px;
      height: 6px;
      background: rgba(251, 146, 60, 0.6);
      border-radius: 50%;
    }

    /* User's Persona Highlight */
    .library-grid-card.is-user-persona {
      border: 2px solid var(--cluster-color, rgba(255, 255, 255, 0.3));
      box-shadow: 0 0 20px var(--cluster-color-glow, rgba(255, 255, 255, 0.1));
    }

    .user-persona-badge {
      position: absolute;
      top: -10px;
      right: -10px;
      background: var(--cluster-color, #768C12);
      color: #ffffff;
      font-size: 0.625rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      padding: 0.25rem 0.5rem;
      border-radius: 4px;
    }

    /* ====================================
       TIMELINE PREVIEW SECTION
       ==================================== */

    .timeline-preview {
      width: 100%;
      padding: 1.5rem 2rem 8rem;
      margin-top: -6rem;
      position: relative;
      z-index: 10;
    }

    .timeline-heading {
      font-family: 'Fustat', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      text-align: center;
      font-size: 0.875rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.2em;
      margin-bottom: 3.5rem;
      color: rgba(255, 255, 255, 0.5);
    }

    @media (min-width: 768px) {
      .timeline-heading {
        font-size: 0.9375rem;
      }
    }

    .timeline-container {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      max-width: 1100px;
      margin: 0 auto;
      position: relative;
    }

    .timeline-line {
      position: absolute;
      top: 32px;
      left: 64px;
      right: 64px;
      height: 2px;
      background: rgba(255, 255, 255, 0.15);
      z-index: 1;
    }

    @media (max-width: 767px) {
      .timeline-line {
        top: 24px;
        left: 32px;
        right: 32px;
      }
    }

    .timeline-node {
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      position: relative;
      z-index: 2;
      flex: 1;
      max-width: 180px;
    }

    .node-dot {
      width: 64px;
      height: 64px;
      border-radius: 50%;
      background: rgba(26, 29, 46, 0.6);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 2px solid rgba(255, 255, 255, 0.15);
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 1.25rem;
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
      transition: all 0.3s ease;
    }

    .node-dot:hover {
      transform: scale(1.08);
      border-color: rgba(255, 255, 255, 0.25);
      box-shadow: 0 6px 20px rgba(255, 255, 255, 0.1);
    }

    .node-dot svg {
      width: 48px;
      height: 48px;
    }

    @media (max-width: 767px) {
      .timeline-preview {
        padding: 1rem 1rem 6rem;
        margin-top: -4rem;
      }

      .timeline-container {
        gap: 0.25rem;
      }

      .node-dot {
        width: 48px;
        height: 48px;
        margin-bottom: 0.75rem;
      }

      .node-dot svg {
        width: 32px;
        height: 32px;
      }
    }

    .node-label {
      font-family: 'Fustat', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      font-size: 1rem;
      font-weight: 600;
      color: #ffffff;
      margin: 0 0 0.375rem;
      letter-spacing: -0.01em;
    }

    .node-description {
      font-family: 'Fustat', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      font-size: 0.8125rem;
      color: rgba(255, 255, 255, 0.6);
      line-height: 1.4;
      margin: 0;
    }

    @media (max-width: 767px) {
      .node-label {
        font-size: 0.75rem;
      }

      .node-description {
        font-size: 0.625rem;
        display: none;
      }
    }

    @media (max-width: 480px) {
      .timeline-container {
        gap: 0.125rem;
      }

      .node-dot {
        width: 40px;
        height: 40px;
      }

      .node-dot svg {
        width: 28px;
        height: 28px;
      }

      .node-label {
        font-size: 0.6875rem;
      }
    }

    /* Timeline node animation */
    .timeline-node {
      opacity: 0;
      transform: translateY(20px);
      animation: timelineNodeFadeIn 0.6s ease-out forwards;
    }

    @keyframes timelineNodeFadeIn {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .timeline-node:nth-child(1) { animation-delay: 0.1s; }
    .timeline-node:nth-child(2) { animation-delay: 0.25s; }
    .timeline-node:nth-child(3) { animation-delay: 0.4s; }
    .timeline-node:nth-child(4) { animation-delay: 0.55s; }
    .timeline-node:nth-child(5) { animation-delay: 0.7s; }

    /* Timeline line animation */
    .timeline-line {
      transform: scaleX(0);
      animation: timelineLineFadeIn 0.8s ease-out 0.3s forwards;
    }

    @keyframes timelineLineFadeIn {
      to {
        transform: scaleX(1);
      }
    }

    /* ====================================
       PROGRESSIVE REVEAL - SOPHISTICATED
       ==================================== */

    .progressive-reveal-screen {
      min-height: 100vh;
      height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      position: relative;
      padding: 2rem;
      overflow: hidden;
    }

    .reveal-content {
      width: 100%;
      max-width: 1200px;
      position: relative;
      z-index: 10;
      height: 100%;
      max-height: calc(100vh - 4rem);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    /* Typing Animation Container */
    .typing-text-container {
      text-align: center;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      margin-bottom: 1.5rem;
    }

    /* Stage 1 Text Hierarchy */
    .typing-headline {
      font-family: 'Fustat', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      font-size: 2rem;
      font-weight: 500;
      line-height: 1.3;
      letter-spacing: -0.02em;
      color: #ffffff;
      margin: 0 0 1rem 0;
      max-width: 720px;
    }

    @media (min-width: 768px) {
      .typing-headline {
        font-size: 2.5rem;
      }
    }

    .typing-body {
      font-family: 'Fustat', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      font-size: 1.0625rem;
      font-weight: 300;
      line-height: 1.7;
      letter-spacing: -0.01em;
      color: rgba(255, 255, 255, 0.8);
      margin: 0;
      max-width: 600px;
    }

    @media (min-width: 768px) {
      .typing-body {
        font-size: 1.25rem;
      }
    }

    .typing-line {
      font-family: 'Fustat', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      font-size: 1.125rem;
      font-weight: 300;
      line-height: 1.7;
      letter-spacing: -0.01em;
      color: rgba(255, 255, 255, 0.9);
      margin: 0 0 0.5rem 0;
      max-width: 680px;
    }

    @media (min-width: 768px) {
      .typing-line {
        font-size: 1.25rem;
      }
    }

    .typing-cursor {
      display: inline-block;
      width: 2px;
      height: 1.1em;
      background: rgba(255, 255, 255, 0.7);
      margin-left: 2px;
      vertical-align: text-bottom;
      animation: cursorBlink 1.06s steps(1, end) infinite;
    }

    @keyframes cursorBlink {
      0%, 49.9% { opacity: 1; }
      50%, 100% { opacity: 0; }
    }

    /* Stage Container Base */
    .stage-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      width: 100%;
      height: 100%;
      max-height: calc(100vh - 4rem);
    }

    /* Stage 1: Two-Column Layout (text left, visual right) */
    .stage-1-two-column {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      width: 100%;
      height: 100%;
      max-height: calc(100vh - 4rem);
      gap: 2rem;
    }

    @media (min-width: 768px) {
      .stage-1-two-column {
        flex-direction: row;
        align-items: center;
        justify-content: center;
        gap: 4rem;
        padding: 0 2rem;
      }
    }

    .stage-1-text {
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      flex: 0 1 auto;
      max-width: 500px;
    }

    @media (min-width: 768px) {
      .stage-1-text {
        align-items: flex-start;
        text-align: left;
        flex: 0 1 420px;
      }
    }

    .stage-1-text .typing-headline {
      text-align: center;
      margin-bottom: 1.25rem;
    }

    @media (min-width: 768px) {
      .stage-1-text .typing-headline {
        text-align: left;
      }
    }

    .stage-1-text .typing-body {
      text-align: center;
      opacity: 0;
      transform: translateY(10px);
      transition: opacity 0.6s ease, transform 0.6s ease;
    }

    @media (min-width: 768px) {
      .stage-1-text .typing-body {
        text-align: left;
      }
    }

    .stage-1-text .typing-body.visible {
      opacity: 1;
      transform: translateY(0);
    }

    .stage-1-visual {
      display: flex;
      align-items: center;
      justify-content: center;
      flex: 0 0 auto;
    }

    /* Circular Layout - Fits in viewport */
    .engines-circle {
      position: relative;
      width: min(300px, 38vh);
      height: min(300px, 38vh);
      z-index: 5;
    }

    @media (min-width: 768px) {
      .engines-circle {
        width: min(380px, 50vh);
        height: min(380px, 50vh);
      }
    }

    @media (max-width: 500px) {
      .engines-circle {
        width: min(260px, 32vh);
        height: min(260px, 32vh);
      }
    }

    .engine-node {
      position: absolute;
      transform: translate(-50%, -50%);
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      opacity: 0;
      transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .engine-node.visible {
      opacity: 1;
    }

    /* Engine icon containers - sized for two-column layout */
    .engine-node .engine-icon-container {
      width: 72px;
      height: 72px;
      border-radius: 50%;
      background: rgba(26, 29, 46, 0.4);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.08);
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 0.5rem;
      box-shadow:
        0 8px 24px rgba(0, 0, 0, 0.2),
        0 16px 48px rgba(0, 0, 0, 0.1),
        inset 0 1px 0 rgba(255, 255, 255, 0.05);
      transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .engine-node .engine-icon-container svg {
      width: 40px;
      height: 40px;
    }

    @media (max-width: 767px) {
      .engine-node .engine-icon-container {
        width: 56px;
        height: 56px;
      }

      .engine-node .engine-icon-container svg {
        width: 32px;
        height: 32px;
      }
    }

    @media (max-width: 500px) {
      .engine-node .engine-icon-container {
        width: 48px;
        height: 48px;
      }

      .engine-node .engine-icon-container svg {
        width: 28px;
        height: 28px;
      }
    }

    .engine-node-name {
      font-family: 'Fustat', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      font-size: 0.8125rem;
      font-weight: 400;
      color: rgba(255, 255, 255, 0.85);
      margin: 0;
      transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
    }

    @media (max-width: 767px) {
      .engine-node-name {
        font-size: 0.75rem;
      }
    }

    @media (max-width: 500px) {
      .engine-node-name {
        font-size: 0.6875rem;
      }
    }

    /* Stage 2 - Highlighted vs Faded Engines */
    .engine-node.faded {
      opacity: 0.05;
      transform: translate(-50%, -50%) scale(0.85);
      transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .engine-node.highlighted {
      opacity: 1;
      transform: translate(-50%, -50%) scale(1.2);
      transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .engine-node.highlighted .engine-icon-container {
      width: 110px;
      height: 110px;
      border-color: var(--cluster-color);
      border-width: 2px;
      box-shadow:
        0 0 40px var(--cluster-color-60),
        0 0 80px var(--cluster-color-30),
        0 8px 32px rgba(0, 0, 0, 0.3);
      transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .engine-node.highlighted .engine-icon-container svg {
      width: 64px;
      height: 64px;
    }

    @media (max-width: 767px) {
      .engine-node.highlighted .engine-icon-container {
        width: 80px;
        height: 80px;
      }

      .engine-node.highlighted .engine-icon-container svg {
        width: 48px;
        height: 48px;
      }
    }

    /* Stage 2 Heading */
    .stage-heading-large {
      font-family: 'Fustat', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      font-size: 2.5rem;
      font-weight: 500;
      color: #ffffff;
      letter-spacing: -0.03em;
      text-align: center;
      margin: 0 0 1.5rem 0;
      z-index: 20;
      opacity: 0;
      animation: fadeInUp 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @media (min-width: 768px) {
      .stage-heading-large {
        font-size: 3.5rem;
      }
    }

    .stage-heading-large .cluster-name {
      font-weight: 500;
    }

    /* Stage 3 - Side by Side Layout - Compact */
    .stage-3-layout {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 2rem;
      width: 100%;
      max-width: 900px;
    }

    @media (min-width: 1024px) {
      .stage-3-layout {
        flex-direction: row;
        justify-content: center;
        align-items: center;
        gap: 4rem;
      }
    }

    .stage-3-engine {
      display: flex;
      flex-direction: column;
      align-items: center;
      flex-shrink: 0;
    }

    .engine-icon-large {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      background: rgba(26, 29, 46, 0.4);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border: 2px solid var(--cluster-color);
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 1rem;
      box-shadow:
        0 0 30px var(--cluster-color-60),
        0 0 60px var(--cluster-color-30),
        0 8px 32px rgba(0, 0, 0, 0.3);
      opacity: 0;
      transform: scale(0.9);
      transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .engine-icon-large.visible {
      opacity: 1;
      transform: scale(1);
    }

    .engine-icon-large svg {
      width: 56px;
      height: 56px;
    }

    @media (max-width: 767px) {
      .engine-icon-large {
        width: 80px;
        height: 80px;
      }

      .engine-icon-large svg {
        width: 44px;
        height: 44px;
      }
    }

    .engine-name-large {
      font-family: 'Fustat', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      font-size: 1.5rem;
      font-weight: 500;
      color: var(--cluster-color);
      margin: 0;
      opacity: 0;
      transition: opacity 0.6s cubic-bezier(0.4, 0, 0.2, 1) 0.2s;
    }

    .engine-name-large.visible {
      opacity: 1;
    }

    /* Skills Container - Compact Vertical Stack */
    .skills-container-elegant {
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
    }

    /* Skill Cards - Compact */
    .skill-card-elegant {
      padding: 1.5rem 2rem;
      min-width: 220px;
      max-width: 260px;
      background: rgba(26, 29, 46, 0.4);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.08);
      border-radius: 20px;
      text-align: center;
      box-shadow:
        0 6px 20px rgba(0, 0, 0, 0.2),
        0 12px 40px rgba(0, 0, 0, 0.1),
        inset 0 1px 0 rgba(255, 255, 255, 0.05);
      opacity: 0;
      transform: translateX(30px);
      transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .skill-card-elegant.visible {
      opacity: 1;
      transform: translateX(0);
    }

    @media (max-width: 1023px) {
      .skill-card-elegant {
        transform: translateY(20px);
      }

      .skill-card-elegant.visible {
        transform: translateY(0);
      }
    }

    @media (max-width: 767px) {
      .skill-card-elegant {
        min-width: 200px;
        max-width: 240px;
        padding: 1.25rem 1.5rem;
      }
    }

    .skill-domain-icon {
      margin-bottom: 0.75rem;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .skill-domain-icon svg {
      width: 32px;
      height: 32px;
    }

    .skill-name-elegant {
      font-family: 'Fustat', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      font-size: 1.25rem;
      font-weight: 500;
      color: #ffffff;
      margin: 0 0 0.375rem 0;
      letter-spacing: -0.01em;
    }

    .skill-domain-label {
      font-family: 'Fustat', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      font-size: 0.9375rem;
      font-weight: 400;
      color: var(--cluster-color);
      margin: 0;
    }

    @media (max-width: 767px) {
      .skill-name-elegant {
        font-size: 1.125rem;
      }

      .skill-domain-label {
        font-size: 0.875rem;
      }
    }

    /* Stage 4 - Personas - Polished */
    .personas-container-elegant {
      display: flex;
      gap: 3rem;
      justify-content: center;
      align-items: stretch;
      margin: 1.5rem 0 2rem 0;
    }

    @media (max-width: 700px) {
      .personas-container-elegant {
        flex-direction: column;
        gap: 1.5rem;
        align-items: center;
      }
    }

    .persona-card-elegant {
      padding: 2.5rem 2.5rem;
      min-width: 240px;
      max-width: 280px;
      background: rgba(26, 29, 46, 0.4);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.08);
      border-radius: 24px;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      box-shadow:
        0 8px 24px rgba(0, 0, 0, 0.2),
        0 16px 48px rgba(0, 0, 0, 0.1),
        inset 0 1px 0 rgba(255, 255, 255, 0.05);
      opacity: 0;
      transform: translateY(30px);
      transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .persona-card-elegant.visible {
      opacity: 1;
      transform: translateY(0);
    }

    .persona-card-elegant:hover {
      transform: translateY(-6px) scale(1.02);
      border-color: rgba(255, 255, 255, 0.15);
      box-shadow:
        0 16px 40px rgba(0, 0, 0, 0.25),
        0 24px 56px rgba(0, 0, 0, 0.15);
    }

    @media (max-width: 700px) {
      .persona-card-elegant {
        width: 100%;
        max-width: 280px;
        padding: 2rem 2rem;
      }
    }

    /* Persona Icon - Centered */
    .persona-icon-elegant {
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 1.5rem;
      width: 100%;
    }

    .persona-icon-elegant svg {
      width: 64px;
      height: 64px;
    }

    .persona-name-elegant {
      font-family: 'Spectral', serif;
      font-size: 1.5rem;
      font-weight: 500;
      font-style: italic;
      letter-spacing: -0.02em;
      color: #ffffff;
      margin: 0 0 0.5rem 0;
    }

    .persona-tagline {
      font-family: 'Fustat', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      font-size: 0.9375rem;
      font-weight: 300;
      font-style: italic;
      color: rgba(255, 255, 255, 0.65);
      margin: 0;
      line-height: 1.5;
    }

    @media (max-width: 767px) {
      .persona-name-elegant {
        font-size: 1.375rem;
      }

      .persona-tagline {
        font-size: 0.875rem;
      }
    }

    /* Question Text */
    .question-text-elegant {
      font-family: 'Spectral', serif;
      font-size: 1.625rem;
      font-style: italic;
      font-weight: 400;
      color: rgba(255, 255, 255, 0.85);
      margin: 0;
      opacity: 0;
      transition: opacity 0.8s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .question-text-elegant.visible {
      opacity: 1;
    }

    @media (max-width: 767px) {
      .question-text-elegant {
        font-size: 1.375rem;
      }
    }

    /* Reveal Button */
    .reveal-button-elegant {
      padding: 1.5rem 4rem;
      font-size: 1.25rem;
      font-weight: 500;
      font-family: 'Fustat', sans-serif;
      border-radius: 16px;
      background: linear-gradient(135deg, #768C12 0%, #066DB1 50%, #802B64 100%);
      border: none;
      color: #ffffff;
      cursor: pointer;
      box-shadow:
        0 8px 24px rgba(0, 0, 0, 0.3),
        0 16px 48px rgba(118, 140, 18, 0.2);
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      opacity: 0;
      transform: translateY(20px);
    }

    .reveal-button-elegant.visible {
      opacity: 1;
      transform: translateY(0);
    }

    .reveal-button-elegant:hover {
      transform: translateY(-4px);
      box-shadow:
        0 12px 32px rgba(0, 0, 0, 0.35),
        0 20px 56px rgba(118, 140, 18, 0.3);
    }

    .reveal-button-elegant:active {
      transform: translateY(-2px);
    }

    @media (max-width: 767px) {
      .reveal-button-elegant {
        width: 100%;
        max-width: 320px;
        padding: 1.25rem 2.5rem;
        font-size: 1.125rem;
      }
    }

    .reveal-button-elegant:focus-visible {
      outline: 2px solid #066DB1;
      outline-offset: 4px;
    }

    /* Reveal Section */
    .reveal-section-elegant {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 2.25rem;
      margin-top: 1rem;
    }

    @media (prefers-reduced-motion: reduce) {
      .engine-node,
      .skill-card-elegant,
      .persona-card-elegant,
      .reveal-button-elegant,
      .engine-icon-large,
      .typing-cursor {
        transition: none;
        animation: none;
        opacity: 1;
        transform: none;
      }

      .engine-node {
        transform: translate(-50%, -50%);
      }
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useCallback } = React;

    // ============================================================================
    // LEADERSHIP TRADEOFFS MINI-ASSESSMENT
    // A professional lead magnet for LeaderFactor
    // ============================================================================

    // Brand Colors
    const COLORS = {
      leadSelf: '#768C12',
      leadTeam: '#066DB1',
      leadOrg: '#802B64',
      darkNavy: '#101322',
      white: '#ffffff',
    };

    // Questions Data
    const QUESTIONS = [
      // Lead Self Questions (Green)
      {
        id: 1,
        skill: 'Purpose',
        domain: 'Lead Self',
        axis: 'Meaning ↔ Usefulness',
        question: 'When choosing between two projects, you prioritize the one that:',
        optionA: 'Connects to deeper purpose and values',
        optionB: 'Delivers clear, measurable outcomes',
        poleA: 'Meaning',
        poleB: 'Usefulness',
        cluster: 'DIRECTION',
      },
      {
        id: 2,
        skill: 'Integrity',
        domain: 'Lead Self',
        axis: 'Truth ↔ Loyalty',
        question: 'A colleague confides in you and mentions something leadership should know. You:',
        optionA: 'Share it upward because transparency matters',
        optionB: 'Protect their confidence unless they agree to share it',
        poleA: 'Truth',
        poleB: 'Loyalty',
        cluster: 'TRUST',
      },
      {
        id: 3,
        skill: 'Accountability',
        domain: 'Lead Self',
        axis: 'Ownership ↔ Adaptation',
        question: 'When a project goes off track, you:',
        optionA: 'Own it and drive it back on course yourself',
        optionB: 'Assess if the plan needs to change and adjust',
        poleA: 'Ownership',
        poleB: 'Adaptation',
        cluster: 'EXECUTION',
      },
      {
        id: 4,
        skill: 'Learning',
        domain: 'Lead Self',
        axis: 'Curiosity ↔ Competence',
        question: 'You have unexpected free time. You:',
        optionA: 'Explore something new and unrelated',
        optionB: 'Deepen expertise in your core domain',
        poleA: 'Curiosity',
        poleB: 'Competence',
        cluster: 'DEVELOPMENT',
      },
      {
        id: 5,
        skill: 'Resilience',
        domain: 'Lead Self',
        axis: 'Grit ↔ Recovery',
        question: 'After an intense work period, you:',
        optionA: 'Push through to the next milestone',
        optionB: 'Prioritize rest and restoration',
        poleA: 'Grit',
        poleB: 'Recovery',
        cluster: 'ADAPTATION',
      },
      // Lead Team Questions (Blue)
      {
        id: 6,
        skill: 'Emotional Intelligence',
        domain: 'Lead Team',
        axis: 'Warmth ↔ Truth',
        question: 'A team member is underperforming. Your first move:',
        optionA: 'Check in warmly to understand what\'s going on',
        optionB: 'Have a direct conversation about performance',
        poleA: 'Warmth',
        poleB: 'Truth',
        cluster: 'ADAPTATION',
      },
      {
        id: 7,
        skill: 'Psychological Safety',
        domain: 'Lead Team',
        axis: 'Care ↔ Courage',
        question: 'In team meetings, you prioritize:',
        optionA: 'Making sure everyone feels heard and safe',
        optionB: 'Challenging ideas to get to the best answer',
        poleA: 'Care',
        poleB: 'Courage',
        cluster: 'TRUST',
      },
      {
        id: 8,
        skill: 'Alignment',
        domain: 'Lead Team',
        axis: 'Clarity ↔ Buy-in',
        question: 'When rolling out a new direction, you focus on:',
        optionA: 'Crystal-clear messaging about what to do',
        optionB: 'Getting genuine agreement before moving forward',
        poleA: 'Clarity',
        poleB: 'Buy-in',
        cluster: 'DIRECTION',
      },
      {
        id: 9,
        skill: 'Decision Making',
        domain: 'Lead Team',
        axis: 'Speed ↔ Certainty',
        question: 'You have 70% of the information for a decision. You:',
        optionA: 'Make the call now and adjust if needed',
        optionB: 'Gather remaining data before committing',
        poleA: 'Speed',
        poleB: 'Certainty',
        cluster: 'EXECUTION',
      },
      {
        id: 10,
        skill: 'Coaching',
        domain: 'Lead Team',
        axis: 'Freedom ↔ Standards',
        question: 'When developing someone, you emphasize:',
        optionA: 'Giving them space to find their own way',
        optionB: 'Teaching proven methods and best practices',
        poleA: 'Freedom',
        poleB: 'Standards',
        cluster: 'DEVELOPMENT',
      },
      // Lead the Org Questions (Purple)
      {
        id: 11,
        skill: 'Vision',
        domain: 'Lead the Org',
        axis: 'Boldness ↔ Credibility',
        question: 'When casting vision, you lean toward:',
        optionA: 'Stretching what people think is possible',
        optionB: 'Staying grounded in what\'s believable',
        poleA: 'Boldness',
        poleB: 'Credibility',
        cluster: 'DIRECTION',
      },
      {
        id: 12,
        skill: 'Strategy',
        domain: 'Lead the Org',
        axis: 'Focus ↔ Options',
        question: 'Your strategic instinct is to:',
        optionA: 'Concentrate resources on the vital few priorities',
        optionB: 'Maintain flexibility and multiple paths forward',
        poleA: 'Focus',
        poleB: 'Options',
        cluster: 'EXECUTION',
      },
      {
        id: 13,
        skill: 'Culture',
        domain: 'Lead the Org',
        axis: 'Standards ↔ Belonging',
        question: 'Building culture means:',
        optionA: 'Setting high performance expectations',
        optionB: 'Creating a place where people feel they belong',
        poleA: 'Standards',
        poleB: 'Belonging',
        cluster: 'TRUST',
      },
      {
        id: 14,
        skill: 'Change',
        domain: 'Lead the Org',
        axis: 'Stability ↔ Disruption',
        question: 'When leading through change, you:',
        optionA: 'Preserve what\'s working while evolving',
        optionB: 'Break what needs breaking to move forward',
        poleA: 'Stability',
        poleB: 'Disruption',
        cluster: 'ADAPTATION',
      },
      {
        id: 15,
        skill: 'Innovation',
        domain: 'Lead the Org',
        axis: 'Novelty ↔ Utility',
        question: 'You greenlight innovations that are:',
        optionA: 'Novel and push boundaries',
        optionB: 'Practical and solve real problems',
        poleA: 'Novelty',
        poleB: 'Utility',
        cluster: 'DEVELOPMENT',
      },
    ];

    // Persona definitions
    const PERSONAS = {
      DIRECTION: {
        A: {
          name: 'The Pathfinder',
          gifts: [
            'Visionary: You see possibilities others miss and inspire others to reach for more',
            'Purpose-driven: You connect work to meaning and ignite intrinsic motivation',
            'Bold: You set ambitious directions that stretch what people think is possible',
          ],
          risks: 'Watch for: You can become so attached to the vision that you lose people along the way, or set directions so ambitious they feel unreachable.',
          pressurePersona: 'The Crusader',
          pressureDescription: 'Under stress, your vision becomes a crusade. You double down on purpose while losing patience with those who don\'t share your conviction. Your boldness becomes stubbornness, and your clarity becomes rigidity.',
          balanceMoves: [
            'Before casting vision: Ask "Who needs to help shape this?" (borrow Buy-in)',
            'Before pushing forward: Ask "Is this inspiring or intimidating?" (borrow Credibility)',
            'When frustrated: Ask "Am I leading or preaching?" (borrow Patience)',
          ],
        },
        B: {
          name: 'The Architect',
          gifts: [
            'Strategic: You build sustainable systems that deliver consistent results',
            'Credible: You earn trust through realistic commitments and follow-through',
            'Inclusive: You bring people along and build genuine alignment',
          ],
          risks: 'Watch for: You can become so focused on buy-in that you slow down necessary change, or so grounded that you fail to inspire.',
          pressurePersona: 'The Diplomat',
          pressureDescription: 'Under stress, your inclusion becomes indecision. You seek so much buy-in that momentum stalls. Your credibility becomes playing it safe, and your alignment becomes conflict avoidance.',
          balanceMoves: [
            'Before seeking consensus: Ask "What decision can I make now?" (borrow Clarity)',
            'Before grounding the vision: Ask "What would bold look like?" (borrow Boldness)',
            'When stuck: Ask "Am I building alignment or avoiding conflict?" (borrow Courage)',
          ],
        },
      },
      TRUST: {
        A: {
          name: 'The Truth-Teller',
          gifts: [
            'Honest: You create environments where the real issues surface',
            'Courageous: You challenge ideas and hold people to high standards',
            'Transparent: You model the candor you expect from others',
          ],
          risks: 'Watch for: You can prioritize truth over relationship, creating fear instead of safety, or set standards so high they feel punishing.',
          pressurePersona: 'The Enforcer',
          pressureDescription: 'Under stress, your honesty becomes bluntness. You tell hard truths without cushioning the blow. Your courage becomes combativeness, and your standards become impossible bars.',
          balanceMoves: [
            'Before speaking truth: Ask "How can I make this easier to hear?" (borrow Care)',
            'Before challenging: Ask "Have I earned the right?" (borrow Belonging)',
            'When frustrated: Ask "Am I building trust or testing it?" (borrow Warmth)',
          ],
        },
        B: {
          name: 'The Guardian',
          gifts: [
            'Protective: You create psychological safety where people can take risks',
            'Loyal: You build deep trust through consistent care and commitment',
            'Community-builder: You foster belonging and make everyone feel valued',
          ],
          risks: 'Watch for: You can protect people from necessary discomfort, create comfort zones instead of growth zones, or avoid hard conversations.',
          pressurePersona: 'The Peacekeeper',
          pressureDescription: 'Under stress, your protection becomes over-protection. You smooth over conflicts that need to surface. Your loyalty becomes enabling, and your care becomes avoiding necessary challenge.',
          balanceMoves: [
            'Before protecting: Ask "What do they need to hear?" (borrow Truth)',
            'Before smoothing over: Ask "Is this peace or avoidance?" (borrow Courage)',
            'When avoiding: Ask "Am I caring or enabling?" (borrow Standards)',
          ],
        },
      },
      EXECUTION: {
        A: {
          name: 'The Driver',
          gifts: [
            'Decisive: You prevent drift and get outcomes when others hesitate',
            'Fast: You move with speed and create momentum',
            'Focused: You cut through noise to what actually matters',
          ],
          risks: 'Watch for: You can narrow too quickly, bulldoze nuance, or mistake motion for progress.',
          pressurePersona: 'The Steamroller',
          pressureDescription: 'Under stress, your decisiveness becomes control. You stop consulting and start commanding. Your speed becomes rushing, and your focus becomes tunnel vision.',
          balanceMoves: [
            'Before deciding: Ask "Who needs to weigh in?" (borrow Certainty)',
            'Before focusing: Ask "What options am I closing too fast?" (borrow Options)',
            'Before pushing: Ask "Is this ownership or control?" (borrow Adaptation)',
          ],
        },
        B: {
          name: 'The Optimizer',
          gifts: [
            'Thorough: You make decisions that stand the test of time',
            'Adaptive: You read changing conditions and adjust course wisely',
            'Strategic: You maintain flexibility while still driving forward',
          ],
          risks: 'Watch for: You can optimize so long you miss the window, or maintain so many options that nothing gets done.',
          pressurePersona: 'The Perfectionist',
          pressureDescription: 'Under stress, your thoroughness becomes paralysis. You seek more data when action is needed. Your adaptation becomes second-guessing, and your options become indecision.',
          balanceMoves: [
            'Before gathering more data: Ask "What do I know that\'s enough?" (borrow Speed)',
            'Before keeping options open: Ask "What can I commit to now?" (borrow Focus)',
            'When adapting: Ask "Am I pivoting or procrastinating?" (borrow Ownership)',
          ],
        },
      },
      DEVELOPMENT: {
        A: {
          name: 'The Explorer',
          gifts: [
            'Innovative: You push boundaries and discover new possibilities',
            'Curious: You ask questions others don\'t think to ask',
            'Liberating: You give people freedom to find their own path',
          ],
          risks: 'Watch for: You can chase novelty over impact, give so much freedom that people flounder, or start more than you finish.',
          pressurePersona: 'The Wanderer',
          pressureDescription: 'Under stress, your exploration becomes scattered energy. You start new things to escape hard things. Your freedom becomes abandonment, and your curiosity becomes distraction.',
          balanceMoves: [
            'Before exploring: Ask "What needs finishing first?" (borrow Competence)',
            'Before giving freedom: Ask "What structure would help?" (borrow Standards)',
            'When curious: Ask "Is this discovery or avoidance?" (borrow Utility)',
          ],
        },
        B: {
          name: 'The Builder',
          gifts: [
            'Masterful: You develop deep expertise that creates real impact',
            'Structured: You provide clear frameworks that accelerate growth',
            'Practical: You focus on what works and delivers results',
          ],
          risks: 'Watch for: You can over-structure creativity, teach methods that worked for you but don\'t fit others, or miss innovations by staying in your lane.',
          pressurePersona: 'The Taskmaster',
          pressureDescription: 'Under stress, your structure becomes rigidity. You enforce your methods because they\'re familiar. Your standards become demands, and your practicality becomes narrow-mindedness.',
          balanceMoves: [
            'Before structuring: Ask "What would they discover on their own?" (borrow Freedom)',
            'Before teaching your way: Ask "What might they teach me?" (borrow Curiosity)',
            'When enforcing: Ask "Am I developing or controlling?" (borrow Novelty)',
          ],
        },
      },
      ADAPTATION: {
        A: {
          name: 'The Stabilizer',
          gifts: [
            'Grounding: You provide calm in chaos and help others find their footing',
            'Empathetic: You understand what people are going through and meet them there',
            'Preserving: You protect what\'s valuable while navigating change',
          ],
          risks: 'Watch for: You can stabilize so much you slow necessary change, or be so empathetic you absorb others\' stress.',
          pressurePersona: 'The Protector',
          pressureDescription: 'Under stress, your stability becomes resistance to change. You protect the familiar because change feels threatening. Your empathy becomes over-identification, and your preservation becomes stagnation.',
          balanceMoves: [
            'Before stabilizing: Ask "What needs to break?" (borrow Disruption)',
            'Before preserving: Ask "What\'s worth letting go?" (borrow Grit)',
            'When protecting: Ask "Am I helping or holding back?" (borrow Truth)',
          ],
        },
        B: {
          name: 'The Disruptor',
          gifts: [
            'Transformative: You break through barriers others accept as fixed',
            'Resilient: You push through difficulty to create breakthrough',
            'Direct: You cut through emotional fog to what needs to happen',
          ],
          risks: 'Watch for: You can break what doesn\'t need breaking, push through when pause is wiser, or leave people behind in your wake.',
          pressurePersona: 'The Bulldozer',
          pressureDescription: 'Under stress, your disruption becomes destruction. You break things just to break them. Your grit becomes grinding, and your directness becomes insensitivity.',
          balanceMoves: [
            'Before disrupting: Ask "What\'s worth preserving?" (borrow Stability)',
            'Before pushing through: Ask "What would recovery enable?" (borrow Recovery)',
            'When being direct: Ask "Have I understood first?" (borrow Warmth)',
          ],
        },
      },
    };

    // Cluster descriptions
    const CLUSTER_DESCRIPTIONS = {
      DIRECTION: {
        name: 'Direction',
        description: 'You lead by pointing the way forward. Purpose, vision, and alignment are your primary tools.',
        icon: '🧭',
      },
      TRUST: {
        name: 'Trust',
        description: 'You lead by building connection. Psychological safety, integrity, and culture are your primary tools.',
        icon: '🤝',
      },
      EXECUTION: {
        name: 'Execution',
        description: 'You lead by getting things done. Accountability, decisions, and strategy are your primary tools.',
        icon: '⚡',
      },
      DEVELOPMENT: {
        name: 'Development',
        description: 'You lead by growing capacity. Learning, coaching, and innovation are your primary tools.',
        icon: '🌱',
      },
      ADAPTATION: {
        name: 'Adaptation',
        description: 'You lead by reading and responding. Resilience, emotional intelligence, and change are your primary tools.',
        icon: '🔄',
      },
    };

    // Compatibility data for all personas
    const COMPATIBILITY = {
      'The Pathfinder': {
        worksWellWith: [
          {
            persona: 'The Builder',
            why: 'Pathfinder sets bold direction; Builder makes it systematically achievable',
            complementary: 'Vision meets execution discipline; meaning meets utility',
            dynamic: '"Here\'s where we need to go" meets "Here\'s how we\'ll build the capability"',
            example: 'Pathfinder casts transformational vision; Builder creates development systems to get there'
          },
          {
            persona: 'The Guardian',
            why: 'Pathfinder moves fast; Guardian protects relationships',
            complementary: 'Clarity meets care; boldness meets belonging',
            dynamic: '"Here\'s where we\'re going" meets "Let\'s bring everyone along"',
            example: 'Pathfinder announces strategic shift; Guardian ensures people feel safe through transition'
          }
        ],
        mayClashWith: [
          {
            persona: 'The Optimizer',
            why: 'Pathfinder wants bold moves NOW; Optimizer wants validation FIRST',
            competing: 'Speed vs. certainty; boldness vs. risk management',
            yourNeed: 'Your boldness looks like recklessness to them',
            theirNeed: 'Their caution looks like resistance to you',
            bridge: 'Agree to validation milestones; they commit to decision timeline'
          },
          {
            persona: 'The Stabilizer',
            why: 'Pathfinder drives constant forward movement; Stabilizer wants to pause and consolidate',
            competing: 'Momentum vs. sustainability; boldness vs. stability',
            yourNeed: 'They\'re not resisting change, they\'re protecting capacity',
            theirNeed: 'You\'re not being reckless, you\'re seeing opportunity',
            bridge: 'Honor recovery cycles; they commit to change windows'
          }
        ]
      },
      'The Architect': {
        worksWellWith: [
          {
            persona: 'The Driver',
            why: 'Architect builds commitment; Driver delivers outcomes',
            complementary: 'Buy-in meets bias to action; credibility meets decisiveness',
            dynamic: '"Let\'s get everyone aligned" meets "Let\'s go execute"',
            example: 'Architect facilitates strategic consensus; Driver takes ownership and ships'
          },
          {
            persona: 'The Truth-Teller',
            why: 'Architect earns buy-in; Truth-Teller ensures honesty in the process',
            complementary: 'Credibility meets courage; buy-in meets accountability',
            dynamic: '"Let\'s build believable vision" meets "Let\'s not sugar-coat reality"',
            example: 'Architect crafts pragmatic vision; Truth-Teller stress-tests assumptions'
          }
        ],
        mayClashWith: [
          {
            persona: 'The Pathfinder',
            why: 'Architect prioritizes buy-in and credibility; Pathfinder wants to move boldly regardless',
            competing: 'Consensus vs. clarity; credibility vs. stretch',
            yourNeed: 'Your caution feels like dilution to them',
            theirNeed: 'Their boldness feels alienating to you',
            bridge: 'They articulate the "why" that earns buy-in; you commit to decision timeline'
          },
          {
            persona: 'The Disruptor',
            why: 'Architect wants gradual, credible change; Disruptor wants to break things NOW',
            competing: 'Stability vs. disruption; buy-in vs. truth bombs',
            yourNeed: 'They\'re not being destructive, they\'re breaking inertia',
            theirNeed: 'You\'re not being timid, you\'re being sustainable',
            bridge: 'They explain case for urgency; you design change process that protects relationships'
          }
        ]
      },
      'The Truth-Teller': {
        worksWellWith: [
          {
            persona: 'The Architect',
            why: 'Truth-Teller surfaces real issues; Architect builds sustainable solutions',
            complementary: 'Courage meets credibility; transparency meets buy-in',
            dynamic: '"Here\'s the hard truth" meets "Here\'s how we address it together"',
            example: 'Truth-Teller names the elephant; Architect creates inclusive path forward'
          },
          {
            persona: 'The Driver',
            why: 'Truth-Teller clears the fog; Driver acts decisively',
            complementary: 'Honesty meets action; courage meets speed',
            dynamic: '"Here\'s what\'s really happening" meets "Here\'s what we\'re doing about it"',
            example: 'Truth-Teller calls out performance gap; Driver implements accountability'
          }
        ],
        mayClashWith: [
          {
            persona: 'The Guardian',
            why: 'Truth-Teller prioritizes honesty; Guardian prioritizes psychological safety',
            competing: 'Truth vs. care; standards vs. belonging',
            yourNeed: 'Their protection looks like avoidance to you',
            theirNeed: 'Your directness feels unsafe to them',
            bridge: 'Lead with care before truth; they commit to addressing hard issues'
          },
          {
            persona: 'The Stabilizer',
            why: 'Truth-Teller pushes for change through honesty; Stabilizer protects from overwhelm',
            competing: 'Disruption through truth vs. preservation of calm',
            yourNeed: 'They\'re not hiding from reality, they\'re protecting capacity',
            theirNeed: 'You\'re not attacking, you\'re trying to help',
            bridge: 'Time your truths for readiness; they commit to hearing hard feedback'
          }
        ]
      },
      'The Guardian': {
        worksWellWith: [
          {
            persona: 'The Pathfinder',
            why: 'Guardian creates safety; Pathfinder provides direction',
            complementary: 'Care meets clarity; belonging meets purpose',
            dynamic: '"Everyone matters here" meets "Here\'s where we\'re headed"',
            example: 'Guardian ensures psychological safety; Pathfinder channels it toward bold goals'
          },
          {
            persona: 'The Explorer',
            why: 'Guardian creates safe space; Explorer takes creative risks',
            complementary: 'Safety meets curiosity; protection meets innovation',
            dynamic: '"It\'s safe to try" meets "Let\'s discover something new"',
            example: 'Guardian builds trust; Explorer uses it to push creative boundaries'
          }
        ],
        mayClashWith: [
          {
            persona: 'The Truth-Teller',
            why: 'Guardian protects people; Truth-Teller delivers hard truths',
            competing: 'Care vs. courage; belonging vs. standards',
            yourNeed: 'Their honesty isn\'t cruelty, it\'s caring differently',
            theirNeed: 'Your protection isn\'t weakness, it\'s building foundation',
            bridge: 'Create safety for truth; they deliver truth with care'
          },
          {
            persona: 'The Disruptor',
            why: 'Guardian preserves stability; Disruptor breaks things to rebuild',
            competing: 'Safety vs. transformation; belonging vs. breakthrough',
            yourNeed: 'They\'re not destroying, they\'re clearing path for growth',
            theirNeed: 'You\'re not blocking, you\'re protecting what matters',
            bridge: 'Identify what must be preserved; they disrupt around it'
          }
        ]
      },
      'The Driver': {
        worksWellWith: [
          {
            persona: 'The Architect',
            why: 'Driver executes; Architect ensures alignment',
            complementary: 'Speed meets buy-in; decisiveness meets credibility',
            dynamic: '"Let\'s move" meets "Let\'s make sure everyone\'s with us"',
            example: 'Driver pushes for decision; Architect ensures stakeholder alignment'
          },
          {
            persona: 'The Explorer',
            why: 'Driver focuses energy; Explorer expands options',
            complementary: 'Focus meets curiosity; speed meets discovery',
            dynamic: '"Let\'s commit" meets "Let\'s consider this angle"',
            example: 'Driver drives toward deadline; Explorer surfaces unconsidered option'
          }
        ],
        mayClashWith: [
          {
            persona: 'The Optimizer',
            why: 'Driver wants to move NOW; Optimizer wants more data',
            competing: 'Speed vs. certainty; action vs. analysis',
            yourNeed: 'Their thoroughness isn\'t paralysis, it\'s risk management',
            theirNeed: 'Your speed isn\'t recklessness, it\'s seizing opportunity',
            bridge: 'Agree on "good enough" threshold; they commit to decision point'
          },
          {
            persona: 'The Guardian',
            why: 'Driver pushes hard; Guardian protects people',
            competing: 'Results vs. relationships; speed vs. safety',
            yourNeed: 'Their care isn\'t slowness, it\'s sustainability',
            theirNeed: 'Your drive isn\'t coldness, it\'s commitment to outcomes',
            bridge: 'Check impact on people; they commit to necessary pace'
          }
        ]
      },
      'The Optimizer': {
        worksWellWith: [
          {
            persona: 'The Builder',
            why: 'Optimizer ensures quality; Builder creates systems',
            complementary: 'Certainty meets competence; thoroughness meets structure',
            dynamic: '"Let\'s get this right" meets "Let\'s build it to last"',
            example: 'Optimizer validates approach; Builder implements proven methodology'
          },
          {
            persona: 'The Stabilizer',
            why: 'Optimizer reduces risk; Stabilizer maintains equilibrium',
            complementary: 'Certainty meets stability; analysis meets calm',
            dynamic: '"Let\'s be sure" meets "Let\'s stay grounded"',
            example: 'Optimizer stress-tests plan; Stabilizer ensures sustainable execution'
          }
        ],
        mayClashWith: [
          {
            persona: 'The Driver',
            why: 'Optimizer needs certainty; Driver needs speed',
            competing: 'Analysis vs. action; certainty vs. momentum',
            yourNeed: 'Their speed isn\'t recklessness, it\'s capturing opportunity',
            theirNeed: 'Your analysis isn\'t stalling, it\'s ensuring success',
            bridge: 'Set decision deadline; they accept "good enough" data'
          },
          {
            persona: 'The Pathfinder',
            why: 'Optimizer wants proof; Pathfinder wants vision',
            competing: 'Evidence vs. inspiration; certainty vs. boldness',
            yourNeed: 'Their vision isn\'t fantasy, it\'s seeing possibility',
            theirNeed: 'Your questions aren\'t doubt, they\'re strengthening the plan',
            bridge: 'Validate the critical assumptions; let smaller risks ride'
          }
        ]
      },
      'The Explorer': {
        worksWellWith: [
          {
            persona: 'The Driver',
            why: 'Explorer discovers; Driver delivers',
            complementary: 'Curiosity meets focus; novelty meets execution',
            dynamic: '"What if we tried this?" meets "Let\'s make it happen"',
            example: 'Explorer surfaces innovative approach; Driver implements it'
          },
          {
            persona: 'The Guardian',
            why: 'Explorer takes risks; Guardian creates safety for experimentation',
            complementary: 'Curiosity meets care; freedom meets belonging',
            dynamic: '"Let\'s experiment" meets "I\'ve got your back"',
            example: 'Explorer proposes bold experiment; Guardian ensures team feels safe to try'
          }
        ],
        mayClashWith: [
          {
            persona: 'The Builder',
            why: 'Explorer wants novelty; Builder wants proven methods',
            competing: 'Innovation vs. reliability; freedom vs. standards',
            yourNeed: 'Their structure isn\'t rigidity, it\'s accumulated wisdom',
            theirNeed: 'Your experiments aren\'t chaos, they\'re finding better ways',
            bridge: 'Explore within frameworks; they stay open to what\'s discovered'
          },
          {
            persona: 'The Optimizer',
            why: 'Explorer moves fast through ideas; Optimizer wants to validate each',
            competing: 'Divergence vs. convergence; possibility vs. certainty',
            yourNeed: 'Their analysis isn\'t killing creativity, it\'s finding what works',
            theirNeed: 'Your ideas aren\'t random, they\'re generating options',
            bridge: 'Explore widely, then let them optimize the best options'
          }
        ]
      },
      'The Builder': {
        worksWellWith: [
          {
            persona: 'The Pathfinder',
            why: 'Builder creates capability; Pathfinder provides direction',
            complementary: 'Competence meets meaning; utility meets purpose',
            dynamic: '"Here\'s how to build it" meets "Here\'s why it matters"',
            example: 'Builder develops skills; Pathfinder connects them to larger mission'
          },
          {
            persona: 'The Optimizer',
            why: 'Builder implements; Optimizer validates',
            complementary: 'Standards meets certainty; structure meets analysis',
            dynamic: '"Here\'s the proven approach" meets "Let\'s verify it works"',
            example: 'Builder proposes methodology; Optimizer stress-tests it'
          }
        ],
        mayClashWith: [
          {
            persona: 'The Explorer',
            why: 'Builder wants proven methods; Explorer wants to experiment',
            competing: 'Reliability vs. novelty; standards vs. freedom',
            yourNeed: 'Their experiments aren\'t rejection of what works',
            theirNeed: 'Your standards aren\'t resistance to improvement',
            bridge: 'Create sandbox for experiments; they respect core processes'
          },
          {
            persona: 'The Disruptor',
            why: 'Builder builds systematically; Disruptor wants to tear down and rebuild',
            competing: 'Evolution vs. revolution; standards vs. disruption',
            yourNeed: 'Their disruption isn\'t destruction, it\'s clearing obstacles',
            theirNeed: 'Your systems aren\'t bureaucracy, they\'re scaffolding',
            bridge: 'Identify what needs disrupting vs. preserving; work together on rebuild'
          }
        ]
      },
      'The Stabilizer': {
        worksWellWith: [
          {
            persona: 'The Optimizer',
            why: 'Stabilizer maintains calm; Optimizer ensures quality',
            complementary: 'Recovery meets certainty; stability meets analysis',
            dynamic: '"Let\'s stay grounded" meets "Let\'s get it right"',
            example: 'Stabilizer prevents burnout; Optimizer prevents mistakes'
          },
          {
            persona: 'The Guardian',
            why: 'Stabilizer preserves capacity; Guardian preserves relationships',
            complementary: 'Recovery meets care; stability meets belonging',
            dynamic: '"Let\'s pace ourselves" meets "Let\'s take care of each other"',
            example: 'Stabilizer protects energy; Guardian protects people'
          }
        ],
        mayClashWith: [
          {
            persona: 'The Pathfinder',
            why: 'Stabilizer wants consolidation; Pathfinder wants forward movement',
            competing: 'Recovery vs. momentum; stability vs. boldness',
            yourNeed: 'Their push isn\'t burnout-inducing, it\'s opportunity-seizing',
            theirNeed: 'Your pause isn\'t resistance, it\'s sustainability',
            bridge: 'Create recovery windows; commit to change periods'
          },
          {
            persona: 'The Disruptor',
            why: 'Stabilizer preserves what works; Disruptor breaks to rebuild',
            competing: 'Stability vs. disruption; preservation vs. transformation',
            yourNeed: 'Their disruption creates space for something better',
            theirNeed: 'Your stability protects what shouldn\'t be lost',
            bridge: 'Identify sacred cows vs. necessary changes; partner on transition'
          }
        ]
      },
      'The Disruptor': {
        worksWellWith: [
          {
            persona: 'The Truth-Teller',
            why: 'Disruptor breaks inertia; Truth-Teller names what needs breaking',
            complementary: 'Action meets honesty; disruption meets transparency',
            dynamic: '"Let\'s break through" meets "Here\'s what\'s really blocking us"',
            example: 'Truth-Teller identifies dysfunction; Disruptor dismantles it'
          },
          {
            persona: 'The Driver',
            why: 'Disruptor clears the path; Driver moves down it',
            complementary: 'Disruption meets execution; breaking meets building',
            dynamic: '"Let\'s clear the obstacles" meets "Let\'s move forward"',
            example: 'Disruptor removes blocker; Driver capitalizes on opening'
          }
        ],
        mayClashWith: [
          {
            persona: 'The Guardian',
            why: 'Disruptor breaks things; Guardian protects people through change',
            competing: 'Disruption vs. safety; transformation vs. belonging',
            yourNeed: 'Their protection isn\'t weakness, it\'s preserving trust',
            theirNeed: 'Your disruption isn\'t cruelty, it\'s necessary change',
            bridge: 'Disrupt processes not people; they help people through transition'
          },
          {
            persona: 'The Stabilizer',
            why: 'Disruptor creates chaos to transform; Stabilizer creates calm to sustain',
            competing: 'Disruption vs. stability; transformation vs. preservation',
            yourNeed: 'Their stability isn\'t stagnation, it\'s protecting capacity',
            theirNeed: 'Your chaos isn\'t destruction, it\'s creative destruction',
            bridge: 'Create transformation sprints with recovery periods'
          }
        ]
      }
    };

    // Get domain color
    const getDomainColor = (domain) => {
      switch (domain) {
        case 'Lead Self':
          return COLORS.leadSelf;
        case 'Lead Team':
          return COLORS.leadTeam;
        case 'Lead the Org':
          return COLORS.leadOrg;
        default:
          return COLORS.leadTeam;
      }
    };

    // Cluster Prototypes for Pattern Matching
    const CLUSTER_PROTOTYPES = {
      DIRECTION:   ['A','A','A','A','A','B','B','A','A','A','A','A','A','B','A'],
      TRUST:       ['A','A','B','A','B','A','A','B','B','A','B','B','B','A','B'],
      EXECUTION:   ['B','A','A','B','A','B','B','A','A','B','B','A','A','A','B'],
      DEVELOPMENT: ['A','B','B','A','B','A','A','B','B','A','A','B','B','B','A'],
      ADAPTATION:  ['B','B','B','B','B','A','A','B','B','A','B','B','B','A','B']
    };

    // Primary questions for each cluster (zero-indexed)
    const PRIMARY_QUESTIONS = {
      DIRECTION:   [0, 7, 10],   // Q1, Q8, Q11
      TRUST:       [1, 6, 12],   // Q2, Q7, Q13
      EXECUTION:   [2, 8, 11],   // Q3, Q9, Q12
      DEVELOPMENT: [3, 9, 14],   // Q4, Q10, Q15
      ADAPTATION:  [4, 5, 13]    // Q5, Q6, Q14
    };

    // Calculate cluster scores using pattern matching
    const calculateClusterScores = (userAnswers) => {
      const scores = {};

      for (const [cluster, prototype] of Object.entries(CLUSTER_PROTOTYPES)) {
        let matches = 0;
        for (let i = 0; i < 15; i++) {
          if (userAnswers[i] === prototype[i]) {
            matches++;
          }
        }
        scores[cluster] = matches;
      }

      return scores;
    };

    // Assign primary cluster with tiebreaker logic
    const assignPrimaryCluster = (scores, userAnswers) => {
      // Find highest score
      const maxScore = Math.max(...Object.values(scores));
      const topClusters = Object.entries(scores)
        .filter(([cluster, score]) => score === maxScore)
        .map(([cluster]) => cluster);

      // If no tie, return winner
      if (topClusters.length === 1) {
        return {
          cluster: topClusters[0],
          score: maxScore,
          percentage: Math.round((maxScore / 15) * 100)
        };
      }

      // TIEBREAKER 1: Check primary question matches
      let tiebreaker = {};
      for (const cluster of topClusters) {
        const primaryIndices = PRIMARY_QUESTIONS[cluster];
        const prototype = CLUSTER_PROTOTYPES[cluster];
        let primaryMatches = 0;

        for (const idx of primaryIndices) {
          if (userAnswers[idx] === prototype[idx]) {
            primaryMatches++;
          }
        }
        tiebreaker[cluster] = primaryMatches;
      }

      const maxPrimary = Math.max(...Object.values(tiebreaker));
      const primaryWinners = Object.entries(tiebreaker)
        .filter(([cluster, score]) => score === maxPrimary)
        .map(([cluster]) => cluster);

      if (primaryWinners.length === 1) {
        return {
          cluster: primaryWinners[0],
          score: maxScore,
          percentage: Math.round((maxScore / 15) * 100)
        };
      }

      // TIEBREAKER 2: Default hierarchy
      const hierarchy = ['EXECUTION', 'DIRECTION', 'ADAPTATION', 'TRUST', 'DEVELOPMENT'];
      for (const cluster of hierarchy) {
        if (primaryWinners.includes(cluster)) {
          return {
            cluster: cluster,
            score: maxScore,
            percentage: Math.round((maxScore / 15) * 100)
          };
        }
      }

      // Fallback
      return {
        cluster: 'EXECUTION',
        score: maxScore,
        percentage: Math.round((maxScore / 15) * 100)
      };
    };

    // Calculate results from answers
    const calculateResults = (answers) => {
      // Convert answers to array format for pattern matching
      const userAnswers = [];
      for (let i = 1; i <= 15; i++) {
        const answer = answers.find((a) => a.questionId === i);
        userAnswers.push(answer?.answer || 'A');
      }

      // Calculate cluster scores using pattern matching
      const clusterScores = calculateClusterScores(userAnswers);

      // Assign primary cluster with tiebreaker
      const clusterResult = assignPrimaryCluster(clusterScores, userAnswers);
      const primaryCluster = clusterResult.cluster;

      // Build answer details
      const answerDetails = {};
      answers.forEach((answer) => {
        const question = QUESTIONS.find((q) => q.id === answer.questionId);
        if (question) {
          answerDetails[question.id] = {
            ...answer,
            question,
            pole: answer.answer === 'A' ? question.poleA : question.poleB,
          };
        }
      });

      // Determine style within cluster (count A vs B answers for cluster's primary questions)
      const primaryIndices = PRIMARY_QUESTIONS[primaryCluster];
      let aCount = 0;
      let bCount = 0;

      primaryIndices.forEach((idx) => {
        if (userAnswers[idx] === 'A') aCount++;
        else bCount++;
      });

      // Determine persona type (A-leaning or B-leaning)
      const personaType = aCount >= bCount ? 'A' : 'B';
      const persona = PERSONAS[primaryCluster][personaType];

      // Get the three axes for this cluster
      const clusterQuestions = QUESTIONS.filter((q) => q.cluster === primaryCluster);
      const axes = clusterQuestions.map((q) => {
        const answer = answers.find((a) => a.questionId === q.id);
        return {
          skill: q.skill,
          axis: q.axis,
          poleA: q.poleA,
          poleB: q.poleB,
          chosen: answer?.answer || 'A',
          chosenPole: answer?.answer === 'A' ? q.poleA : q.poleB,
        };
      });

      return {
        primaryCluster,
        clusterInfo: CLUSTER_DESCRIPTIONS[primaryCluster],
        persona,
        personaType,
        axes,
        clusterScores,
        matchPercentage: clusterResult.percentage,
        answerDetails,
        isBalanced: aCount === bCount || Math.abs(aCount - bCount) <= 1,
      };
    };

    // ============================================================================
    // COMPONENTS
    // ============================================================================

    // Progress Bar Component
    const ProgressBar = ({ current, total }) => {
      const progress = (current / total) * 100;

      return (
        <div className="w-full h-2 bg-gray-700 rounded-full overflow-hidden">
          <div
            className="h-full transition-all duration-500 ease-out rounded-full"
            style={{
              width: `${progress}%`,
              background: `linear-gradient(90deg, ${COLORS.leadSelf}, ${COLORS.leadTeam}, ${COLORS.leadOrg})`,
            }}
          />
        </div>
      );
    };

    // Animated Background Component
    const AnimatedBackground = () => {
      return (
        <div className="animated-background">
          <div className="gradient-base"></div>
          <div className="orb orb-1"></div>
          <div className="orb orb-2"></div>
          <div className="orb orb-3"></div>
          <div className="orb orb-4"></div>
        </div>
      );
    };

    // Persona Icon SVGs
    // Enhanced Icon Components with Circular Backgrounds
    const DriverIcon = ({ color = '#802B64' }) => (
      <svg width="72" height="72" viewBox="0 0 72 72" fill="none" xmlns="http://www.w3.org/2000/svg">
        {/* Circular background */}
        <circle cx="36" cy="36" r="32" fill={`${color}10`} stroke={`${color}30`} strokeWidth="1" />
        {/* Inner glow ring */}
        <circle cx="36" cy="36" r="28" fill="none" stroke={`${color}15`} strokeWidth="2" />
        {/* Main arrow */}
        <path d="M20 36 L52 36 M52 36 L44 28 M52 36 L44 44" stroke={color} strokeWidth="3" strokeLinecap="round" strokeLinejoin="round" />
        {/* Momentum trails */}
        <g opacity="0.5">
          <line x1="12" y1="30" x2="18" y2="30" stroke={color} strokeWidth="2.5" strokeLinecap="round" />
          <line x1="10" y1="36" x2="16" y2="36" stroke={color} strokeWidth="2.5" strokeLinecap="round" />
          <line x1="12" y1="42" x2="18" y2="42" stroke={color} strokeWidth="2.5" strokeLinecap="round" />
        </g>
      </svg>
    );

    const GuardianIcon = ({ color = '#066DB1' }) => (
      <svg width="72" height="72" viewBox="0 0 72 72" fill="none" xmlns="http://www.w3.org/2000/svg">
        {/* Circular background */}
        <circle cx="36" cy="36" r="32" fill={`${color}10`} stroke={`${color}30`} strokeWidth="1" />
        {/* Inner glow ring */}
        <circle cx="36" cy="36" r="28" fill="none" stroke={`${color}15`} strokeWidth="2" />
        {/* Shield shape */}
        <path d="M36 20 L24 26 L24 38 C24 46 29 51 36 54 C43 51 48 46 48 38 L48 26 Z" stroke={color} strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round" fill={`${color}08`} />
        {/* Heart symbol inside shield */}
        <path d="M31 34 C31 32.5 32 31.5 33 31.5 C34 31.5 35 32.5 35.5 33.5 C35.5 32.5 36.5 31.5 37.5 31.5 C38.5 31.5 40 32.5 40 34 C40 36.5 36 40 36 40 C36 40 31 36.5 31 34 Z" stroke={color} strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" fill={`${color}25`} />
      </svg>
    );

    const PathfinderIcon = ({ color = '#768C12' }) => (
      <svg width="72" height="72" viewBox="0 0 72 72" fill="none" xmlns="http://www.w3.org/2000/svg">
        {/* Circular background */}
        <circle cx="36" cy="36" r="32" fill={`${color}10`} stroke={`${color}30`} strokeWidth="1" />
        {/* Inner glow ring */}
        <circle cx="36" cy="36" r="28" fill="none" stroke={`${color}15`} strokeWidth="2" />
        {/* Compass outer circle */}
        <circle cx="36" cy="36" r="20" stroke={color} strokeWidth="2.5" fill="none" />
        {/* Cardinal point - N marker */}
        <path d="M36 18 L36 24" stroke={color} strokeWidth="2.5" strokeLinecap="round" />
        {/* Compass needle - North (darker) */}
        <path d="M36 36 L40 28 L36 30 L32 36 Z" fill={color} opacity="0.8" />
        {/* Compass needle - South (lighter) */}
        <path d="M36 36 L32 44 L36 42 L40 36 Z" fill={color} opacity="0.3" />
        {/* N letter */}
        <text x="36" y="16" textAnchor="middle" fontSize="9" fontWeight="700" fill={color} fontFamily="Fustat, sans-serif" opacity="0.7">N</text>
      </svg>
    );

    const ExplorerIcon = ({ color = '#768C12' }) => (
      <svg width="72" height="72" viewBox="0 0 72 72" fill="none" xmlns="http://www.w3.org/2000/svg">
        {/* Circular background */}
        <circle cx="36" cy="36" r="32" fill={`${color}10`} stroke={`${color}30`} strokeWidth="1" />
        {/* Inner glow ring */}
        <circle cx="36" cy="36" r="28" fill="none" stroke={`${color}15`} strokeWidth="2" />
        {/* Telescope body */}
        <path d="M48 24 L32 40" stroke={color} strokeWidth="3.5" strokeLinecap="round" />
        <path d="M46 26 L30 42" stroke={color} strokeWidth="3.5" strokeLinecap="round" opacity="0.4" />
        {/* Lens (large end) */}
        <circle cx="49" cy="23" r="5" stroke={color} strokeWidth="2.5" fill={`${color}15`} />
        {/* Eyepiece (small end) */}
        <circle cx="31" cy="41" r="3.5" stroke={color} strokeWidth="2.5" fill={`${color}25`} />
        {/* Discovery stars */}
        <g opacity="0.6">
          <path d="M54 18 L55 20 L57 20 L55 21 L56 23 L54 22 L52 23 L53 21 L51 20 L53 20 Z" fill={color} opacity="0.5" />
          <path d="M58 28 L58.5 29 L59.5 29 L58.5 29.5 L59 30.5 L58 30 L57 30.5 L57.5 29.5 L56.5 29 L57.5 29 Z" fill={color} opacity="0.5" />
          <path d="M52 30 L52.5 31 L53.5 31 L52.5 31.5 L53 32.5 L52 32 L51 32.5 L51.5 31.5 L50.5 31 L51.5 31 Z" fill={color} opacity="0.4" />
        </g>
      </svg>
    );

    // Simple Icon Components for Grid (smaller, optimized for blur effect)
    const ArchitectIconSimple = ({ color = '#768C12' }) => (
      <svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
        <circle cx="24" cy="24" r="20" fill={`${color}15`} stroke={`${color}30`} strokeWidth="1" />
        {/* Blueprint/Grid */}
        <rect x="14" y="14" width="20" height="20" stroke={color} strokeWidth="2" fill="none" rx="2" />
        <line x1="14" y1="24" x2="34" y2="24" stroke={color} strokeWidth="1.5" opacity="0.6" />
        <line x1="24" y1="14" x2="24" y2="34" stroke={color} strokeWidth="1.5" opacity="0.6" />
        {/* Corner markers */}
        <circle cx="14" cy="14" r="2" fill={color} opacity="0.8" />
        <circle cx="34" cy="14" r="2" fill={color} opacity="0.8" />
        <circle cx="14" cy="34" r="2" fill={color} opacity="0.8" />
        <circle cx="34" cy="34" r="2" fill={color} opacity="0.8" />
      </svg>
    );

    const TruthTellerIconSimple = ({ color = '#066DB1' }) => (
      <svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
        <circle cx="24" cy="24" r="20" fill={`${color}15`} stroke={`${color}30`} strokeWidth="1" />
        {/* Speech bubble */}
        <path d="M16 18 C16 14 19 12 24 12 C29 12 32 14 32 18 C32 22 29 24 24 24 L24 28 L20 24 C17 24 16 22 16 18 Z" stroke={color} strokeWidth="2" fill={`${color}10`} strokeLinejoin="round" />
        {/* Exclamation */}
        <line x1="24" y1="15" x2="24" y2="19" stroke={color} strokeWidth="2" strokeLinecap="round" />
        <circle cx="24" cy="21" r="1" fill={color} />
        {/* Sound waves */}
        <path d="M33 16 Q35 18 33 20" stroke={color} strokeWidth="1.5" fill="none" opacity="0.5" />
        <path d="M35 14 Q38 18 35 22" stroke={color} strokeWidth="1.5" fill="none" opacity="0.3" />
      </svg>
    );

    const OptimizerIconSimple = ({ color = '#802B64' }) => (
      <svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
        <circle cx="24" cy="24" r="20" fill={`${color}15`} stroke={`${color}30`} strokeWidth="1" />
        {/* Gauge/dial */}
        <circle cx="24" cy="26" r="12" stroke={color} strokeWidth="2" fill="none" />
        {/* Tick marks */}
        <line x1="24" y1="16" x2="24" y2="18" stroke={color} strokeWidth="2" strokeLinecap="round" />
        <line x1="14" y1="26" x2="16" y2="26" stroke={color} strokeWidth="2" strokeLinecap="round" />
        <line x1="32" y1="26" x2="34" y2="26" stroke={color} strokeWidth="2" strokeLinecap="round" />
        {/* Needle pointing to optimal */}
        <line x1="24" y1="26" x2="30" y2="20" stroke={color} strokeWidth="2.5" strokeLinecap="round" />
        <circle cx="24" cy="26" r="2.5" fill={color} />
      </svg>
    );

    const BuilderIconSimple = ({ color = '#768C12' }) => (
      <svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
        <circle cx="24" cy="24" r="20" fill={`${color}15`} stroke={`${color}30`} strokeWidth="1" />
        {/* Stacked blocks */}
        <rect x="14" y="28" width="20" height="8" stroke={color} strokeWidth="2" fill={`${color}10`} rx="1" />
        <rect x="17" y="20" width="14" height="8" stroke={color} strokeWidth="2" fill={`${color}10`} rx="1" />
        <rect x="20" y="12" width="8" height="8" stroke={color} strokeWidth="2" fill={`${color}10`} rx="1" />
        {/* Plus sign on top block */}
        <line x1="24" y1="14" x2="24" y2="18" stroke={color} strokeWidth="1.5" strokeLinecap="round" opacity="0.6" />
        <line x1="22" y1="16" x2="26" y2="16" stroke={color} strokeWidth="1.5" strokeLinecap="round" opacity="0.6" />
      </svg>
    );

    const StabilizerIconSimple = ({ color = '#802B64' }) => (
      <svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
        <circle cx="24" cy="24" r="20" fill={`${color}15`} stroke={`${color}30`} strokeWidth="1" />
        {/* Anchor shape */}
        <circle cx="24" cy="16" r="4" stroke={color} strokeWidth="2" fill="none" />
        <line x1="24" y1="20" x2="24" y2="34" stroke={color} strokeWidth="2.5" strokeLinecap="round" />
        <path d="M16 28 Q24 36 32 28" stroke={color} strokeWidth="2.5" fill="none" strokeLinecap="round" />
        {/* Horizontal stability bar */}
        <line x1="18" y1="24" x2="30" y2="24" stroke={color} strokeWidth="2" strokeLinecap="round" opacity="0.6" />
      </svg>
    );

    const DisruptorIconSimple = ({ color = '#802B64' }) => (
      <svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
        <circle cx="24" cy="24" r="20" fill={`${color}15`} stroke={`${color}30`} strokeWidth="1" />
        {/* Lightning bolt */}
        <path d="M26 12 L20 24 L26 24 L22 36 L28 24 L22 24 L26 12 Z" fill={color} stroke={color} strokeWidth="1" strokeLinejoin="round" />
        {/* Spark lines */}
        <line x1="14" y1="18" x2="18" y2="20" stroke={color} strokeWidth="1.5" strokeLinecap="round" opacity="0.5" />
        <line x1="30" y1="20" x2="34" y2="18" stroke={color} strokeWidth="1.5" strokeLinecap="round" opacity="0.5" />
        <line x1="14" y1="30" x2="18" y2="28" stroke={color} strokeWidth="1.5" strokeLinecap="round" opacity="0.5" />
        <line x1="30" y1="28" x2="34" y2="30" stroke={color} strokeWidth="1.5" strokeLinecap="round" opacity="0.5" />
      </svg>
    );

    // Domain Icons for Skills Cards
    const LeadSelfIcon = () => (
      <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
        {/* Single person silhouette */}
        <circle cx="20" cy="12" r="6" stroke="rgba(255, 255, 255, 0.7)" strokeWidth="2" fill="none" />
        <path
          d="M10 35 Q10 22 20 22 Q30 22 30 35"
          stroke="rgba(255, 255, 255, 0.7)"
          strokeWidth="2"
          fill="none"
          strokeLinecap="round"
        />
      </svg>
    );

    const LeadTeamIcon = () => (
      <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
        {/* Three people silhouettes */}
        {/* Center person */}
        <circle cx="20" cy="12" r="5" stroke="rgba(255, 255, 255, 0.7)" strokeWidth="2" fill="none" />
        <path
          d="M12 32 Q12 22 20 22 Q28 22 28 32"
          stroke="rgba(255, 255, 255, 0.7)"
          strokeWidth="2"
          fill="none"
        />
        {/* Left person (partial) */}
        <circle cx="8" cy="14" r="4" stroke="rgba(255, 255, 255, 0.5)" strokeWidth="2" fill="none" />
        <path
          d="M2 32 Q2 24 8 24"
          stroke="rgba(255, 255, 255, 0.5)"
          strokeWidth="2"
          fill="none"
        />
        {/* Right person (partial) */}
        <circle cx="32" cy="14" r="4" stroke="rgba(255, 255, 255, 0.5)" strokeWidth="2" fill="none" />
        <path
          d="M38 32 Q38 24 32 24"
          stroke="rgba(255, 255, 255, 0.5)"
          strokeWidth="2"
          fill="none"
        />
      </svg>
    );

    const LeadOrgIcon = () => (
      <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
        {/* Building/organizational structure */}
        <rect
          x="12" y="8" width="16" height="28"
          stroke="rgba(255, 255, 255, 0.7)"
          strokeWidth="2"
          fill="none"
          rx="2"
        />
        {/* Windows/levels */}
        <rect x="16" y="12" width="3" height="3" fill="rgba(255, 255, 255, 0.5)" />
        <rect x="21" y="12" width="3" height="3" fill="rgba(255, 255, 255, 0.5)" />
        <rect x="16" y="18" width="3" height="3" fill="rgba(255, 255, 255, 0.5)" />
        <rect x="21" y="18" width="3" height="3" fill="rgba(255, 255, 255, 0.5)" />
        <rect x="16" y="24" width="3" height="3" fill="rgba(255, 255, 255, 0.5)" />
        <rect x="21" y="24" width="3" height="3" fill="rgba(255, 255, 255, 0.5)" />
        {/* Door */}
        <rect x="17" y="30" width="6" height="6" fill="rgba(255, 255, 255, 0.7)" />
      </svg>
    );

    // Domain Icon mapping
    const DOMAIN_ICONS = {
      'Self': LeadSelfIcon,
      'Team': LeadTeamIcon,
      'Org': LeadOrgIcon
    };

    // Simple versions of existing icons for the grid
    const PathfinderIconSimple = ({ color = '#768C12' }) => (
      <svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
        <circle cx="24" cy="24" r="20" fill={`${color}15`} stroke={`${color}30`} strokeWidth="1" />
        {/* Compass */}
        <circle cx="24" cy="24" r="12" stroke={color} strokeWidth="2" fill="none" />
        <path d="M24 24 L27 18 L24 20 L21 24 Z" fill={color} opacity="0.8" />
        <path d="M24 24 L21 30 L24 28 L27 24 Z" fill={color} opacity="0.3" />
        <text x="24" y="11" textAnchor="middle" fontSize="7" fontWeight="700" fill={color} fontFamily="Fustat, sans-serif" opacity="0.7">N</text>
      </svg>
    );

    const DriverIconSimple = ({ color = '#802B64' }) => (
      <svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
        <circle cx="24" cy="24" r="20" fill={`${color}15`} stroke={`${color}30`} strokeWidth="1" />
        {/* Arrow */}
        <path d="M14 24 L34 24 M34 24 L28 18 M34 24 L28 30" stroke={color} strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round" />
        {/* Momentum lines */}
        <line x1="10" y1="20" x2="14" y2="20" stroke={color} strokeWidth="2" strokeLinecap="round" opacity="0.4" />
        <line x1="8" y1="24" x2="12" y2="24" stroke={color} strokeWidth="2" strokeLinecap="round" opacity="0.4" />
        <line x1="10" y1="28" x2="14" y2="28" stroke={color} strokeWidth="2" strokeLinecap="round" opacity="0.4" />
      </svg>
    );

    const GuardianIconSimple = ({ color = '#066DB1' }) => (
      <svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
        <circle cx="24" cy="24" r="20" fill={`${color}15`} stroke={`${color}30`} strokeWidth="1" />
        {/* Shield */}
        <path d="M24 14 L16 18 L16 26 C16 32 19 35 24 38 C29 35 32 32 32 26 L32 18 Z" stroke={color} strokeWidth="2" fill={`${color}08`} strokeLinejoin="round" />
        {/* Heart */}
        <path d="M21 24 C21 23 22 22 23 22 C24 22 24.5 23 24 24 C24.5 23 25 22 26 22 C27 22 27.5 23 27.5 24 C27.5 26 24 28 24 28 C24 28 21 26 21 24 Z" fill={color} opacity="0.6" />
      </svg>
    );

    const ExplorerIconSimple = ({ color = '#768C12' }) => (
      <svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
        <circle cx="24" cy="24" r="20" fill={`${color}15`} stroke={`${color}30`} strokeWidth="1" />
        {/* Telescope */}
        <path d="M32 16 L22 26" stroke={color} strokeWidth="3" strokeLinecap="round" />
        <circle cx="33" cy="15" r="4" stroke={color} strokeWidth="2" fill={`${color}15`} />
        <circle cx="21" cy="27" r="3" stroke={color} strokeWidth="2" fill={`${color}20`} />
        {/* Stars */}
        <circle cx="36" cy="22" r="1.5" fill={color} opacity="0.5" />
        <circle cx="38" cy="14" r="1" fill={color} opacity="0.4" />
      </svg>
    );

    // Persona Card Component - Enhanced
    const PersonaCard = ({ persona, scrollY }) => {
      const { type, name, cluster, tagline, icon, depth, color, colorName, rotation } = persona;

      // Calculate parallax based on depth
      const parallaxMultiplier = depth === 'back' ? 0.2 : depth === 'mid' ? 0.6 : 1;
      const parallaxOffset = scrollY * parallaxMultiplier * 0.5;

      const style = {
        '--card-color': color,
      };

      const IconComponent = {
        driver: DriverIcon,
        guardian: GuardianIcon,
        pathfinder: PathfinderIcon,
        explorer: ExplorerIcon,
      }[icon];

      return (
        <div
          className={`persona-card ${type} depth-${depth} float-${type === 'driver' ? '1' : type === 'guardian' ? '2' : type === 'pathfinder' ? '3' : '4'}`}
          data-color={colorName}
          style={style}
        >
          <div className="card-inner" style={{ transform: `translateY(${parallaxOffset}px)` }}>
            {/* Gradient overlay */}
            <div className="card-gradient" style={{ background: `linear-gradient(135deg, ${color}15 0%, transparent 100%)` }} />

            {/* Icon */}
            <div className="card-icon">
              <IconComponent color={color} />
            </div>

            {/* Info */}
            <div className="card-info">
              <h4 className="persona-name">{name}</h4>
              <p className="persona-cluster">{cluster}</p>
              <p className="persona-tagline">{tagline}</p>
            </div>
          </div>
        </div>
      );
    };

    // Persona Grid Card Component - Simple card for the grid
    const PersonaGridCard = ({ persona, index }) => {
      const { name, cluster, color, Icon } = persona;

      return (
        <div className="persona-grid-card" style={{ animationDelay: `${index * 0.15}s, ${0.6 + index * 0.15}s` }}>
          <div className="grid-card-inner">
            {/* Gradient overlay */}
            <div className="grid-card-gradient" style={{ background: `linear-gradient(135deg, ${color}15 0%, transparent 100%)` }} />

            {/* Icon */}
            <div className="grid-card-icon">
              <Icon color={color} />
            </div>

            {/* Info */}
            <div className="grid-card-info">
              <h4 className="grid-persona-name">{name}</h4>
              <p className="grid-persona-cluster">{cluster}</p>
            </div>
          </div>
        </div>
      );
    };

    // Persona Grid Background Component - 10 Cards in 5x2 Grid
    const PersonaCardsBackground = ({ scrollY }) => {
      // All 10 personas organized by cluster pairs
      const personas = [
        // Row 1 (Direction, Trust, Execution, Development, Adaptation - A poles)
        { name: 'The Pathfinder', cluster: 'Direction', color: '#768C12', Icon: PathfinderIconSimple },
        { name: 'The Truth-Teller', cluster: 'Trust', color: '#066DB1', Icon: TruthTellerIconSimple },
        { name: 'The Driver', cluster: 'Execution', color: '#802B64', Icon: DriverIconSimple },
        { name: 'The Explorer', cluster: 'Development', color: '#768C12', Icon: ExplorerIconSimple },
        { name: 'The Stabilizer', cluster: 'Adaptation', color: '#802B64', Icon: StabilizerIconSimple },
        // Row 2 (Direction, Trust, Execution, Development, Adaptation - B poles)
        { name: 'The Architect', cluster: 'Direction', color: '#768C12', Icon: ArchitectIconSimple },
        { name: 'The Guardian', cluster: 'Trust', color: '#066DB1', Icon: GuardianIconSimple },
        { name: 'The Optimizer', cluster: 'Execution', color: '#802B64', Icon: OptimizerIconSimple },
        { name: 'The Builder', cluster: 'Development', color: '#768C12', Icon: BuilderIconSimple },
        { name: 'The Disruptor', cluster: 'Adaptation', color: '#802B64', Icon: DisruptorIconSimple },
      ];

      return (
        <div className="persona-grid-background">
          <div className="persona-grid-container">
            {personas.map((persona, index) => (
              <PersonaGridCard key={persona.name} persona={persona} index={index} />
            ))}
          </div>
        </div>
      );
    };

    // ============================================================================
    // PRE-ASSESSMENT SCREEN ILLUSTRATIONS
    // ============================================================================

    // Scale Illustration - Screen 1 (balanced scale showing tradeoffs)
    const ScaleIllustration = () => (
      <svg width="360" height="360" viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg">
        {/* Base */}
        <rect x="80" y="170" width="40" height="8" fill="rgba(255, 255, 255, 0.3)" rx="4" className="scale-base" />
        {/* Pole */}
        <rect x="98" y="90" width="4" height="80" fill="rgba(255, 255, 255, 0.4)" rx="2" className="scale-pole" />
        {/* Balance beam */}
        <line x1="40" y1="90" x2="160" y2="90" stroke="rgba(255, 255, 255, 0.5)" strokeWidth="4" strokeLinecap="round" className="scale-beam" />
        {/* Fulcrum */}
        <path d="M100 88 L94 96 L106 96 Z" fill="rgba(255, 255, 255, 0.5)" />
        {/* Left pan */}
        <g className="scale-left">
          <line x1="40" y1="90" x2="35" y2="70" stroke="rgba(255, 255, 255, 0.3)" strokeWidth="2" />
          <line x1="40" y1="90" x2="45" y2="70" stroke="rgba(255, 255, 255, 0.3)" strokeWidth="2" />
          <ellipse cx="40" cy="68" rx="18" ry="5" fill="rgba(118, 140, 18, 0.15)" stroke="rgba(118, 140, 18, 0.5)" strokeWidth="2" />
        </g>
        {/* Right pan */}
        <g className="scale-right">
          <line x1="160" y1="90" x2="155" y2="70" stroke="rgba(255, 255, 255, 0.3)" strokeWidth="2" />
          <line x1="160" y1="90" x2="165" y2="70" stroke="rgba(255, 255, 255, 0.3)" strokeWidth="2" />
          <ellipse cx="160" cy="68" rx="18" ry="5" fill="rgba(6, 109, 177, 0.15)" stroke="rgba(6, 109, 177, 0.5)" strokeWidth="2" />
        </g>
        {/* Labels */}
        <text x="40" y="52" textAnchor="middle" fill="rgba(255, 255, 255, 0.5)" fontSize="11" fontFamily="Fustat, sans-serif">Choice A</text>
        <text x="160" y="52" textAnchor="middle" fill="rgba(255, 255, 255, 0.5)" fontSize="11" fontFamily="Fustat, sans-serif">Choice B</text>
      </svg>
    );

    // Paths Illustration - Screen 2 (two diverging paths)
    const PathsIllustration = () => (
      <svg width="360" height="360" viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg">
        {/* Starting point */}
        <circle cx="100" cy="165" r="10" fill="rgba(255, 255, 255, 0.2)" stroke="rgba(255, 255, 255, 0.5)" strokeWidth="2" />
        {/* Left path */}
        <path d="M100 155 Q55 110 35 55" stroke="rgba(118, 140, 18, 0.6)" strokeWidth="3" strokeLinecap="round" fill="none" />
        {/* Right path */}
        <path d="M100 155 Q145 110 165 55" stroke="rgba(6, 109, 177, 0.6)" strokeWidth="3" strokeLinecap="round" fill="none" />
        {/* Left endpoint */}
        <circle cx="35" cy="50" r="14" fill="rgba(118, 140, 18, 0.15)" stroke="rgba(118, 140, 18, 0.6)" strokeWidth="2" />
        <text x="35" y="30" textAnchor="middle" fill="rgba(255, 255, 255, 0.5)" fontSize="11" fontFamily="Fustat, sans-serif">Path A</text>
        {/* Right endpoint */}
        <circle cx="165" cy="50" r="14" fill="rgba(6, 109, 177, 0.15)" stroke="rgba(6, 109, 177, 0.6)" strokeWidth="2" />
        <text x="165" y="30" textAnchor="middle" fill="rgba(255, 255, 255, 0.5)" fontSize="11" fontFamily="Fustat, sans-serif">Path B</text>
        {/* You label at start */}
        <text x="100" y="190" textAnchor="middle" fill="rgba(255, 255, 255, 0.6)" fontSize="12" fontFamily="Fustat, sans-serif">You</text>
      </svg>
    );

    // Outcomes Illustration - Screen 3 (three stacked icons)
    const OutcomesIllustration = () => (
      <svg width="360" height="360" viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg">
        {/* Engine - Compass icon */}
        <g>
          <circle cx="60" cy="50" r="22" fill="rgba(118, 140, 18, 0.1)" stroke="rgba(118, 140, 18, 0.5)" strokeWidth="2" />
          <circle cx="60" cy="50" r="12" stroke="rgba(118, 140, 18, 0.6)" strokeWidth="2" fill="none" />
          <path d="M60 50 L63 42 L60 45 L57 50 Z" fill="rgba(118, 140, 18, 0.8)" />
          <path d="M60 50 L57 58 L60 55 L63 50 Z" fill="rgba(118, 140, 18, 0.4)" />
          <text x="95" y="55" fill="rgba(255, 255, 255, 0.6)" fontSize="13" fontFamily="Fustat, sans-serif">Your Engine</text>
        </g>
        {/* Tradeoffs - Scale icon */}
        <g>
          <circle cx="60" cy="105" r="22" fill="rgba(6, 109, 177, 0.1)" stroke="rgba(6, 109, 177, 0.5)" strokeWidth="2" />
          <line x1="48" y1="100" x2="72" y2="100" stroke="rgba(6, 109, 177, 0.7)" strokeWidth="2.5" strokeLinecap="round" />
          <line x1="60" y1="100" x2="60" y2="115" stroke="rgba(6, 109, 177, 0.7)" strokeWidth="2.5" strokeLinecap="round" />
          <circle cx="48" cy="98" r="4" fill="rgba(6, 109, 177, 0.3)" stroke="rgba(6, 109, 177, 0.6)" strokeWidth="1.5" />
          <circle cx="72" cy="98" r="4" fill="rgba(6, 109, 177, 0.3)" stroke="rgba(6, 109, 177, 0.6)" strokeWidth="1.5" />
          <text x="95" y="110" fill="rgba(255, 255, 255, 0.6)" fontSize="13" fontFamily="Fustat, sans-serif">Your Tradeoffs</text>
        </g>
        {/* Pattern - Lightning icon */}
        <g>
          <circle cx="60" cy="160" r="22" fill="rgba(128, 43, 100, 0.1)" stroke="rgba(128, 43, 100, 0.5)" strokeWidth="2" />
          <path d="M64 148 L56 160 L62 160 L56 172 L68 157 L62 157 L64 148 Z" fill="rgba(128, 43, 100, 0.7)" />
          <text x="95" y="165" fill="rgba(255, 255, 255, 0.6)" fontSize="13" fontFamily="Fustat, sans-serif">Your Pattern</text>
        </g>
      </svg>
    );

    // ============================================================================
    // PRE-ASSESSMENT SCREEN COMPONENT
    // ============================================================================

    const PreAssessmentScreen = ({ screenNumber, onContinue, onBack }) => {
      const [typedText, setTypedText] = React.useState('');
      const [showContent, setShowContent] = React.useState(false);
      const [autoAdvanceTimer, setAutoAdvanceTimer] = React.useState(6);

      const screens = {
        1: {
          headline: "This isn't a personality test.",
          body: [
            "Leadership is about choices, not traits.",
            "Every decision involves a tradeoff. Under pressure, you default to one side. That's your pattern."
          ],
          visual: 'scale'
        },
        2: {
          headline: "15 questions. Real choices.",
          body: [
            "You'll choose between two leadership approaches. Neither is right or wrong. Both have costs.",
            "Your answers reveal where you naturally lean—and where you might overuse your strengths."
          ],
          visual: 'paths'
        },
        3: {
          headline: "In 5 minutes, you'll see yourself differently.",
          bodyIntro: "You'll discover:",
          bullets: [
            "Your leadership engine",
            "Where you lean on key tradeoffs",
            "Your pressure pattern—and how to stay balanced"
          ],
          visual: 'outcomes',
          finalScreen: true
        }
      };

      const currentScreen = screens[screenNumber];
      const typingSpeed = 40;

      // Refs for smooth typing
      const typingRef = React.useRef(null);
      const animationRef = React.useRef(null);
      const stateRef = React.useRef({ char: 0, isTyping: true });

      // Typing animation using RAF
      React.useEffect(() => {
        stateRef.current = { char: 0, isTyping: true };
        setTypedText('');
        setShowContent(false);
        setAutoAdvanceTimer(6);

        let lastTime = 0;
        const headline = currentScreen.headline;

        const typeNextChar = (timestamp) => {
          if (!stateRef.current.isTyping) return;

          if (!lastTime) lastTime = timestamp;
          const elapsed = timestamp - lastTime;

          if (elapsed >= typingSpeed) {
            lastTime = timestamp;
            stateRef.current.char++;

            if (stateRef.current.char <= headline.length) {
              setTypedText(headline.slice(0, stateRef.current.char));
              animationRef.current = requestAnimationFrame(typeNextChar);
            } else {
              // Typing complete, show content after brief pause
              setTimeout(() => {
                setShowContent(true);
              }, 400);
            }
          } else {
            animationRef.current = requestAnimationFrame(typeNextChar);
          }
        };

        animationRef.current = requestAnimationFrame(typeNextChar);

        return () => {
          stateRef.current.isTyping = false;
          if (animationRef.current) cancelAnimationFrame(animationRef.current);
        };
      }, [screenNumber]);

      // Auto-advance countdown
      React.useEffect(() => {
        if (showContent && autoAdvanceTimer > 0) {
          const timer = setTimeout(() => {
            setAutoAdvanceTimer(autoAdvanceTimer - 1);
          }, 1000);
          return () => clearTimeout(timer);
        } else if (showContent && autoAdvanceTimer === 0) {
          onContinue();
        }
      }, [showContent, autoAdvanceTimer, onContinue]);

      // Keyboard support
      React.useEffect(() => {
        const handleKeyPress = (e) => {
          if (showContent && (e.key === 'Enter' || e.key === ' ')) {
            e.preventDefault();
            onContinue();
          }
        };
        window.addEventListener('keydown', handleKeyPress);
        return () => window.removeEventListener('keydown', handleKeyPress);
      }, [showContent, onContinue]);

      return (
        <div className="pre-assessment-screen">
          <AnimatedBackground />

          {/* Back button */}
          {onBack && (
            <button className="back-button" onClick={onBack}>
              <svg viewBox="0 0 16 16" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round">
                <path d="M10 12L6 8L10 4" />
              </svg>
              Back
            </button>
          )}

          {/* Progress indicator */}
          <div className="progress-indicator">
            <div className="progress-dots">
              {[1, 2, 3].map((num) => (
                <div
                  key={num}
                  className={`progress-dot ${num === screenNumber ? 'active' : ''} ${num < screenNumber ? 'complete' : ''}`}
                />
              ))}
            </div>
          </div>

          {/* Main content */}
          <div className="screen-content">
            {/* Typed headline */}
            <div className="screen-headline">
              <h1>
                {typedText}
                <span className="cursor">_</span>
              </h1>
            </div>

            {/* Content that fades in after typing */}
            <div className={`screen-body ${showContent ? 'visible' : ''}`}>
              <div className="body-text">
                {currentScreen.body && currentScreen.body.map((paragraph, index) => (
                  <p key={index}>{paragraph}</p>
                ))}
                {currentScreen.bodyIntro && (
                  <>
                    <p>{currentScreen.bodyIntro}</p>
                    <div className="bullet-list">
                      {currentScreen.bullets.map((bullet, index) => (
                        <div key={index} className="bullet-item">{bullet}</div>
                      ))}
                    </div>
                  </>
                )}
              </div>

              <div className="screen-visual">
                {currentScreen.visual === 'scale' && <ScaleIllustration />}
                {currentScreen.visual === 'paths' && <PathsIllustration />}
                {currentScreen.visual === 'outcomes' && <OutcomesIllustration />}
              </div>
            </div>

            {/* Continue button */}
            <div className={`screen-footer ${showContent ? 'visible' : ''}`}>
              <button className="continue-button" onClick={onContinue}>
                {currentScreen.finalScreen ? 'Begin Assessment' : 'Continue'}
              </button>
              <div className="auto-advance-hint">
                Auto-advancing in {autoAdvanceTimer}s • Press Enter to skip
              </div>
            </div>
          </div>
        </div>
      );
    };

    // ============================================================================
    // POST-ASSESSMENT SCREEN COMPONENTS
    // ============================================================================

    // Pattern Visualization for Calculating Screen
    const PatternVisualization = () => {
      const nodes = [
        { x: 150, y: 100, size: 12, delay: 0 },
        { x: 70, y: 60, size: 8, delay: 0.5 },
        { x: 230, y: 60, size: 8, delay: 0.6 },
        { x: 70, y: 140, size: 8, delay: 0.7 },
        { x: 230, y: 140, size: 8, delay: 0.8 },
      ];

      const lines = [
        { x1: 150, y1: 100, x2: 70, y2: 60, delay: 0.1 },
        { x1: 150, y1: 100, x2: 230, y2: 60, delay: 0.2 },
        { x1: 150, y1: 100, x2: 70, y2: 140, delay: 0.3 },
        { x1: 150, y1: 100, x2: 230, y2: 140, delay: 0.4 },
      ];

      return (
        <svg width="300" height="200" viewBox="0 0 300 200" fill="none">
          {/* Connecting lines */}
          {lines.map((line, index) => (
            <line
              key={index}
              x1={line.x1} y1={line.y1}
              x2={line.x2} y2={line.y2}
              stroke="rgba(255, 255, 255, 0.3)"
              strokeWidth="2"
              className="pattern-line"
              style={{ animationDelay: `${line.delay}s` }}
            />
          ))}

          {/* Nodes */}
          {nodes.map((node, index) => (
            <g key={index}>
              <circle
                cx={node.x} cy={node.y}
                r={node.size}
                fill={index === 0 ? "rgba(118, 140, 18, 0.3)" : "rgba(6, 109, 177, 0.2)"}
                stroke={index === 0 ? "rgba(118, 140, 18, 0.8)" : "rgba(6, 109, 177, 0.6)"}
                strokeWidth="2"
                className="pattern-node"
                style={{ animationDelay: `${node.delay}s` }}
              />
            </g>
          ))}

          {/* Pulsing rings on center */}
          <circle
            cx="150" cy="100" r="12"
            fill="none"
            stroke="rgba(118, 140, 18, 0.6)"
            strokeWidth="2"
            className="pattern-pulse"
          />
        </svg>
      );
    };

    // Calculating Screen Component
    const CalculatingScreen = ({ onComplete }) => {
      const [typedText, setTypedText] = React.useState('');
      const [showPattern, setShowPattern] = React.useState(false);
      const headline = "Analyzing your 15 choices...";
      const typingSpeed = 30;

      const typingRef = React.useRef(null);
      const animationRef = React.useRef(null);
      const stateRef = React.useRef({ char: 0, isTyping: true });

      // Typing animation using RAF
      React.useEffect(() => {
        stateRef.current = { char: 0, isTyping: true };
        setTypedText('');

        let lastTime = 0;

        const typeNextChar = (timestamp) => {
          if (!stateRef.current.isTyping) return;

          if (!lastTime) lastTime = timestamp;
          const elapsed = timestamp - lastTime;

          if (elapsed >= typingSpeed) {
            lastTime = timestamp;
            stateRef.current.char++;

            if (stateRef.current.char <= headline.length) {
              setTypedText(headline.slice(0, stateRef.current.char));
              animationRef.current = requestAnimationFrame(typeNextChar);
            } else {
              // Typing complete, show pattern
              setTimeout(() => {
                setShowPattern(true);
              }, 500);
            }
          } else {
            animationRef.current = requestAnimationFrame(typeNextChar);
          }
        };

        animationRef.current = requestAnimationFrame(typeNextChar);

        return () => {
          stateRef.current.isTyping = false;
          if (animationRef.current) cancelAnimationFrame(animationRef.current);
        };
      }, []);

      // Auto-advance after pattern shows
      React.useEffect(() => {
        if (showPattern) {
          const timer = setTimeout(() => {
            onComplete();
          }, 1500);
          return () => clearTimeout(timer);
        }
      }, [showPattern, onComplete]);

      return (
        <div className="calculating-screen">
          <AnimatedBackground />

          <div className="calculating-content">
            <div className="calculating-headline">
              <h2>
                {typedText}
                {typedText.length < headline.length && <span className="cursor">_</span>}
              </h2>
            </div>

            <div className={`pattern-animation ${showPattern ? 'visible' : ''}`}>
              <PatternVisualization />
            </div>
          </div>
        </div>
      );
    };

    // Progressive Reveal Screen - Sophisticated with Typing Animation
    // Stage 1 (7s): Text types, then engines appear with stagger
    // Stage 2 (4s): "Your leadership engine is..." types, engines highlight/fade
    // Stage 3 (5.5s): Text types, side-by-side layout with skills
    // Stage 4 (manual): Text types, personas with taglines
    const ProgressiveRevealScreen = ({ userCluster, onContinue }) => {
      const [stage, setStage] = useState(1);

      // Typing state
      const [typedText, setTypedText] = useState('');
      const [currentLineIndex, setCurrentLineIndex] = useState(0);
      const [showCursor, setShowCursor] = useState(true);
      const [typingComplete, setTypingComplete] = useState(false);

      // Element visibility
      const [enginesVisible, setEnginesVisible] = useState([false, false, false, false, false]);
      const [skillsVisible, setSkillsVisible] = useState([false, false, false]);
      const [personasVisible, setPersonasVisible] = useState([false, false]);
      const [questionVisible, setQuestionVisible] = useState(false);
      const [buttonVisible, setButtonVisible] = useState(false);
      const [engineIconVisible, setEngineIconVisible] = useState(false);

      // Engine data for the circular layout
      const engines = [
        { name: 'Direction', cluster: 'DIRECTION', angle: -90, color: COLORS.leadSelf },
        { name: 'Trust', cluster: 'TRUST', angle: -18, color: COLORS.leadTeam },
        { name: 'Execution', cluster: 'EXECUTION', angle: 54, color: COLORS.leadOrg },
        { name: 'Development', cluster: 'DEVELOPMENT', angle: 126, color: COLORS.leadSelf },
        { name: 'Adaptation', cluster: 'ADAPTATION', angle: 198, color: COLORS.leadTeam }
      ];

      // Cluster skills data with domain labels
      const clusterSkills = {
        'DIRECTION': [
          { name: 'Purpose', level: 'Self', domain: 'Lead Self' },
          { name: 'Alignment', level: 'Team', domain: 'Lead the Team' },
          { name: 'Vision', level: 'Org', domain: 'Lead the Org' }
        ],
        'TRUST': [
          { name: 'Integrity', level: 'Self', domain: 'Lead Self' },
          { name: 'Psychological Safety', level: 'Team', domain: 'Lead the Team' },
          { name: 'Culture', level: 'Org', domain: 'Lead the Org' }
        ],
        'EXECUTION': [
          { name: 'Accountability', level: 'Self', domain: 'Lead Self' },
          { name: 'Decision Making', level: 'Team', domain: 'Lead the Team' },
          { name: 'Strategy', level: 'Org', domain: 'Lead the Org' }
        ],
        'DEVELOPMENT': [
          { name: 'Learning', level: 'Self', domain: 'Lead Self' },
          { name: 'Coaching', level: 'Team', domain: 'Lead the Team' },
          { name: 'Innovation', level: 'Org', domain: 'Lead the Org' }
        ],
        'ADAPTATION': [
          { name: 'Resilience', level: 'Self', domain: 'Lead Self' },
          { name: 'Emotional Intelligence', level: 'Team', domain: 'Lead the Team' },
          { name: 'Change', level: 'Org', domain: 'Lead the Org' }
        ]
      };

      // Cluster personas with taglines
      const clusterPersonas = {
        'DIRECTION': [
          { name: 'The Pathfinder', icon: PathfinderIconSimple, tagline: 'You see the way forward' },
          { name: 'The Architect', icon: ArchitectIconSimple, tagline: 'You design the future' }
        ],
        'TRUST': [
          { name: 'The Guardian', icon: GuardianIconSimple, tagline: 'You protect what matters' },
          { name: 'The Truth-Teller', icon: TruthTellerIconSimple, tagline: 'You speak hard truths' }
        ],
        'EXECUTION': [
          { name: 'The Driver', icon: DriverIconSimple, tagline: 'You make it happen' },
          { name: 'The Optimizer', icon: OptimizerIconSimple, tagline: 'You make it better' }
        ],
        'DEVELOPMENT': [
          { name: 'The Explorer', icon: ExplorerIconSimple, tagline: 'You discover new possibilities' },
          { name: 'The Builder', icon: BuilderIconSimple, tagline: 'You grow people and systems' }
        ],
        'ADAPTATION': [
          { name: 'The Stabilizer', icon: StabilizerIconSimple, tagline: 'You anchor in chaos' },
          { name: 'The Disruptor', icon: DisruptorIconSimple, tagline: 'You challenge what\'s settled' }
        ]
      };

      // Get cluster color
      const getClusterColor = (cluster) => {
        switch (cluster) {
          case 'DIRECTION': return COLORS.leadSelf;
          case 'TRUST': return COLORS.leadTeam;
          case 'EXECUTION': return COLORS.leadOrg;
          case 'DEVELOPMENT': return COLORS.leadSelf;
          case 'ADAPTATION': return COLORS.leadTeam;
          default: return COLORS.leadTeam;
        }
      };

      const userClusterColor = getClusterColor(userCluster);
      const userClusterName = userCluster.charAt(0) + userCluster.slice(1).toLowerCase();
      const ClusterIcon = CLUSTER_ICONS[userCluster];

      // Stage content
      const stageContent = {
        1: [
          'Every leader is powered by one of five engines.',
          'Your engine is the key strength you rely on when you want to create impact.'
        ],
        2: [`Your leadership engine is ${userClusterName}`],
        3: ['Each engine is built from three core skills, one personal, one team-oriented, and one org-focused:'],
        4: ['Two types of leaders share this engine.', 'Which one are you?']
      };

      // Typing speeds per stage (ms per character)
      const typingSpeeds = { 1: 50, 2: 40, 3: 40, 4: 45 };
      const pauseBetweenLines = 400;

      // Typing animation effect
      useEffect(() => {
        const lines = stageContent[stage] || [];
        const speed = typingSpeeds[stage];
        let currentLine = 0;
        let currentChar = 0;
        let timeout;

        // For Stage 1, only type the first sentence (headline), then fade in body
        const maxLinesToType = stage === 1 ? 1 : lines.length;

        const typeNextChar = () => {
          if (currentLine >= maxLinesToType) {
            setTypingComplete(true);
            setShowCursor(false);
            return;
          }

          const line = lines[currentLine];
          if (currentChar < line.length) {
            setTypedText(line.slice(0, currentChar + 1));
            currentChar++;
            timeout = setTimeout(typeNextChar, speed);
          } else {
            // Line complete - pause then move to next
            if (currentLine < maxLinesToType - 1) {
              timeout = setTimeout(() => {
                currentLine++;
                currentChar = 0;
                setCurrentLineIndex(currentLine);
                setTypedText('');
                typeNextChar();
              }, pauseBetweenLines);
            } else {
              setTypingComplete(true);
              setShowCursor(false);
            }
          }
        };

        // Reset state for new stage
        setTypedText('');
        setCurrentLineIndex(0);
        setTypingComplete(false);
        setShowCursor(true);

        // Start typing after small delay
        timeout = setTimeout(typeNextChar, 300);

        return () => clearTimeout(timeout);
      }, [stage, userClusterName]);

      // Stage 1: After typing, show engines with stagger, then advance
      useEffect(() => {
        if (stage === 1 && typingComplete) {
          // Show engines with stagger
          engines.forEach((_, index) => {
            setTimeout(() => {
              setEnginesVisible(prev => {
                const next = [...prev];
                next[index] = true;
                return next;
              });
            }, 200 + index * 200);
          });

          // Advance to stage 2
          const timer = setTimeout(() => {
            setEnginesVisible([false, false, false, false, false]);
            setTimeout(() => setStage(2), 800);
          }, 7000);

          return () => clearTimeout(timer);
        }
      }, [stage, typingComplete]);

      // Stage 2: After typing, highlight engine, then advance
      useEffect(() => {
        if (stage === 2 && typingComplete) {
          // Show all engines immediately (highlighted/faded)
          setEnginesVisible([true, true, true, true, true]);

          // Advance to stage 3
          const timer = setTimeout(() => {
            setEnginesVisible([false, false, false, false, false]);
            setTimeout(() => setStage(3), 800);
          }, 4000);

          return () => clearTimeout(timer);
        }
      }, [stage, typingComplete]);

      // Stage 3: After typing, show engine icon and skills, then advance
      useEffect(() => {
        if (stage === 3 && typingComplete) {
          // Show engine icon
          setTimeout(() => setEngineIconVisible(true), 300);

          // Show skills with stagger
          [0, 1, 2].forEach((index) => {
            setTimeout(() => {
              setSkillsVisible(prev => {
                const next = [...prev];
                next[index] = true;
                return next;
              });
            }, 500 + index * 300);
          });

          // Advance to stage 4
          const timer = setTimeout(() => {
            setEngineIconVisible(false);
            setSkillsVisible([false, false, false]);
            setTimeout(() => setStage(4), 800);
          }, 5500);

          return () => clearTimeout(timer);
        }
      }, [stage, typingComplete]);

      // Stage 4: After first line types, show personas. After second line, show button.
      useEffect(() => {
        if (stage === 4) {
          if (currentLineIndex === 0 && typedText.length > 30) {
            // First sentence nearly done, show personas
            setTimeout(() => setPersonasVisible([true, false]), 300);
            setTimeout(() => setPersonasVisible([true, true]), 600);
          }
          if (typingComplete) {
            // Show question and button
            setTimeout(() => setQuestionVisible(true), 300);
            setTimeout(() => setButtonVisible(true), 800);
          }
        }
      }, [stage, currentLineIndex, typedText, typingComplete]);

      // Keyboard support for stage 4
      useEffect(() => {
        const handleKeyPress = (e) => {
          if (stage === 4 && buttonVisible && (e.key === 'Enter' || e.key === ' ')) {
            e.preventDefault();
            onContinue();
          }
        };
        window.addEventListener('keydown', handleKeyPress);
        return () => window.removeEventListener('keydown', handleKeyPress);
      }, [stage, buttonVisible, onContinue]);

      // Cursor blink effect
      useEffect(() => {
        if (!showCursor) return;
        const interval = setInterval(() => {
          setShowCursor(prev => !prev);
        }, 530);
        return () => clearInterval(interval);
      }, [showCursor]);

      // Calculate engine radius based on viewport
      // Stage 1 uses smaller circles in two-column layout
      const getRadius = () => {
        if (typeof window !== 'undefined') {
          // Small mobile: circle is min(260px, 32vh)
          if (window.innerWidth < 500) {
            const circleSize = Math.min(260, window.innerHeight * 0.32);
            return circleSize * 0.40;
          }
          // Mobile: circle is min(300px, 38vh)
          if (window.innerWidth < 768) {
            const circleSize = Math.min(300, window.innerHeight * 0.38);
            return circleSize * 0.40;
          }
          // Desktop: circle is min(380px, 50vh)
          const circleSize = Math.min(380, window.innerHeight * 0.50);
          return circleSize * 0.40;
        }
        return 150;
      };

      return (
        <div className="progressive-reveal-screen">
          <AnimatedBackground />

          {/* Skip button - only show during auto-advancing stages */}
          {stage < 4 && (
            <button className="skip-reveal-button" onClick={onContinue}>
              Skip
            </button>
          )}

          <div className="reveal-content">
            {/* Stage 1: Two-Column Layout - Text Left, Visual Right */}
            {stage === 1 && (
              <div className="stage-1-two-column">
                <div className="stage-1-text">
                  <h1 className="typing-headline">
                    {currentLineIndex === 0 ? (
                      <>
                        {typedText}
                        {showCursor && <span className="typing-cursor" />}
                      </>
                    ) : (
                      stageContent[1][0]
                    )}
                  </h1>
                  <p className={`typing-body ${currentLineIndex > 0 || typingComplete ? 'visible' : ''}`}>
                    {stageContent[1][1]}
                  </p>
                </div>

                <div className="stage-1-visual">
                  <div className="engines-circle">
                    {engines.map((engine, index) => {
                      const radius = getRadius();
                      const radian = (engine.angle * Math.PI) / 180;
                      const x = Math.cos(radian) * radius;
                      const y = Math.sin(radian) * radius;
                      const EngineIcon = CLUSTER_ICONS[engine.cluster];

                      return (
                        <div
                          key={engine.name}
                          className={`engine-node ${enginesVisible[index] ? 'visible' : ''}`}
                          style={{
                            left: `calc(50% + ${x}px)`,
                            top: `calc(50% + ${y}px)`
                          }}
                        >
                          <div className="engine-icon-container">
                            {EngineIcon && <EngineIcon size={48} color={engine.color} />}
                          </div>
                          <p className="engine-node-name">{engine.name}</p>
                        </div>
                      );
                    })}
                  </div>
                </div>
              </div>
            )}

            {/* Stage 2: Highlight User's Engine */}
            {stage === 2 && (
              <div
                className="stage-container"
                style={{
                  '--cluster-color': userClusterColor,
                  '--cluster-color-60': userClusterColor + '99',
                  '--cluster-color-30': userClusterColor + '4D'
                }}
              >
                <div className="typing-text-container">
                  <h2 className="stage-heading-large">
                    {typedText}
                    {showCursor && <span className="typing-cursor" />}
                  </h2>
                </div>

                <div className="engines-circle">
                  {engines.map((engine, index) => {
                    const radius = getRadius();
                    const radian = (engine.angle * Math.PI) / 180;
                    const x = Math.cos(radian) * radius;
                    const y = Math.sin(radian) * radius;
                    const EngineIcon = CLUSTER_ICONS[engine.cluster];
                    const isUserEngine = engine.cluster === userCluster;

                    return (
                      <div
                        key={engine.name}
                        className={`engine-node ${enginesVisible[index] ? 'visible' : ''} ${isUserEngine ? 'highlighted' : 'faded'}`}
                        style={{
                          left: `calc(50% + ${x}px)`,
                          top: `calc(50% + ${y}px)`,
                          '--cluster-color': engine.color,
                          '--cluster-color-60': engine.color + '99',
                          '--cluster-color-30': engine.color + '4D'
                        }}
                      >
                        <div className="engine-icon-container">
                          {EngineIcon && <EngineIcon size={isUserEngine ? 60 : 44} color={engine.color} />}
                        </div>
                        <p className="engine-node-name">{engine.name}</p>
                      </div>
                    );
                  })}
                </div>
              </div>
            )}

            {/* Stage 3: Side-by-Side Skills Layout */}
            {stage === 3 && (
              <div
                className="stage-container"
                style={{
                  '--cluster-color': userClusterColor,
                  '--cluster-color-60': userClusterColor + '99',
                  '--cluster-color-30': userClusterColor + '4D'
                }}
              >
                <div className="typing-text-container">
                  <p className="typing-line">
                    {typedText}
                    {showCursor && <span className="typing-cursor" />}
                  </p>
                </div>

                <div className="stage-3-layout">
                  <div className="stage-3-engine">
                    <div className={`engine-icon-large ${engineIconVisible ? 'visible' : ''}`}>
                      {ClusterIcon && <ClusterIcon size={72} color={userClusterColor} />}
                    </div>
                    <h3 className={`engine-name-large ${engineIconVisible ? 'visible' : ''}`} style={{ color: userClusterColor }}>
                      {userClusterName}
                    </h3>
                  </div>

                  <div className="skills-container-elegant">
                    {clusterSkills[userCluster]?.map((skill, index) => {
                      const DomainIcon = DOMAIN_ICONS[skill.level];
                      return (
                        <div
                          key={skill.name}
                          className={`skill-card-elegant ${skillsVisible[index] ? 'visible' : ''}`}
                          style={{ '--cluster-color': userClusterColor }}
                        >
                          <div className="skill-domain-icon">
                            {DomainIcon && <DomainIcon />}
                          </div>
                          <h3 className="skill-name-elegant">{skill.name}</h3>
                          <p className="skill-domain-label">{skill.domain}</p>
                        </div>
                      );
                    })}
                  </div>
                </div>
              </div>
            )}

            {/* Stage 4: Two Personas with Taglines */}
            {stage === 4 && (
              <div className="stage-container" style={{ '--cluster-color': userClusterColor }}>
                <div className="typing-text-container">
                  {stageContent[4].map((line, index) => (
                    <p key={index} className={index === 1 ? 'typing-line' : 'typing-line'} style={index === 1 ? { fontStyle: 'italic' } : {}}>
                      {index < currentLineIndex && line}
                      {index === currentLineIndex && (
                        <>
                          {typedText}
                          {showCursor && <span className="typing-cursor" />}
                        </>
                      )}
                    </p>
                  ))}
                </div>

                <div className="personas-container-elegant">
                  {clusterPersonas[userCluster]?.map((persona, index) => {
                    const PersonaIcon = persona.icon;
                    return (
                      <div
                        key={persona.name}
                        className={`persona-card-elegant ${personasVisible[index] ? 'visible' : ''}`}
                      >
                        <div className="persona-icon-elegant">
                          {PersonaIcon && <PersonaIcon color={userClusterColor} />}
                        </div>
                        <h3 className="persona-name-elegant">{persona.name}</h3>
                        <p className="persona-tagline">"{persona.tagline}"</p>
                      </div>
                    );
                  })}
                </div>

                <div className="reveal-section-elegant">
                  <button
                    className={`reveal-button-elegant ${buttonVisible ? 'visible' : ''}`}
                    onClick={onContinue}
                  >
                    Reveal Your Persona
                  </button>
                </div>
              </div>
            )}
          </div>
        </div>
      );
    };

    // Engine-specific Illustrations
    const DirectionIllustration = () => (
      <svg width="240" height="240" viewBox="0 0 240 240" fill="none" xmlns="http://www.w3.org/2000/svg">
        {/* Compass circle */}
        <circle cx="120" cy="120" r="80" stroke="rgba(118, 140, 18, 0.4)" strokeWidth="2" fill="rgba(118, 140, 18, 0.05)" />
        {/* Inner circle */}
        <circle cx="120" cy="120" r="60" stroke="rgba(118, 140, 18, 0.3)" strokeWidth="1" fill="none" />
        {/* Cardinal points */}
        <g>
          {/* North */}
          <line x1="120" y1="35" x2="120" y2="50" stroke="#768C12" strokeWidth="3" strokeLinecap="round" />
          <text x="120" y="28" textAnchor="middle" fill="#768C12" fontSize="16" fontWeight="700" fontFamily="Fustat, sans-serif">N</text>
          {/* East */}
          <line x1="205" y1="120" x2="190" y2="120" stroke="rgba(118, 140, 18, 0.5)" strokeWidth="2" strokeLinecap="round" />
          {/* South */}
          <line x1="120" y1="205" x2="120" y2="190" stroke="rgba(118, 140, 18, 0.5)" strokeWidth="2" strokeLinecap="round" />
          {/* West */}
          <line x1="35" y1="120" x2="50" y2="120" stroke="rgba(118, 140, 18, 0.5)" strokeWidth="2" strokeLinecap="round" />
        </g>
        {/* Compass needle */}
        <g>
          {/* North point (darker) */}
          <path d="M120 120 L130 60 L120 65 L110 60 Z" fill="#768C12" opacity="0.9" />
          {/* South point (lighter) */}
          <path d="M120 120 L110 180 L120 175 L130 180 Z" fill="#768C12" opacity="0.3" />
        </g>
        {/* Center dot */}
        <circle cx="120" cy="120" r="6" fill="#768C12" />
      </svg>
    );

    const TrustIllustration = () => {
      const nodes = [
        { x: 120, y: 60, size: 16 },
        { x: 60, y: 120, size: 12 },
        { x: 180, y: 120, size: 12 },
        { x: 90, y: 180, size: 10 },
        { x: 150, y: 180, size: 10 }
      ];

      const connections = [
        [0, 1], [0, 2], [1, 3], [2, 4], [1, 4], [2, 3]
      ];

      return (
        <svg width="240" height="240" viewBox="0 0 240 240" fill="none" xmlns="http://www.w3.org/2000/svg">
          {/* Connections */}
          {connections.map(([from, to], index) => (
            <line
              key={index}
              x1={nodes[from].x}
              y1={nodes[from].y}
              x2={nodes[to].x}
              y2={nodes[to].y}
              stroke="rgba(6, 109, 177, 0.4)"
              strokeWidth="2"
            />
          ))}

          {/* Nodes */}
          {nodes.map((node, index) => (
            <circle
              key={index}
              cx={node.x}
              cy={node.y}
              r={node.size}
              fill="rgba(6, 109, 177, 0.2)"
              stroke="#066DB1"
              strokeWidth="2"
            />
          ))}
        </svg>
      );
    };

    const ExecutionIllustration = () => (
      <svg width="240" height="240" viewBox="0 0 240 240" fill="none" xmlns="http://www.w3.org/2000/svg">
        {/* Target circles */}
        <circle cx="120" cy="120" r="100" stroke="rgba(128, 43, 100, 0.4)" strokeWidth="2" fill="none" />
        <circle cx="120" cy="120" r="70" stroke="rgba(128, 43, 100, 0.4)" strokeWidth="2" fill="none" />
        <circle cx="120" cy="120" r="40" stroke="rgba(128, 43, 100, 0.4)" strokeWidth="2" fill="none" />

        {/* Arrow */}
        <g>
          <path
            d="M40 120 L110 120 M110 120 L100 110 M110 120 L100 130"
            stroke="#802B64"
            strokeWidth="4"
            strokeLinecap="round"
            strokeLinejoin="round"
          />
        </g>

        {/* Center target */}
        <circle cx="120" cy="120" r="15" fill="#802B64" opacity="0.8" />
      </svg>
    );

    const DevelopmentIllustration = () => (
      <svg width="240" height="240" viewBox="0 0 240 240" fill="none" xmlns="http://www.w3.org/2000/svg">
        {/* Growth stages - ascending bars */}
        {[60, 100, 140, 180].map((height, index) => (
          <rect
            key={index}
            x={60 + index * 30}
            y={200 - height}
            width="20"
            height={height}
            fill={`rgba(118, 140, 18, ${0.3 + index * 0.15})`}
            stroke="#768C12"
            strokeWidth="2"
            rx="4"
          />
        ))}

        {/* Ascending arrow */}
        <path
          d="M50 180 L80 120 L110 100 L140 60 L170 40"
          stroke="#768C12"
          strokeWidth="3"
          strokeDasharray="5,5"
          strokeLinecap="round"
          fill="none"
        />

        {/* Arrow head */}
        <path
          d="M170 40 L165 48 M170 40 L162 45"
          stroke="#768C12"
          strokeWidth="3"
          strokeLinecap="round"
        />
      </svg>
    );

    const AdaptationIllustration = () => (
      <svg width="240" height="240" viewBox="0 0 240 240" fill="none" xmlns="http://www.w3.org/2000/svg">
        {/* Flowing wave paths */}
        <path
          d="M40 100 Q80 60, 120 100 T200 100"
          stroke="rgba(6, 109, 177, 0.6)"
          strokeWidth="3"
          fill="none"
          strokeLinecap="round"
        />

        <path
          d="M40 120 Q80 80, 120 120 T200 120"
          stroke="rgba(6, 109, 177, 0.4)"
          strokeWidth="3"
          fill="none"
          strokeLinecap="round"
        />

        <path
          d="M40 140 Q80 100, 120 140 T200 140"
          stroke="rgba(6, 109, 177, 0.2)"
          strokeWidth="3"
          fill="none"
          strokeLinecap="round"
        />

        {/* Dots along the path */}
        <circle cx="80" cy="80" r="6" fill="#066DB1" opacity="0.8" />
        <circle cx="120" cy="100" r="6" fill="#066DB1" opacity="0.6" />
        <circle cx="160" cy="80" r="6" fill="#066DB1" opacity="0.4" />
      </svg>
    );

    // Engine data helper function
    const getEngineData = (cluster) => {
      const engines = {
        Direction: {
          color: '#768C12',
          strengths: [
            'Seeing the path forward when others are lost',
            'Setting clear vision and rallying people toward it',
            'Making decisions with conviction, even in uncertainty'
          ],
          defaultText: 'You default to clarity, purpose, and forward momentum.'
        },
        Trust: {
          color: '#066DB1',
          strengths: [
            'Building psychological safety and authentic connection',
            'Reading the room and sensing what people need',
            'Creating environments where others feel valued'
          ],
          defaultText: 'You default to relationships, care, and human connection.'
        },
        Execution: {
          color: '#802B64',
          strengths: [
            'Driving results and maintaining relentless focus',
            'Converting strategy into action without delay',
            'Holding high standards and delivering consistently'
          ],
          defaultText: 'You default to action, momentum, and getting things done.'
        },
        Development: {
          color: '#768C12',
          strengths: [
            'Growing people and unlocking their potential',
            'Creating learning opportunities from every challenge',
            'Investing in long-term capability over quick wins'
          ],
          defaultText: 'You default to growth, coaching, and building capability.'
        },
        Adaptation: {
          color: '#066DB1',
          strengths: [
            'Navigating change and thriving in uncertainty',
            'Questioning assumptions and exploring new approaches',
            'Balancing stability with innovation'
          ],
          defaultText: 'You default to flexibility, curiosity, and resilience.'
        }
      };

      return engines[cluster] || engines.Direction;
    };

    // Engine Education Screen Component
    const EngineEducationScreen = ({ cluster, onContinue }) => {
      const [typedText, setTypedText] = React.useState('');
      const [showContent, setShowContent] = React.useState(false);
      const [strengthsVisible, setStrengthsVisible] = React.useState([false, false, false]);
      const [defaultVisible, setDefaultVisible] = React.useState(false);
      const [footerVisible, setFooterVisible] = React.useState(false);

      const engineData = getEngineData(cluster);
      const headline = `Your engine is ${cluster.toUpperCase()}.`;
      const typingSpeed = 35;

      const typingRef = React.useRef(null);
      const animationRef = React.useRef(null);
      const stateRef = React.useRef({ char: 0, isTyping: true });

      // Typing animation using RAF
      React.useEffect(() => {
        stateRef.current = { char: 0, isTyping: true };
        setTypedText('');
        setShowContent(false);
        setStrengthsVisible([false, false, false]);
        setDefaultVisible(false);
        setFooterVisible(false);

        let lastTime = 0;

        const typeNextChar = (timestamp) => {
          if (!stateRef.current.isTyping) return;

          if (!lastTime) lastTime = timestamp;
          const elapsed = timestamp - lastTime;

          if (elapsed >= typingSpeed) {
            lastTime = timestamp;
            stateRef.current.char++;

            if (stateRef.current.char <= headline.length) {
              setTypedText(headline.slice(0, stateRef.current.char));
              animationRef.current = requestAnimationFrame(typeNextChar);
            } else {
              // Typing complete, show content
              setTimeout(() => {
                setShowContent(true);
                // Stagger the strengths
                setTimeout(() => setStrengthsVisible([true, false, false]), 300);
                setTimeout(() => setStrengthsVisible([true, true, false]), 450);
                setTimeout(() => setStrengthsVisible([true, true, true]), 600);
                setTimeout(() => setDefaultVisible(true), 800);
                setTimeout(() => setFooterVisible(true), 1000);
              }, 400);
            }
          } else {
            animationRef.current = requestAnimationFrame(typeNextChar);
          }
        };

        animationRef.current = requestAnimationFrame(typeNextChar);

        return () => {
          stateRef.current.isTyping = false;
          if (animationRef.current) cancelAnimationFrame(animationRef.current);
        };
      }, [cluster]);

      // Keyboard support
      React.useEffect(() => {
        const handleKeyPress = (e) => {
          if (footerVisible && (e.key === 'Enter' || e.key === ' ')) {
            e.preventDefault();
            onContinue();
          }
        };
        window.addEventListener('keydown', handleKeyPress);
        return () => window.removeEventListener('keydown', handleKeyPress);
      }, [footerVisible, onContinue]);

      // Get correct illustration
      const EngineIllustration = () => {
        switch(cluster) {
          case 'Direction': return <DirectionIllustration />;
          case 'Trust': return <TrustIllustration />;
          case 'Execution': return <ExecutionIllustration />;
          case 'Development': return <DevelopmentIllustration />;
          case 'Adaptation': return <AdaptationIllustration />;
          default: return <DirectionIllustration />;
        }
      };

      return (
        <div className="post-assessment-screen">
          <AnimatedBackground />

          <div className="engine-screen-content">
            {/* Typed headline */}
            <div className="engine-headline">
              <h1>
                Your engine is{' '}
                <span className="engine-name" style={{ color: engineData.color }}>
                  {typedText.includes('is ') ? typedText.split('is ')[1] : ''}
                </span>
                {typedText.length < headline.length && <span className="cursor">_</span>}
              </h1>
            </div>

            {/* Content that fades in after typing */}
            <div className={`engine-content ${showContent ? 'visible' : ''}`}>
              <div className="content-layout">
                <div className="engine-description">
                  <p className="intro-text">Leaders with a {cluster.toUpperCase()} engine excel at:</p>

                  <ul className="engine-strengths">
                    {engineData.strengths.map((strength, index) => (
                      <li key={index} className={strengthsVisible[index] ? 'visible' : ''}>
                        {strength}
                      </li>
                    ))}
                  </ul>

                  <p className={`engine-default ${defaultVisible ? 'visible' : ''}`}>
                    {engineData.defaultText}
                  </p>
                </div>

                <div className="engine-visual">
                  <EngineIllustration />
                </div>
              </div>
            </div>

            {/* Button */}
            <div className={`engine-footer ${footerVisible ? 'visible' : ''}`}>
              <button className="reveal-button" onClick={onContinue}>
                Discover Your Persona
              </button>
            </div>
          </div>
        </div>
      );
    };

    // Preview Section Component
    // SVG Illustrations
    const CycleIllustration = ({ isHovered, isVisible }) => (
      <svg
        width="120"
        height="120"
        viewBox="0 0 120 120"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
        className="illustration"
      >
        {/* Background Circle */}
        <circle
          cx="60"
          cy="60"
          r="45"
          stroke="url(#warmGradient)"
          strokeWidth="2"
          fill="none"
          className={`draw-line ${isHovered ? 'rotate-on-hover' : ''}`}
          style={{ transformOrigin: 'center' }}
        />

        {/* Arrows in Circle */}
        <g className="fade-in">
          <path d="M60 20 L65 28 M60 20 L55 28" stroke="url(#warmGradient)" strokeWidth="2.5" strokeLinecap="round" />
          <path d="M100 60 L92 65 M100 60 L92 55" stroke="url(#warmGradient)" strokeWidth="2.5" strokeLinecap="round" />
          <path d="M60 100 L55 92 M60 100 L65 92" stroke="url(#warmGradient)" strokeWidth="2.5" strokeLinecap="round" />
          <path d="M20 60 L28 55 M20 60 L28 65" stroke="url(#warmGradient)" strokeWidth="2.5" strokeLinecap="round" />
        </g>

        {/* Break Mark (X) - visible on hover */}
        <g className="scale-in" style={{ opacity: isHovered ? 1 : 0, transition: 'opacity 0.3s ease' }}>
          <path d="M50 50 L70 70 M70 50 L50 70" stroke="#B44D8C" strokeWidth="3" strokeLinecap="round" />
        </g>

        <defs>
          <linearGradient id="warmGradient" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" stopColor="#802B64" />
            <stop offset="100%" stopColor="#9B3D7A" />
          </linearGradient>
        </defs>
      </svg>
    );

    const NetworkIllustration = ({ isHovered, isVisible }) => (
      <svg
        width="120"
        height="120"
        viewBox="0 0 120 120"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
        className="illustration"
      >
        {/* Connection Lines */}
        <g className="fade-in" style={{ opacity: 0.4 }}>
          <line x1="30" y1="40" x2="60" y2="60" stroke="url(#coolGradient)" strokeWidth="2" />
          <line x1="90" y1="40" x2="60" y2="60" stroke="url(#coolGradient)" strokeWidth="2" />
          <line x1="30" y1="80" x2="60" y2="60" stroke="url(#coolGradient)" strokeWidth="2" />
          <line x1="90" y1="80" x2="60" y2="60" stroke="url(#coolGradient)" strokeWidth="2" />
        </g>

        {/* Outer Nodes */}
        <g className="scale-in">
          <circle cx="30" cy="40" r="8" fill="rgba(6, 109, 177, 0.2)" stroke="url(#coolGradient)" strokeWidth="2" />
          <circle cx="90" cy="40" r="8" fill="rgba(6, 109, 177, 0.2)" stroke="url(#coolGradient)" strokeWidth="2" />
          <circle cx="30" cy="80" r="8" fill="rgba(6, 109, 177, 0.2)" stroke="url(#coolGradient)" strokeWidth="2" />
          <circle cx="90" cy="80" r="8" fill="rgba(6, 109, 177, 0.2)" stroke="url(#coolGradient)" strokeWidth="2" />
        </g>

        {/* Center Node (You) */}
        <g className="scale-in">
          <circle cx="60" cy="60" r="12" fill="rgba(6, 109, 177, 0.3)" stroke="url(#coolGradient)" strokeWidth="3" />
          {/* Pulse Ring */}
          <circle
            cx="60"
            cy="60"
            r="12"
            fill="none"
            stroke="url(#coolGradient)"
            strokeWidth="2"
            className={isHovered ? 'pulse-ring' : ''}
            style={{ transformOrigin: '60px 60px' }}
          />
        </g>

        <defs>
          <linearGradient id="coolGradient" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" stopColor="#066DB1" />
            <stop offset="100%" stopColor="#00B4D8" />
          </linearGradient>
        </defs>
      </svg>
    );

    const BalanceIllustration = ({ isHovered, isVisible }) => (
      <svg
        width="120"
        height="120"
        viewBox="0 0 120 120"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
        className="illustration"
      >
        {/* Base */}
        <rect x="45" y="95" width="30" height="5" fill="url(#successGradient)" rx="2" className="scale-in" />

        {/* Center Pole */}
        <rect x="58" y="50" width="4" height="45" fill="url(#successGradient)" rx="2" className="scale-in" />

        {/* Balance Beam */}
        <g className="fade-in">
          <line
            x1="20" y1="50" x2="100" y2="50"
            stroke="url(#successGradient)"
            strokeWidth="3"
            strokeLinecap="round"
            className={isHovered ? 'bob-on-hover' : ''}
            style={{ transformOrigin: '60px 50px' }}
          />
          <path d="M60 48 L54 54 L66 54 Z" fill="url(#successGradient)" />
        </g>

        {/* Left Pan */}
        <g className="scale-in" style={{ transitionDelay: '1s' }}>
          <path d="M20 50 L15 40 L25 40 Z" stroke="url(#successGradient)" strokeWidth="2" fill="none" />
          <ellipse cx="20" cy="40" rx="10" ry="3" fill="rgba(118, 140, 18, 0.2)" stroke="url(#successGradient)" strokeWidth="2" />
        </g>

        {/* Right Pan */}
        <g className="scale-in" style={{ transitionDelay: '1.1s' }}>
          <path d="M100 50 L95 40 L105 40 Z" stroke="url(#successGradient)" strokeWidth="2" fill="none" />
          <ellipse cx="100" cy="40" rx="10" ry="3" fill="rgba(118, 140, 18, 0.2)" stroke="url(#successGradient)" strokeWidth="2" />
        </g>

        {/* Balance Indicator (checkmark on hover) */}
        <g style={{ opacity: isHovered ? 1 : 0, transform: isHovered ? 'scale(1)' : 'scale(0)', transition: 'all 0.4s ease', transformOrigin: '60px 25px' }}>
          <circle cx="60" cy="25" r="8" fill="rgba(118, 140, 18, 0.3)" />
          <path d="M56 25 L59 28 L65 22" stroke="#768C12" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" fill="none" />
        </g>

        <defs>
          <linearGradient id="successGradient" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" stopColor="#768C12" />
            <stop offset="100%" stopColor="#8AA614" />
          </linearGradient>
        </defs>
      </svg>
    );

    // Benefit Card Component
    const BenefitCard = ({ number, title, description, illustration, colorScheme, isVisible }) => {
      const [isHovered, setIsHovered] = React.useState(false);

      return (
        <div
          className={`benefit-card ${colorScheme} ${isVisible ? 'visible' : ''}`}
          onMouseEnter={() => setIsHovered(true)}
          onMouseLeave={() => setIsHovered(false)}
        >
          <div className="card-number">{number}</div>
          <div className="card-border-glow" />
          <div className="card-content">
            <div className="illustration-container">
              {illustration === 'cycle' && <CycleIllustration isHovered={isHovered} isVisible={isVisible} />}
              {illustration === 'network' && <NetworkIllustration isHovered={isHovered} isVisible={isVisible} />}
              {illustration === 'balance' && <BalanceIllustration isHovered={isHovered} isVisible={isVisible} />}
            </div>
            <h4 className="card-title">{title}</h4>
            <p className="card-description">{description}</p>
          </div>
        </div>
      );
    };

    // Enhanced Preview Section
    const PreviewSection = () => {
      const [isVisible, setIsVisible] = React.useState(false);
      const [titleVisible, setTitleVisible] = React.useState(false);

      React.useEffect(() => {
        const handleScroll = () => {
          const section = document.querySelector('.preview-section');
          if (section) {
            const rect = section.getBoundingClientRect();
            if (rect.top < window.innerHeight * 0.8) {
              setTitleVisible(true);
              setTimeout(() => setIsVisible(true), 200);
            }
          }
        };

        window.addEventListener('scroll', handleScroll);
        handleScroll();
        return () => window.removeEventListener('scroll', handleScroll);
      }, []);

      return (
        <div className="preview-section">
          <div className="preview-content">
            <h3 className={`preview-title ${titleVisible ? 'visible' : ''}`}>
              Most leaders operate on autopilot. But not you.
            </h3>
            <button
              className={`preview-cta ${titleVisible ? 'visible' : ''}`}
              onClick={() => window.scrollTo({ top: 0, behavior: 'smooth' })}
            >
              Take the Assessment <span className="cta-arrow">↑</span>
            </button>
            <div className="preview-grid">
              <BenefitCard
                number="01"
                title="Stop Repeating the Same Mistakes"
                description="Understand why you default to certain behaviors and break the cycle."
                illustration="cycle"
                colorScheme="warm"
                isVisible={isVisible}
              />
              <BenefitCard
                number="02"
                title="Navigate Conflict Better"
                description="Know who you work well with, who you clash with, and how to bridge gaps."
                illustration="network"
                colorScheme="cool"
                isVisible={isVisible}
              />
              <BenefitCard
                number="03"
                title="Stay Balanced Under Pressure"
                description="Recognize your early warning signs before your strengths become liabilities."
                illustration="balance"
                colorScheme="success"
                isVisible={isVisible}
              />
            </div>
          </div>
        </div>
      );
    };

    // Landing Page Component - Elegant Typing Animation Version
    const LandingPage = ({ onStart, userData, setUserData }) => {
      const [typedText, setTypedText] = React.useState('');
      const [currentLine, setCurrentLine] = React.useState(0);
      const [showCursor, setShowCursor] = React.useState(true);
      const [showCTA, setShowCTA] = React.useState(false);
      const [showForm, setShowForm] = React.useState(false);
      const [showScrollHint, setShowScrollHint] = React.useState(false);
      const [focusedField, setFocusedField] = React.useState(null);
      const [errors, setErrors] = React.useState({});
      const [scrollY, setScrollY] = React.useState(0);

      // Scroll tracking for parallax effect
      React.useEffect(() => {
        const handleScroll = () => {
          setScrollY(window.scrollY);
        };
        window.addEventListener('scroll', handleScroll, { passive: true });
        return () => window.removeEventListener('scroll', handleScroll);
      }, []);

      // Typing animation content - FINAL COPY
      const lines = [
        "Under pressure, every leader has a pattern.",
        "Stress morphs your strengths into traps.",
        "Some become steamrollers. Others become perfectionists.",
        "Who do YOU become when you're up against the wall?"
      ];

      // Mobile detection
      const isMobile = window.innerWidth < 768;

      // Mobile uses shorter version
      const mobileLines = [
        "Under pressure, every leader has a pattern.",
        "Stress morphs your strengths into traps.",
        "Who do YOU become when you're up against the wall?"
      ];

      const displayLines = isMobile ? mobileLines : lines;

      // Typing configuration
      const typingSpeed = isMobile ? 35 : 42; // ms per character
      const pauseBetweenLines = 450;

      // Refs for smooth DOM-based typing (avoids React re-render stutter)
      const typingRef = React.useRef(null);
      const animationRef = React.useRef(null);
      const stateRef = React.useRef({ line: 0, char: 0, isTyping: true });

      // Single continuous typing animation - no React state updates during typing
      React.useEffect(() => {
        let lastTime = 0;
        let isPausing = false;
        let pauseStart = 0;

        const typeNextChar = (timestamp) => {
          if (!stateRef.current.isTyping) return;

          const state = stateRef.current;
          const currentText = displayLines[state.line] || '';

          // Handle pause between lines
          if (isPausing) {
            if (timestamp - pauseStart >= pauseBetweenLines) {
              isPausing = false;
              state.line++;
              state.char = 0;

              if (state.line >= displayLines.length) {
                // All done
                setCurrentLine(displayLines.length);
                setShowCursor(false);
                setShowCTA(true);
                return;
              }
              setCurrentLine(state.line);
            }
            animationRef.current = requestAnimationFrame(typeNextChar);
            return;
          }

          // Initialize timestamp
          if (!lastTime) lastTime = timestamp;
          const elapsed = timestamp - lastTime;

          // Type next character when enough time has passed
          if (elapsed >= typingSpeed) {
            lastTime = timestamp;
            state.char++;

            // Update DOM directly for smooth rendering
            if (typingRef.current) {
              const displayText = currentText.slice(0, state.char);
              typingRef.current.innerHTML = formatLine(displayText);
            }

            // Check if line is complete
            if (state.char >= currentText.length) {
              isPausing = true;
              pauseStart = timestamp;
            }
          }

          animationRef.current = requestAnimationFrame(typeNextChar);
        };

        // Start animation
        animationRef.current = requestAnimationFrame(typeNextChar);

        return () => {
          stateRef.current.isTyping = false;
          if (animationRef.current) {
            cancelAnimationFrame(animationRef.current);
          }
        };
      }, []);

      // Cursor blink effect
      React.useEffect(() => {
        const interval = setInterval(() => {
          setShowCursor(prev => !prev);
        }, 530);
        return () => clearInterval(interval);
      }, []);

      // Delayed scroll hint - shows after 3 seconds on form screen
      React.useEffect(() => {
        if (showForm) {
          const timer = setTimeout(() => {
            setShowScrollHint(true);
          }, 3000);
          return () => clearTimeout(timer);
        } else {
          setShowScrollHint(false);
        }
      }, [showForm]);

      // Format line to add emphasis to key words
      const formatLine = (text) => {
        if (!text) return '';
        let formatted = text.replace(/\btraps\b/g, '<span class="emphasis-word">traps</span>');
        formatted = formatted.replace(/\bYOU\b/g, '<strong class="emphasis-you">YOU</strong>');
        return formatted;
      };

      const handleSkip = () => {
        stateRef.current.isTyping = false;
        setCurrentLine(displayLines.length);
        setShowCursor(false);
        setShowCTA(true);
      };

      const handleSubmit = (e) => {
        e.preventDefault();
        const newErrors = {};

        if (!userData.name?.trim()) {
          newErrors.name = 'Please enter your name';
        }
        if (!userData.email?.trim()) {
          newErrors.email = 'Please enter your email';
        } else if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(userData.email)) {
          newErrors.email = 'Please enter a valid email';
        }

        if (Object.keys(newErrors).length > 0) {
          setErrors(newErrors);
          return;
        }

        onStart();
      };

      return (
        <div className="landing-page">
          <AnimatedBackground />

          {/* Skip Button */}
          {!showCTA && !showForm && (
            <button className="skip-button" onClick={handleSkip}>
              Skip
            </button>
          )}

          <div className="landing-content">
            {/* Typing Animation Section - Hidden when form shows */}
            {!showForm && (
              <div className="typing-section">
                {displayLines.map((line, index) => (
                  <div key={index} className="typed-line">
                    <p>
                      {index < currentLine && (
                        <span dangerouslySetInnerHTML={{ __html: formatLine(line) }} />
                      )}
                      {index === currentLine && (
                        <>
                          <span ref={typingRef} />
                          {showCursor && <span className="cursor">_</span>}
                        </>
                      )}
                      {index > currentLine && (
                        <span>&nbsp;</span>
                      )}
                    </p>
                  </div>
                ))}

                {/* CTA Button - Always rendered, fades in after typing */}
                <div className="cta-button-wrapper">
                  <button
                    className={`cta-button ${showCTA ? 'visible' : ''}`}
                    onClick={() => setShowForm(true)}
                  >
                    Take the Assessment
                  </button>
                </div>
              </div>
            )}

            {/* Form Section - Appears on CTA click */}
            {showForm && (
              <div className="form-section-layout">
                {/* Left Column - Headline with Persona Cards */}
                <div className="form-headline-column">
                  <PersonaCardsBackground scrollY={scrollY} />
                  <h1 className="form-headline">Uncover your leadership pressure pattern.</h1>
                </div>

                {/* Right Column - Form */}
                <div className="form-column">
                  <div className="form-container">
                    <div className="form-border">
                      <form className="landing-form" onSubmit={handleSubmit}>
                    {/* Name Field */}
                    <div className="form-field">
                      <input
                        type="text"
                        id="name"
                        value={userData.name || ''}
                        onChange={(e) => setUserData({ ...userData, name: e.target.value })}
                        onFocus={() => setFocusedField('name')}
                        onBlur={() => setFocusedField(null)}
                        required
                        className={`form-input ${errors.name ? 'border-red-500' : ''}`}
                      />
                      <label
                        htmlFor="name"
                        className={`form-label ${userData.name || focusedField === 'name' ? 'active' : ''}`}
                      >
                        Your Name
                      </label>
                      {errors.name && <p className="text-red-400 text-sm mt-1">{errors.name}</p>}
                    </div>

                    {/* Email Field */}
                    <div className="form-field">
                      <input
                        type="email"
                        id="email"
                        value={userData.email || ''}
                        onChange={(e) => setUserData({ ...userData, email: e.target.value })}
                        onFocus={() => setFocusedField('email')}
                        onBlur={() => setFocusedField(null)}
                        required
                        className={`form-input ${errors.email ? 'border-red-500' : ''}`}
                      />
                      <label
                        htmlFor="email"
                        className={`form-label ${userData.email || focusedField === 'email' ? 'active' : ''}`}
                      >
                        Your Email
                      </label>
                      {errors.email && <p className="text-red-400 text-sm mt-1">{errors.email}</p>}
                    </div>

                    {/* Submit Button */}
                    <button type="submit" className="submit-button">
                      Get Started
                    </button>

                    {/* Trust Signals */}
                    <div className="trust-signals">
                      <span>5 min</span>
                      <span className="separator">•</span>
                      <span>15 questions</span>
                      <span className="separator">•</span>
                      <span>Immediate results</span>
                    </div>

                    {/* Logo */}
                    <div className="logo-container">
                      <svg className="leaderfactor-logo" viewBox="0 0 960 161" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M82.4492 51.6162C91.2694 51.6162 98.859 53.6672 105.423 57.7695C111.987 61.872 117.115 67.7181 120.808 75.2051C124.5 82.6921 126.346 91.4099 126.346 101.461V103.718L123.577 106.281H53.1396C53.6203 110.735 54.8577 114.819 56.8086 118.486C59.3727 123.307 62.9629 127.204 67.4756 129.974C71.9882 132.845 77.2187 134.179 82.9619 134.179C88.7054 134.179 93.5264 132.845 97.7314 130.076C101.936 127.307 105.218 123.512 107.475 118.691H109.73L122.653 124.435C119.166 132.024 114.039 138.076 107.064 142.486C100.09 146.896 92.0899 149.05 82.9619 149.05L83.0645 148.947C74.0392 148.947 66.142 146.896 59.2705 142.794C52.3989 138.691 46.9628 132.948 43.0654 125.666C39.1681 118.384 37.2197 109.871 37.2197 100.23C37.2197 90.5896 39.1681 82.1794 42.9629 74.7949C46.7577 67.513 52.0912 61.7695 58.9629 57.667C65.8345 53.5646 73.629 51.6162 82.4492 51.6162ZM381.314 51.6162C390.135 51.6162 397.724 53.6672 404.288 57.7695C410.852 61.872 415.981 67.7181 419.673 75.2051C423.365 82.6921 425.211 91.4099 425.211 101.461V103.718L422.442 106.281H352.005C352.486 110.735 353.723 114.819 355.674 118.486C358.238 123.307 361.828 127.204 366.341 129.974C370.853 132.845 376.084 134.179 381.827 134.179C387.571 134.179 392.392 132.845 396.597 130.076C400.802 127.307 404.083 123.512 406.34 118.691H408.596L421.519 124.435C418.031 132.024 412.904 138.076 405.93 142.486C398.955 146.896 390.955 149.05 381.827 149.05L381.93 148.947C372.904 148.947 365.007 146.896 358.136 142.794C351.264 138.691 345.828 132.948 341.931 125.666C338.033 118.384 336.085 109.871 336.085 100.23C336.085 90.5896 338.033 82.1794 341.828 74.7949C345.623 67.513 350.956 61.7695 357.828 57.667C364.7 53.5646 372.494 51.6162 381.314 51.6162ZM320.701 13.2539V146.585H305.624V133.21C305.292 133.64 304.95 134.064 304.599 134.482C300.804 138.995 296.291 142.584 290.958 145.148C285.625 147.712 279.676 149.046 273.317 149.046V148.943C265.112 148.943 257.625 146.892 250.959 142.688C244.292 138.482 239.061 132.739 235.164 125.457C231.267 118.175 229.318 109.765 229.318 100.227C229.318 90.6883 231.267 82.5856 235.164 75.2012C239.061 67.9193 244.292 62.1757 250.959 57.9707C257.625 53.7658 265.01 51.7148 273.317 51.7148C279.676 51.7148 285.625 53.0483 290.958 55.6123C296.291 58.1763 300.906 61.7657 304.599 66.2783C304.703 66.4054 304.804 66.535 304.906 66.6631V17.459L320.188 11.8184L320.701 13.2539ZM176.498 51.4102C189.01 51.4103 198.753 55.2055 205.522 62.6924C212.292 70.1794 215.779 80.7432 215.779 94.4863V146.588H201.01V133.445C200.307 134.363 199.556 135.258 198.754 136.127C194.959 140.127 190.549 143.306 185.421 145.562C180.293 147.819 174.754 148.947 168.703 148.947C162.344 148.947 156.601 147.716 151.575 145.255C146.55 142.793 142.652 139.409 139.883 134.999C137.011 130.589 135.678 125.563 135.678 119.922C135.678 111.82 138.652 105.256 144.498 100.128C150.344 95.1024 158.447 92.1281 168.806 91.3076L200.264 89.04C200.002 82.6565 197.852 77.2705 193.729 73.0508C189.318 68.538 183.574 66.1797 176.292 66.1797C170.651 66.1798 165.728 67.6157 161.729 70.3848C157.626 73.1539 154.857 77.0509 153.421 81.8711H151.37L137.729 77.4609C140.396 69.2562 145.216 62.7949 151.985 58.2822C158.754 53.7695 166.96 51.4102 176.498 51.4102ZM597.412 53.1533C609.207 53.1533 618.336 56.7426 624.694 63.9219C631.053 71.1012 634.335 81.3583 634.335 94.6914V146.793H624.387V130.603C623.202 132.508 621.8 134.315 620.182 136.023C616.592 139.921 612.182 142.998 607.156 145.254C602.131 147.51 596.592 148.639 590.746 148.639L590.644 148.434C584.387 148.434 578.849 147.203 574.028 144.844C569.208 142.485 565.413 139.101 562.644 134.998C559.875 130.793 558.439 126.075 558.438 120.742C558.438 113.358 561.003 107.203 566.336 102.178C571.567 97.1523 579.156 94.2805 589.104 93.5625L624.065 90.9697C623.883 82.6382 621.53 75.9129 617.002 70.7939C612.284 65.4607 605.617 62.8965 597.207 62.8965C590.951 62.8965 585.516 64.4351 581.003 67.5117C576.49 70.5885 573.105 74.9988 571.054 80.8447H569.003L560.695 77.666C563.67 69.6662 568.285 63.6142 574.746 59.4092C581.105 55.2042 588.695 53.1534 597.412 53.1533ZM694.644 53.0479C701.823 53.0479 707.976 54.3813 713.412 56.9453C718.745 59.5094 723.258 62.997 726.95 67.5098C730.642 71.9199 733.514 76.9451 735.463 82.6885L727.155 85.2529H725.104C722.643 78.6889 718.848 73.3554 713.822 69.1504C708.797 64.9454 702.336 62.8946 694.644 62.8945C687.669 62.8945 681.515 64.5354 676.489 67.9199C671.361 71.2019 667.362 75.7147 664.593 81.3555C661.721 86.9963 660.388 93.56 660.388 100.944C660.388 108.329 661.824 114.586 664.593 120.329C667.464 126.072 671.361 130.688 676.489 133.867C681.617 137.149 687.669 138.79 694.644 138.79C700.079 138.79 704.797 137.867 708.797 135.918C712.797 133.969 716.284 131.406 719.155 128.124C722.027 124.842 724.284 120.944 725.925 116.637H727.976L736.283 118.996C734.232 124.739 731.258 129.97 727.463 134.38C723.668 138.893 719.053 142.379 713.72 144.841C708.387 147.302 702.028 148.533 694.849 148.533L694.644 148.431C685.926 148.431 678.233 146.38 671.464 142.482C664.797 138.483 659.567 132.841 655.772 125.662C651.978 118.483 650.131 110.175 650.131 100.842C650.131 91.5089 651.978 82.9966 655.772 75.8174C659.567 68.6381 664.797 62.997 671.464 58.9971C678.13 54.9971 685.926 53.0479 694.644 53.0479ZM844.485 53.0479C853.203 53.0479 860.895 55.0998 867.562 58.9971C874.228 62.997 879.459 68.5355 883.254 75.7148C887.049 82.894 888.997 91.2013 888.997 100.637C888.997 110.072 887.049 118.483 883.254 125.662C879.459 132.841 874.228 138.482 867.562 142.482C860.895 146.482 853.203 148.431 844.485 148.431C835.768 148.431 827.972 146.38 821.306 142.482C814.639 138.483 809.306 132.944 805.512 125.765C801.717 118.585 799.768 110.278 799.768 100.842C799.768 91.4063 801.717 82.9966 805.512 75.8174C809.306 68.6382 814.537 62.997 821.306 58.9971C827.972 54.9971 835.768 53.0479 844.485 53.0479ZM915.767 57.4619V70.3848C918.023 66.6926 920.895 63.5132 924.484 61.0518C930.433 57.0519 936.997 55.001 944.279 55.001H951.971L952.997 55.4111V64.8467H942.945C937.817 64.8467 933.202 66.0776 929.1 68.5391C924.997 71.0005 921.818 74.3849 919.459 78.7949C917.1 83.2051 915.972 88.3336 915.972 94.3848V146.589H905.818V53.4619L906.331 52.0264L915.767 57.4619ZM766.846 28.7441V55H794.127V55.001H801.82V64.7441H792.59L792.593 64.7432H766.948V118.999C766.948 125.46 768.282 130.076 770.846 132.742C773.41 135.409 777.615 136.742 783.358 136.742H793.512L794.229 138.794V146.588H781.819C774.23 146.588 768.076 144.332 763.563 139.819C758.948 135.307 756.692 128.64 756.692 119.614V64.7432H741V55H756.692V24.6416L757.205 23.2061L766.846 28.7441ZM21.9375 13.2539V146.585H6.24512V17.459L21.4248 11.8184L21.9375 13.2539ZM454.647 53.4619V68.2314C456.699 65.1546 459.365 62.5904 462.545 60.334C468.596 56.1291 475.365 54.0782 482.852 54.0781H490.646L492.083 54.5908L492.186 54.4883L486.852 68.7441H480.493C475.365 68.7441 470.955 69.9751 467.263 72.334C463.57 74.6929 460.596 77.9747 458.442 82.2822C456.289 86.5898 455.16 91.5134 455.16 97.1543V146.486H439.468V57.4619L454.135 52.0264L454.647 53.4619ZM551.568 22.7959V23.001L550.543 23.4121H545.312C539.467 23.4121 535.261 24.7448 532.697 27.4111C530.133 30.0778 528.902 34.5913 528.902 41.1553V55.001H547.876L551.329 64.1406L549.928 64.6416H528.902V146.384H518.748V64.6416H501.928L500.492 64.1289L503.877 54.8984H518.748V40.5391C518.748 31.6164 521.107 24.8476 525.62 20.335C530.133 15.8223 536.286 13.5655 543.876 13.5654H548.286L551.568 22.7959ZM591.771 102.999C583.874 103.614 578.131 105.46 574.541 108.64C570.951 111.819 569.105 115.717 569.105 120.537C569.106 125.973 571.156 130.281 575.361 133.665C579.566 136.947 584.797 138.69 591.259 138.69C597.207 138.69 602.643 137.255 607.566 134.383C612.592 131.511 616.592 127.613 619.566 122.793C622.541 117.973 624.079 112.639 624.079 106.793V100.608L591.771 102.999ZM844.485 62.5859C837.819 62.5859 831.87 64.1253 826.64 67.3047C821.409 70.4841 817.306 74.7917 814.332 80.5352C811.358 86.176 809.922 92.9447 809.922 100.637C809.922 108.329 811.358 114.791 814.332 120.534C817.306 126.278 821.409 130.688 826.64 133.867C831.87 137.046 837.819 138.585 844.485 138.585C851.152 138.585 856.998 137.047 862.229 133.867C867.459 130.688 871.459 126.278 874.434 120.534C877.408 114.791 878.844 108.226 878.844 100.637C878.844 93.0474 877.408 86.1759 874.434 80.5352C871.459 74.8944 867.459 70.4841 862.229 67.3047C857.1 64.1253 851.152 62.586 844.485 62.5859ZM171.882 105.358C165.113 105.871 160.088 107.307 156.806 109.666C153.524 112.025 151.883 115.409 151.883 119.717C151.883 123.819 153.626 127.204 157.011 129.871C160.498 132.538 164.908 133.973 170.344 133.973C175.78 133.973 180.908 132.64 185.523 130.076C190.036 127.512 193.625 124.024 196.292 119.717C198.959 115.409 200.292 110.589 200.292 105.358V103.117L171.882 105.358ZM274.445 66.6885C268.907 66.6885 263.882 68.1245 259.369 70.8936C254.856 73.7653 251.369 77.6629 248.805 82.6885C246.241 87.714 245.01 93.5601 245.01 100.227C245.01 106.893 246.241 112.739 248.805 117.765C251.369 122.79 254.856 126.79 259.369 129.662C263.882 132.534 268.907 133.97 274.445 133.97C280.496 133.97 285.727 132.534 290.343 129.662C294.855 126.79 298.445 122.79 301.111 117.765C303.778 112.739 305.111 106.893 305.111 100.227C305.111 93.56 303.778 87.714 301.111 82.6885C298.445 77.663 294.855 73.6627 290.343 70.8936C285.83 68.0218 280.496 66.6885 274.445 66.6885ZM82.4492 66.4873C77.0136 66.4873 72.0908 67.8208 67.4756 70.4873C62.9629 73.1539 59.3727 76.8466 56.8086 81.667C55.1806 84.7277 54.0498 88.0781 53.4404 91.7178H110.146C109.512 87.047 108.164 82.9978 106.039 79.5127C103.475 75.3076 100.09 72.1284 96.0898 69.8721C91.9874 67.6158 87.4747 66.4873 82.4492 66.4873ZM381.314 66.4873C375.879 66.4873 370.956 67.8208 366.341 70.4873C361.828 73.1539 358.238 76.8466 355.674 81.667C354.046 84.7278 352.915 88.0781 352.306 91.7178H409.011C408.377 87.0471 407.029 82.9978 404.904 79.5127C402.34 75.3076 398.955 72.1284 394.955 69.8721C390.853 67.6157 386.34 66.4873 381.314 66.4873ZM551.363 64.2314L551.329 64.1406L551.363 64.1289V64.2314Z" fill="white"/>
                      </svg>
                    </div>
                      </form>
                    </div>
                  </div>
                </div>
              </div>
            )}

            {/* Scroll Indicator */}
            {showForm && (
              <div className="scroll-indicator">
                <div className="scroll-section">
                  {showScrollHint && (
                    <p className="scroll-text fade-in">Not quite convinced?</p>
                  )}
                  <svg className="chevron-down" width="24" height="24" viewBox="0 0 24 24">
                    <path d="M7 10l5 5 5-5" stroke="currentColor" strokeWidth="2" fill="none" />
                  </svg>
                </div>
              </div>
            )}
          </div>

          {/* Below-fold Preview Section */}
          {showForm && <PreviewSection />}
        </div>
      );
    };

    // Question Component
    const QuestionView = ({ question, questionNumber, totalQuestions, onAnswer, currentAnswer, onBack }) => {
      const domainColor = getDomainColor(question.domain);

      return (
        <div className="min-h-screen bg-[#101322] text-white flex flex-col relative">
          {/* Back button */}
          {onBack && (
            <button className="back-button" onClick={onBack}>
              <svg viewBox="0 0 16 16" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round">
                <path d="M10 12L6 8L10 4" />
              </svg>
              {questionNumber === 1 ? 'Exit' : 'Previous'}
            </button>
          )}

          <div className="px-6 py-4 pt-16 md:pt-4 border-b border-white/10">
            <div className="max-w-2xl mx-auto">
              <div className="flex justify-between items-center mb-3">
                <span className="text-sm text-gray-400 fustat">
                  Question {questionNumber} of {totalQuestions}
                </span>
                <span
                  className="text-xs px-3 py-1 rounded-full fustat"
                  style={{
                    backgroundColor: `${domainColor}30`,
                    color: domainColor,
                  }}
                >
                  {question.domain}
                </span>
              </div>
              <ProgressBar current={questionNumber} total={totalQuestions} />
            </div>
          </div>

          <div className="flex-1 flex items-center justify-center px-6 py-8">
            <div className="max-w-2xl w-full animate-fade-in">
              <div className="mb-6 text-left">
                <span className="text-sm text-gray-400 fustat">{question.skill}</span>
                <span className="mx-2 text-gray-600">•</span>
                <span className="text-sm text-gray-500 fustat">{question.axis}</span>
              </div>

              <h2 className="text-2xl md:text-3xl font-thin text-left mb-10 leading-relaxed fustat">
                {question.question}
              </h2>

              <div className="space-y-4">
                <button
                  onClick={() => onAnswer('A')}
                  className={`w-full p-6 rounded-xl text-left transition-all duration-300 border-2 ${
                    currentAnswer === 'A'
                      ? 'border-white bg-white/10'
                      : 'border-white/20 bg-white/5 hover:border-white/40 hover:bg-white/10'
                  } fustat`}
                >
                  <div className="flex items-start space-x-4">
                    <span
                      className={`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold flex-shrink-0 ${
                        currentAnswer === 'A' ? 'bg-white text-[#101322]' : 'bg-white/20 text-white'
                      }`}
                    >
                      A
                    </span>
                    <span className="text-lg">{question.optionA}</span>
                  </div>
                </button>

                <button
                  onClick={() => onAnswer('B')}
                  className={`w-full p-6 rounded-xl text-left transition-all duration-300 border-2 ${
                    currentAnswer === 'B'
                      ? 'border-white bg-white/10'
                      : 'border-white/20 bg-white/5 hover:border-white/40 hover:bg-white/10'
                  } fustat`}
                >
                  <div className="flex items-start space-x-4">
                    <span
                      className={`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold flex-shrink-0 ${
                        currentAnswer === 'B' ? 'bg-white text-[#101322]' : 'bg-white/20 text-white'
                      }`}
                    >
                      B
                    </span>
                    <span className="text-lg">{question.optionB}</span>
                  </div>
                </button>
              </div>
            </div>
          </div>
        </div>
      );
    };

    // ============================================================================
    // SCROLLYTELLING RESULTS COMPONENTS
    // ============================================================================

    // Persona mottos for hero card
    const PERSONA_MOTTOS = {
      'The Pathfinder': 'First to see where we need to go',
      'The Architect': 'Builder of believable futures',
      'The Truth-Teller': 'The conscience of the organization',
      'The Guardian': 'Keeper of belonging and safety',
      'The Driver': 'Owner of outcomes',
      'The Optimizer': 'Master of repeatability',
      'The Explorer': 'Pioneer of possibility',
      'The Builder': 'Creator of capability',
      'The Stabilizer': 'Anchor in the storm',
      'The Disruptor': 'Breaker of inertia'
    };

    // Gifts with icons for each persona
    const GIFTS_DATA = {
      'The Pathfinder': [
        { title: 'Sets direction fast', description: "You see where to go when others are stuck in analysis", icon: '🎯' },
        { title: 'Rallies action', description: "People follow you because your vision is compelling", icon: '🚀' },
        { title: 'Breaks drift', description: "You don't let teams wander—you point them somewhere that matters", icon: '⚡' },
        { title: 'Creates meaning', description: "You connect today's work to tomorrow's impact", icon: '✨' }
      ],
      'The Architect': [
        { title: 'Earns buy-in', description: "You bring people along because they believe in the plan", icon: '🤝' },
        { title: 'Builds credibility', description: "Your visions are realistic enough to be achievable", icon: '🏗️' },
        { title: 'Reduces resistance', description: "Change feels less threatening when you lead it", icon: '🌊' },
        { title: 'Creates alignment', description: "Teams move together because they helped shape the direction", icon: '🧭' }
      ],
      'The Truth-Teller': [
        { title: 'Surfaces issues', description: "Problems don't fester because you name them early", icon: '🔍' },
        { title: 'Holds standards', description: "People rise to meet your expectations", icon: '📏' },
        { title: 'Creates transparency', description: "Everyone knows where they stand with you", icon: '💎' },
        { title: 'Builds accountability', description: "Your honesty creates cultures of ownership", icon: '⚖️' }
      ],
      'The Guardian': [
        { title: 'Creates safety', description: "People take risks because they know you have their back", icon: '🛡️' },
        { title: 'Builds belonging', description: "Teams feel like they matter, not just their output", icon: '💙' },
        { title: 'Protects capacity', description: "You prevent burnout by watching out for people", icon: '🌱' },
        { title: 'Enables honesty', description: "People share hard truths because you've built trust", icon: '🤲' }
      ],
      'The Driver': [
        { title: 'Makes decisions', description: "When others deliberate, you act", icon: '⚡' },
        { title: 'Creates momentum', description: "Teams move fast because you clear the path", icon: '🏃' },
        { title: 'Gets outcomes', description: "Results follow you because you don't let things drift", icon: '🎯' },
        { title: 'Owns it', description: "When something needs doing, you make it your job", icon: '💪' }
      ],
      'The Optimizer': [
        { title: 'Ensures quality', description: "Things work because you thought them through", icon: '✅' },
        { title: 'Reduces risk', description: "Your decisions stand the test of time", icon: '🔒' },
        { title: 'Maintains options', description: "You don't close doors prematurely", icon: '🚪' },
        { title: 'Adapts wisely', description: "You read changing conditions and adjust", icon: '🔄' }
      ],
      'The Explorer': [
        { title: 'Discovers possibilities', description: "You find opportunities others don't see", icon: '🔭' },
        { title: 'Pushes boundaries', description: "Innovation happens because you question limits", icon: '🚀' },
        { title: 'Liberates thinking', description: "People explore freely because you give them space", icon: '🌌' },
        { title: 'Sparks curiosity', description: "Your questions open up new territories", icon: '💡' }
      ],
      'The Builder': [
        { title: 'Develops capability', description: "People grow because you invest in them systematically", icon: '📈' },
        { title: 'Creates systems', description: "Success becomes repeatable, not accidental", icon: '⚙️' },
        { title: 'Builds mastery', description: "Deep expertise emerges from your structured approach", icon: '🏆' },
        { title: 'Ensures practical impact', description: "Learning translates into real results", icon: '🎓' }
      ],
      'The Stabilizer': [
        { title: 'Provides calm', description: "In chaos, people look to you for grounding", icon: '⚓' },
        { title: 'Protects wellbeing', description: "You notice when people need rest before they crash", icon: '💚' },
        { title: 'Preserves value', description: "You don't throw out what's working in pursuit of new", icon: '🏛️' },
        { title: 'Creates sustainability', description: "Teams go further because you pace them well", icon: '🌿' }
      ],
      'The Disruptor': [
        { title: 'Breaks through', description: "Barriers others accept as fixed, you shatter", icon: '💥' },
        { title: 'Creates transformation', description: "Real change happens because you push for it", icon: '🔥' },
        { title: 'Maintains momentum', description: "You don't let comfort stop progress", icon: '🌊' },
        { title: 'Tells hard truths', description: "You cut through fog to what needs to happen", icon: '⚔️' }
      ]
    };

    // Warning signs for each persona under pressure
    const WARNING_SIGNS = {
      'The Pathfinder': [
        'You stop asking "What do you think?" and start declaring "Here\'s what we\'re doing"',
        'People are nodding but you sense they\'re not really with you',
        'You\'re moving faster but getting less traction'
      ],
      'The Architect': [
        'Every decision needs another meeting, another stakeholder',
        'You\'re so focused on buy-in that you\'re not actually moving',
        'Bold ideas keep getting watered down to safe ones'
      ],
      'The Truth-Teller': [
        'People are defensive before you even finish speaking',
        'You\'re right, but you\'re alone',
        'Standards feel more like weapons than tools'
      ],
      'The Guardian': [
        'You\'re shielding people from feedback they need to hear',
        'Harmony is preserved but performance issues persist',
        'You feel exhausted from carrying everyone\'s emotions'
      ],
      'The Driver': [
        'You\'ve made three decisions before anyone else finished thinking',
        'People have stopped offering input because you\'ll decide anyway',
        'Speed feels more important than direction'
      ],
      'The Optimizer': [
        'You need one more data point before you can commit',
        'Options are multiplying but decisions aren\'t',
        'The window of opportunity is closing while you analyze'
      ],
      'The Explorer': [
        'You\'ve started five new things but finished none',
        'Your team can\'t tell what\'s exploration vs. expectation',
        'Interesting feels more compelling than important'
      ],
      'The Builder': [
        'Your way has become the only way',
        'Development feels more like compliance than growth',
        'You\'re teaching answers instead of enabling discovery'
      ],
      'The Stabilizer': [
        'You\'re calming people who need to be mobilized',
        'Recovery time is expanding to fill all available space',
        '"Not yet" has become your default response to change'
      ],
      'The Disruptor': [
        'You\'re breaking things that weren\'t actually broken',
        'People have stopped sharing concerns because you\'ll push through anyway',
        'Resistance feels like the enemy rather than useful data'
      ]
    };

    // Cluster info for engine card
    const CLUSTER_INFO = {
      DIRECTION: {
        description: 'You see where others should go and why it matters. You cut through drift with clarity and rally people toward a compelling future.',
        skills: [
          { name: 'Purpose', domain: 'Lead Self' },
          { name: 'Alignment', domain: 'Lead Team' },
          { name: 'Vision', domain: 'Lead the Org' }
        ]
      },
      TRUST: {
        description: 'You create environments where people can be honest and take risks. You balance care with accountability and build cultures where people feel they belong.',
        skills: [
          { name: 'Integrity', domain: 'Lead Self' },
          { name: 'Psychological Safety', domain: 'Lead Team' },
          { name: 'Culture', domain: 'Lead the Org' }
        ]
      },
      EXECUTION: {
        description: 'You turn strategy into action and get things done. You make decisions with incomplete information and drive accountability.',
        skills: [
          { name: 'Accountability', domain: 'Lead Self' },
          { name: 'Decision Making', domain: 'Lead Team' },
          { name: 'Strategy', domain: 'Lead the Org' }
        ]
      },
      DEVELOPMENT: {
        description: 'You develop people and systems for the long term. You balance exploration with proven methods and create conditions for innovation.',
        skills: [
          { name: 'Learning', domain: 'Lead Self' },
          { name: 'Coaching', domain: 'Lead Team' },
          { name: 'Innovation', domain: 'Lead the Org' }
        ]
      },
      ADAPTATION: {
        description: 'You read the room and respond to what\'s needed. You balance grit with recovery and help people navigate transitions.',
        skills: [
          { name: 'Resilience', domain: 'Lead Self' },
          { name: 'Emotional Intelligence', domain: 'Lead Team' },
          { name: 'Change', domain: 'Lead the Org' }
        ]
      }
    };

    // Axis labels by cluster for style card
    const AXIS_LABELS = {
      DIRECTION: [
        { left: 'Meaning', right: 'Usefulness', skill: 'Purpose',
          leftSentence: 'You lead with why it matters, even if the path is unclear.',
          rightSentence: 'You lead with what works, even if the why takes time.' },
        { left: 'Clarity', right: 'Buy-in', skill: 'Alignment',
          leftSentence: 'You set direction first and build consensus second.',
          rightSentence: 'You build consensus first and set direction second.' },
        { left: 'Boldness', right: 'Credibility', skill: 'Vision',
          leftSentence: 'You paint a future worth chasing, even if it feels risky.',
          rightSentence: 'You paint a future people believe in, grounded in proof.' }
      ],
      TRUST: [
        { left: 'Truth', right: 'Loyalty', skill: 'Integrity',
          leftSentence: 'You tell people what they need to hear, even when it hurts.',
          rightSentence: 'You protect relationships, even when truths get delayed.' },
        { left: 'Care', right: 'Courage', skill: 'Psychological Safety',
          leftSentence: 'You create safety by showing you are on their side.',
          rightSentence: 'You create safety by modeling honesty under pressure.' },
        { left: 'Belonging', right: 'Standards', skill: 'Culture',
          leftSentence: 'You build culture around inclusion and connection.',
          rightSentence: 'You build culture around excellence and accountability.' }
      ],
      EXECUTION: [
        { left: 'Ownership', right: 'Adaptation', skill: 'Accountability',
          leftSentence: 'You hold the line on commitments, even when context shifts.',
          rightSentence: 'You adjust commitments when context demands it.' },
        { left: 'Speed', right: 'Certainty', skill: 'Decision Making',
          leftSentence: 'You decide fast and correct course as you learn.',
          rightSentence: 'You gather evidence before committing to action.' },
        { left: 'Focus', right: 'Options', skill: 'Strategy',
          leftSentence: 'You bet big on fewer priorities and go deep.',
          rightSentence: 'You keep doors open and stay ready to pivot.' }
      ],
      DEVELOPMENT: [
        { left: 'Curiosity', right: 'Competence', skill: 'Learning',
          leftSentence: 'You chase new questions, even at the cost of mastery.',
          rightSentence: 'You deepen expertise, even at the cost of novelty.' },
        { left: 'Freedom', right: 'Structure', skill: 'Coaching',
          leftSentence: 'You give people space to find their own way.',
          rightSentence: 'You give people a clear path to follow.' },
        { left: 'Novelty', right: 'Utility', skill: 'Innovation',
          leftSentence: 'You explore new ideas before knowing if they will pay off.',
          rightSentence: 'You improve what works before chasing what is new.' }
      ],
      ADAPTATION: [
        { left: 'Grit', right: 'Recovery', skill: 'Resilience',
          leftSentence: 'You push through setbacks and keep moving forward.',
          rightSentence: 'You pause after setbacks to restore and regroup.' },
        { left: 'Warmth', right: 'Truth', skill: 'Emotional Intelligence',
          leftSentence: 'You lead with empathy, even when directness might help.',
          rightSentence: 'You lead with directness, even when it lands hard.' },
        { left: 'Stability', right: 'Disruption', skill: 'Change',
          leftSentence: 'You protect what works while change unfolds.',
          rightSentence: 'You challenge what works to make room for better.' }
      ]
    };

    // ============================================================================
    // PERSONA LIBRARY - Complete data for all 10 personas
    // ============================================================================

    const PERSONA_LIBRARY = {
      'The Pathfinder': {
        cluster: 'DIRECTION',
        tagline: 'You see the path when others are lost in the weeds.',
        engineDescription: 'Your Direction engine runs on vision and purpose. You naturally see where things need to go before others do, and you have a gift for making that future feel compelling and worth chasing.',
        coreSkills: [
          { name: 'Vision Setting', description: 'Painting a future worth moving toward' },
          { name: 'Pattern Recognition', description: 'Seeing connections others miss' },
          { name: 'Strategic Reframing', description: 'Shifting how people see the problem' }
        ],
        axisPositions: [
          { skill: 'Purpose', left: 'Meaning', right: 'Usefulness', position: 'left' },
          { skill: 'Alignment', left: 'Clarity', right: 'Buy-in', position: 'left' },
          { skill: 'Vision', left: 'Boldness', right: 'Credibility', position: 'left' }
        ],
        pressureExplanation: 'When stress hits, your visionary clarity turns inward. You can get stuck running scenarios in your head, searching for the perfect path forward while the window for action closes.',
        warningSigns: [
          'You have rewritten the strategy deck three times this week',
          'You are asking for "just one more analysis" before deciding',
          'Meetings end with more questions than answers'
        ]
      },
      'The Architect': {
        cluster: 'DIRECTION',
        tagline: 'You build bridges between bold ideas and practical reality.',
        engineDescription: 'Your Direction engine runs on strategic alignment. You have a gift for translating ambitious visions into credible plans that people actually believe in and want to follow.',
        coreSkills: [
          { name: 'Systems Design', description: 'Building structures that scale' },
          { name: 'Strategic Planning', description: 'Turning vision into actionable steps' },
          { name: 'Structural Thinking', description: 'Seeing how pieces fit together' }
        ],
        axisPositions: [
          { skill: 'Purpose', left: 'Meaning', right: 'Usefulness', position: 'right' },
          { skill: 'Alignment', left: 'Clarity', right: 'Buy-in', position: 'right' },
          { skill: 'Vision', left: 'Boldness', right: 'Credibility', position: 'right' }
        ],
        pressureExplanation: 'When stress hits, your structured approach becomes a cage. You cling to the plan even when circumstances demand flexibility, mistaking rigidity for discipline.',
        warningSigns: [
          'You are defending the original timeline despite new information',
          'You shut down alternative approaches without exploring them',
          'Your planning sessions have become longer and more detailed'
        ]
      },
      'The Guardian': {
        cluster: 'TRUST',
        tagline: 'You create the safety that lets people bring their whole selves.',
        engineDescription: 'Your Trust engine runs on psychological safety. You have a gift for making people feel protected and valued, creating environments where they can take risks and be honest.',
        coreSkills: [
          { name: 'Relationship Building', description: 'Creating deep, lasting connections' },
          { name: 'Protective Leadership', description: 'Shielding the team from harm' },
          { name: 'Emotional Attunement', description: 'Sensing what others need' }
        ],
        axisPositions: [
          { skill: 'Integrity', left: 'Truth', right: 'Loyalty', position: 'right' },
          { skill: 'Psychological Safety', left: 'Care', right: 'Courage', position: 'left' },
          { skill: 'Culture', left: 'Belonging', right: 'Standards', position: 'left' }
        ],
        pressureExplanation: 'When stress hits, your protective instincts go into overdrive. You start managing situations and conversations to prevent discomfort, even when that discomfort would lead to growth.',
        warningSigns: [
          'You are having sidebar conversations to smooth things over before meetings',
          'You find yourself answering questions on behalf of your team',
          'Difficult feedback keeps getting postponed "until the time is right"'
        ]
      },
      'The Truth-Teller': {
        cluster: 'TRUST',
        tagline: 'You say what others are thinking but afraid to voice.',
        engineDescription: 'Your Trust engine runs on radical honesty. You have a gift for cutting through fog and naming the real issues, creating cultures where candor is expected and valued.',
        coreSkills: [
          { name: 'Direct Communication', description: 'Saying what needs to be said' },
          { name: 'Transparent Feedback', description: 'Giving clarity without sugar-coating' },
          { name: 'Authentic Dialogue', description: 'Creating space for real conversations' }
        ],
        axisPositions: [
          { skill: 'Integrity', left: 'Truth', right: 'Loyalty', position: 'left' },
          { skill: 'Psychological Safety', left: 'Care', right: 'Courage', position: 'right' },
          { skill: 'Culture', left: 'Belonging', right: 'Standards', position: 'right' }
        ],
        pressureExplanation: 'When stress hits, your directness loses its warmth. The truths you tell land harder than intended because you stop cushioning the blow or checking if people are ready to hear it.',
        warningSigns: [
          'People are leaving your conversations looking shell-shocked',
          'You have started sentences with "I am just being honest" more than once today',
          'Your feedback is getting shorter and sharper'
        ]
      },
      'The Driver': {
        cluster: 'EXECUTION',
        tagline: 'You turn intention into action when others are still deliberating.',
        engineDescription: 'Your Execution engine runs on decisive momentum. You have a gift for cutting through hesitation and creating forward motion, getting results when others are stuck in analysis.',
        coreSkills: [
          { name: 'Decisive Action', description: 'Moving when others hesitate' },
          { name: 'Momentum Building', description: 'Creating and sustaining forward motion' },
          { name: 'Results Focus', description: 'Keeping eyes on the outcome' }
        ],
        axisPositions: [
          { skill: 'Accountability', left: 'Ownership', right: 'Adaptation', position: 'left' },
          { skill: 'Decision Making', left: 'Speed', right: 'Certainty', position: 'left' },
          { skill: 'Strategy', left: 'Focus', right: 'Options', position: 'left' }
        ],
        pressureExplanation: 'When stress hits, your decisiveness becomes a bulldozer. You stop asking for input because it feels like delay, and your drive to move forward leaves people feeling run over.',
        warningSigns: [
          'You are making decisions in meetings without pausing for questions',
          'Your emails have gotten shorter and more directive',
          'You have started doing tasks yourself rather than waiting for others'
        ]
      },
      'The Optimizer': {
        cluster: 'EXECUTION',
        tagline: 'You see the better way hiding inside the good-enough way.',
        engineDescription: 'Your Execution engine runs on continuous refinement. You have a gift for seeing what could be improved and making it better, creating systems and outcomes that stand the test of time.',
        coreSkills: [
          { name: 'Process Refinement', description: 'Making good things better' },
          { name: 'Quality Control', description: 'Maintaining high standards' },
          { name: 'Continuous Improvement', description: 'Never settling for done' }
        ],
        axisPositions: [
          { skill: 'Accountability', left: 'Ownership', right: 'Adaptation', position: 'right' },
          { skill: 'Decision Making', left: 'Speed', right: 'Certainty', position: 'right' },
          { skill: 'Strategy', left: 'Focus', right: 'Options', position: 'right' }
        ],
        pressureExplanation: 'When stress hits, your pursuit of excellence becomes a trap. Nothing feels ready to ship because there is always one more thing to improve, and your high standards become impossible bars.',
        warningSigns: [
          'Deadlines keep slipping because things "are not quite ready"',
          'You are running one more quality check after the final quality check',
          'The team has started hiding work from you to avoid more revision requests'
        ]
      },
      'The Explorer': {
        cluster: 'DEVELOPMENT',
        tagline: 'You find possibilities where others see dead ends.',
        engineDescription: 'Your Development engine runs on curiosity and discovery. You have a gift for asking questions others do not think to ask and finding new paths that expand what seems possible.',
        coreSkills: [
          { name: 'Creative Inquiry', description: 'Asking questions that open doors' },
          { name: 'Experimentation', description: 'Testing ideas through action' },
          { name: 'Adaptive Learning', description: 'Growing through discovery' }
        ],
        axisPositions: [
          { skill: 'Learning', left: 'Curiosity', right: 'Competence', position: 'left' },
          { skill: 'Coaching', left: 'Freedom', right: 'Structure', position: 'left' },
          { skill: 'Innovation', left: 'Novelty', right: 'Utility', position: 'left' }
        ],
        pressureExplanation: 'When stress hits, your curiosity becomes an escape route. You start new explorations to avoid the hard work of finishing, and your love of options becomes an inability to commit.',
        warningSigns: [
          'You have three new project ideas this week but none from last month are done',
          'Brainstorming sessions keep expanding scope instead of narrowing it',
          'You are researching adjacent topics instead of doing the task at hand'
        ]
      },
      'The Builder': {
        cluster: 'DEVELOPMENT',
        tagline: 'You grow people into their potential, one step at a time.',
        engineDescription: 'Your Development engine runs on structured growth. You have a gift for seeing what people could become and creating clear pathways to get them there, developing capability that lasts.',
        coreSkills: [
          { name: 'Talent Development', description: 'Growing people systematically' },
          { name: 'Capability Building', description: 'Creating lasting skills' },
          { name: 'Coaching & Mentoring', description: 'Guiding with wisdom and patience' }
        ],
        axisPositions: [
          { skill: 'Learning', left: 'Curiosity', right: 'Competence', position: 'right' },
          { skill: 'Coaching', left: 'Freedom', right: 'Structure', position: 'right' },
          { skill: 'Innovation', left: 'Novelty', right: 'Utility', position: 'right' }
        ],
        pressureExplanation: 'When stress hits, your guidance becomes control. You start prescribing solutions instead of asking questions, and your structured approach leaves no room for people to find their own way.',
        warningSigns: [
          'You are checking in on tasks more frequently than usual',
          'Your coaching sessions have become instruction sessions',
          'You have started doing work for people instead of teaching them'
        ]
      },
      'The Stabilizer': {
        cluster: 'ADAPTATION',
        tagline: 'You provide the steady ground others need to take risks.',
        engineDescription: 'Your Adaptation engine runs on grounded presence. You have a gift for staying calm when everything is chaotic, helping others find their footing so they can move forward with confidence.',
        coreSkills: [
          { name: 'Steady Presence', description: 'Being the calm in the storm' },
          { name: 'Risk Management', description: 'Protecting what matters most' },
          { name: 'Continuity Preservation', description: 'Maintaining what works' }
        ],
        axisPositions: [
          { skill: 'Resilience', left: 'Grit', right: 'Recovery', position: 'right' },
          { skill: 'Emotional Intelligence', left: 'Warmth', right: 'Truth', position: 'left' },
          { skill: 'Change', left: 'Stability', right: 'Disruption', position: 'left' }
        ],
        pressureExplanation: 'When stress hits, your steadiness becomes stubbornness. You dig in to protect the status quo even when change is necessary, and your stability becomes a wall against needed evolution.',
        warningSigns: [
          'You are defending processes with "this is how we have always done it"',
          'New ideas are getting a longer list of reasons why they will not work',
          'You are spending more energy managing concerns than exploring possibilities'
        ]
      },
      'The Disruptor': {
        cluster: 'ADAPTATION',
        tagline: 'You break through barriers others have accepted as permanent.',
        engineDescription: 'Your Adaptation engine runs on transformative energy. You have a gift for seeing what needs to change and having the courage to push for it, creating breakthroughs when others have settled.',
        coreSkills: [
          { name: 'Innovation Drive', description: 'Pushing for what could be' },
          { name: 'Status Quo Challenge', description: 'Questioning what everyone accepts' },
          { name: 'Change Catalyzing', description: 'Sparking transformation' }
        ],
        axisPositions: [
          { skill: 'Resilience', left: 'Grit', right: 'Recovery', position: 'left' },
          { skill: 'Emotional Intelligence', left: 'Warmth', right: 'Truth', position: 'right' },
          { skill: 'Change', left: 'Stability', right: 'Disruption', position: 'right' }
        ],
        pressureExplanation: 'When stress hits, your drive for change becomes destruction. You start breaking things that did not need breaking, and your push for transformation leaves valuable things in ruins.',
        warningSigns: [
          'You are proposing changes to systems that were working fine',
          'People are describing your energy as "intense" or "a lot" lately',
          'Your pushback on existing approaches has gotten more forceful'
        ]
      }
    };

    // ============================================================================
    // NARRATIVE CONTENT FOR RESULTS PAGE
    // ============================================================================

    // Engine narratives by cluster
    const ENGINE_NARRATIVES = {
      DIRECTION: {
        opening: "You're the one who sees the path when everyone else is lost. While others debate options, you're already pointing forward. This makes you invaluable when teams are stuck—your clarity cuts through the fog.",
        cost: "Here's the cost: you can be so focused on where you're going that you miss who's struggling to keep up. Your conviction can feel like pressure. Your clarity can oversimplify complexity.",
        atBest: "At your best, you don't just see the destination—you make others believe they can get there. You turn drift into direction, confusion into purpose."
      },
      TRUST: {
        opening: "You're the one who makes it safe to be honest. While others push for results, you're watching the room—who's checked out, who's holding back, who needs to be heard. This makes you essential for building teams that last.",
        cost: "Here's the cost: you can protect people from feedback they need to hear. Your care can become enabling. Your focus on belonging can avoid necessary conflict.",
        atBest: "At your best, you create the conditions where hard truths can surface. You build the safety that makes courage possible."
      },
      EXECUTION: {
        opening: "You're the one who makes things happen. While others analyze and plan, you're already moving. Decisions don't paralyze you—they energize you. This makes you invaluable when action is more important than perfection.",
        cost: "Here's the cost: you can move so fast that you miss important input. Your bias toward action can feel like steamrolling. Your focus can become tunnel vision.",
        atBest: "At your best, you turn strategy into reality. You create momentum that carries entire teams forward."
      },
      DEVELOPMENT: {
        opening: "You're the one who sees potential before it's proven. While others focus on today's output, you're investing in tomorrow's capability. This makes you essential for building organizations that grow.",
        cost: "Here's the cost: your long-term focus can frustrate those who need results now. Your belief in exploration can scatter energy. Your freedom can feel like abandonment.",
        atBest: "At your best, you multiply capacity. You help people discover what they're capable of—sometimes before they believe it themselves."
      },
      ADAPTATION: {
        opening: "You're the one who reads the room. While others push agendas, you're sensing what's really going on—the unspoken tensions, the shifting energy, the breaking points. This makes you essential for navigating change.",
        cost: "Here's the cost: your sensitivity can absorb others' stress. Your flexibility can look like indecision. Your focus on sustainability can resist necessary disruption.",
        atBest: "At your best, you help people stay human through hard things. You create resilience that bends but doesn't break."
      }
    };

    // Persona narratives for gifts section
    const PERSONA_NARRATIVES = {
      'The Pathfinder': {
        opening: "You've probably been called \"visionary\"—and also \"intense.\" When you walk into a room, people sense direction. You don't just have ideas; you have conviction. And that conviction is contagious.",
        whatOthersSee: "Others see someone who doesn't get stuck. You cut through analysis paralysis. You make the ambiguous feel clear. When teams are spinning, you give them somewhere to go.",
        theShadow: "The shadow of your gift: sometimes you're so certain of the destination that you forget to check if anyone's following. Your vision can feel like pressure. Your clarity can dismiss complexity."
      },
      'The Architect': {
        opening: "You've probably been called \"strategic\"—and also \"cautious.\" When you present a plan, people believe it. Not because it's flashy, but because it's credible. You build visions that actually work.",
        whatOthersSee: "Others see someone who earns buy-in. You don't just announce direction; you build it with people. When change happens on your watch, it sticks—because everyone helped shape it.",
        theShadow: "The shadow of your gift: sometimes you're so focused on buy-in that bold ideas get diluted. Your credibility can become playing it safe. Your inclusion can become consensus paralysis."
      },
      'The Truth-Teller': {
        opening: "You've probably been called \"honest\"—and also \"blunt.\" When something needs to be said, you say it. Not to hurt, but because you believe people deserve the truth. Sugarcoating feels like lying to you.",
        whatOthersSee: "Others see someone who surfaces real issues. With you, problems don't fester. Standards don't slip. People know exactly where they stand—and many of them are grateful for it.",
        theShadow: "The shadow of your gift: sometimes your truth lands before relationship is ready to receive it. Your courage can feel like attack. Your standards can feel like judgment."
      },
      'The Guardian': {
        opening: "You've probably been called \"caring\"—and also \"protective.\" When people are around you, they feel safe. Not because you shield them from challenge, but because they know you have their back.",
        whatOthersSee: "Others see someone who builds real trust. You notice when people are struggling before they say it. You create environments where honesty is possible because fear is low.",
        theShadow: "The shadow of your gift: sometimes you protect people from discomfort they need to grow. Your loyalty can enable poor performance. Your care can avoid necessary conflict."
      },
      'The Driver': {
        opening: "You've probably been called \"decisive\"—and also \"impatient.\" When others are still discussing, you're already doing. Waiting feels like wasting. You'd rather course-correct than not start.",
        whatOthersSee: "Others see someone who gets things done. Deadlines don't scare you. Ambiguity doesn't freeze you. When everyone's waiting for someone to go first, you're already moving.",
        theShadow: "The shadow of your gift: sometimes your speed leaves others behind. Your ownership can become control. Your focus can miss what's happening at the edges."
      },
      'The Optimizer': {
        opening: "You've probably been called \"thorough\"—and also \"slow.\" When you commit, it's because you've thought it through. Your decisions stand up because you stress-tested them first.",
        whatOthersSee: "Others see someone who reduces risk. You catch the problems everyone else missed. When your decisions land, they last—because you anticipated what could go wrong.",
        theShadow: "The shadow of your gift: sometimes your thoroughness becomes paralysis. Your desire for certainty can stall necessary action. Your options can multiply while windows close."
      },
      'The Explorer': {
        opening: "You've probably been called \"innovative\"—and also \"scattered.\" When everyone's doing it one way, you're wondering why. Constraints feel like puzzles to solve, not rules to follow.",
        whatOthersSee: "Others see someone who finds new paths. You ask questions no one thought to ask. You see opportunities hiding in plain sight. When teams are stuck in old patterns, you break them open.",
        theShadow: "The shadow of your gift: sometimes your exploration becomes distraction. Your freedom can feel like abandonment. Your novelty can chase interesting over important."
      },
      'The Builder': {
        opening: "You've probably been called \"developmental\"—and also \"demanding.\" You see potential in people and you invest in it systematically. Shortcuts feel like cheating—both for you and for them.",
        whatOthersSee: "Others see someone who grows capability. You don't just solve problems; you build people who can solve them. Your teams get stronger over time because you invested in foundations.",
        theShadow: "The shadow of your gift: sometimes your structure becomes rigidity. Your methods can feel like mandates. Your investment in \"the right way\" can dismiss other valid paths."
      },
      'The Stabilizer': {
        opening: "You've probably been called \"steady\"—and also \"resistant.\" When chaos hits, people look for you. Not for answers, but for grounding. You're the calm in their storm.",
        whatOthersSee: "Others see someone who holds things together. You notice burnout before it breaks. You preserve what's valuable when everyone else is chasing new. You help people pace themselves.",
        theShadow: "The shadow of your gift: sometimes your stability becomes resistance. Your preservation can protect what needs to change. Your calm can slow necessary urgency."
      },
      'The Disruptor': {
        opening: "You've probably been called \"bold\"—and also \"destructive.\" When something needs to change, you push. Not gently. You believe transformation requires force, and you're willing to apply it.",
        whatOthersSee: "Others see someone who breaks through barriers. You name what everyone's avoiding. You push past comfort into growth. When teams are stuck in their own inertia, you shatter it.",
        theShadow: "The shadow of your gift: sometimes your disruption breaks what was working. Your grit can become grinding. Your directness can leave people feeling unseen."
      }
    };

    // Pressure narratives
    const PRESSURE_NARRATIVES = {
      'The Crusader': "When the pressure mounts, your clarity becomes rigidity. You stop asking \"what do you think?\" and start declaring \"here's what we're doing.\" Your vision becomes a crusade—and crusades don't have room for doubt.",
      'The Diplomat': "When the pressure mounts, your inclusion becomes indecision. Every choice needs another meeting, another stakeholder, another round of buy-in. Bold ideas keep getting watered down to safe ones.",
      'The Enforcer': "When the pressure mounts, your honesty becomes bluntness. You're right—but you're alone. People get defensive before you even finish speaking. Your standards become weapons instead of tools.",
      'The Peacekeeper': "When the pressure mounts, your protection becomes avoidance. You're shielding people from feedback they need. Harmony is preserved, but problems persist. You're exhausted from carrying everyone's emotions.",
      'The Steamroller': "When the pressure mounts, your decisiveness becomes control. You've made three decisions before anyone else finished thinking. People stop offering input—because you'll decide anyway.",
      'The Perfectionist': "When the pressure mounts, your thoroughness becomes paralysis. You need one more data point, one more validation. Options multiply but decisions don't. The window closes while you analyze.",
      'The Wanderer': "When the pressure mounts, your exploration becomes escape. You've started five new things but finished none. Your team can't tell what's exploration versus expectation. Interesting beats important.",
      'The Taskmaster': "When the pressure mounts, your structure becomes rigidity. Your way becomes the only way. Development feels like compliance. You're teaching answers instead of enabling discovery.",
      'The Protector': "When the pressure mounts, your stability becomes resistance. You're calming people who need to be mobilized. Recovery time expands to fill all space. \"Not yet\" becomes your default.",
      'The Bulldozer': "When the pressure mounts, your disruption becomes destruction. You're breaking things that weren't broken. People stop sharing concerns because you'll push through anyway."
    };

    // Hardcoded pressure insights for all 10 personas - DO NOT modify these strings
    const PRESSURE_INSIGHTS = {
      // Direction Cluster
      'The Pathfinder': "When I'm stressed, my vision morphs into overthinking",
      'The Architect': "When I'm stressed, my planning morphs into rigidity",
      // Trust Cluster
      'The Guardian': "When I'm stressed, my protection morphs into control",
      'The Truth-Teller': "When I'm stressed, my honesty morphs into bluntness",
      // Execution Cluster
      'The Driver': "When I'm stressed, my decisiveness morphs into steamrolling",
      'The Optimizer': "When I'm stressed, my excellence morphs into perfectionism",
      // Development Cluster
      'The Explorer': "When I'm stressed, my curiosity morphs into distraction",
      'The Builder': "When I'm stressed, my support morphs into micromanagement",
      // Adaptation Cluster
      'The Stabilizer': "When I'm stressed, my steadiness morphs into resistance",
      'The Disruptor': "When I'm stressed, my innovation morphs into chaos"
    };

    // Helper function to get pressure insight by persona name (case-sensitive)
    const getPressureInsight = (personaName) => {
      const insight = PRESSURE_INSIGHTS[personaName];
      if (!insight) {
        console.warn(`No pressure insight found for persona: ${personaName}`);
        return "When I'm stressed, my strength becomes my weakness";
      }
      return insight;
    };

    // ============================================================================
    // CUSTOM ICONS FOR RESULTS PAGE
    // ============================================================================

    // Section headline icons
    const EngineIcon = ({ size = 28 }) => (
      <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
        <circle cx="16" cy="16" r="12" stroke="rgba(118, 140, 18, 0.6)" strokeWidth="2" fill="rgba(118, 140, 18, 0.1)" />
        <circle cx="16" cy="16" r="7" stroke="rgba(118, 140, 18, 0.4)" strokeWidth="1.5" fill="none" />
        <path d="M16 16 L18 8 L16 10 L14 8 Z" fill="#768C12" />
        <path d="M16 16 L14 24 L16 22 L18 24 Z" fill="rgba(118, 140, 18, 0.4)" />
        <circle cx="16" cy="16" r="2" fill="#768C12" />
      </svg>
    );

    const GiftsIcon = ({ size = 28 }) => (
      <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
        <path d="M16 6 L18 12 L24 12 L19 16 L21 22 L16 18 L11 22 L13 16 L8 12 L14 12 Z"
          fill="rgba(118, 140, 18, 0.2)" stroke="#768C12" strokeWidth="1.5" strokeLinejoin="round" />
        <circle cx="16" cy="14" r="2" fill="#768C12" />
      </svg>
    );

    const TradeoffsIcon = ({ size = 28 }) => (
      <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
        <line x1="6" y1="16" x2="26" y2="16" stroke="rgba(6, 109, 177, 0.6)" strokeWidth="2" strokeLinecap="round" />
        <circle cx="10" cy="16" r="4" fill="rgba(118, 140, 18, 0.2)" stroke="#768C12" strokeWidth="1.5" />
        <circle cx="22" cy="16" r="4" fill="rgba(6, 109, 177, 0.2)" stroke="#066DB1" strokeWidth="1.5" />
        <line x1="16" y1="8" x2="16" y2="24" stroke="rgba(255, 255, 255, 0.2)" strokeWidth="1" strokeDasharray="2 2" />
      </svg>
    );

    const PressureIcon = ({ size = 28 }) => (
      <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
        <path d="M16 4 L20 14 L16 12 L12 14 Z" fill="rgba(251, 146, 60, 0.8)" />
        <path d="M16 28 L12 18 L16 20 L20 18 Z" fill="rgba(251, 146, 60, 0.4)" />
        <circle cx="16" cy="16" r="3" fill="rgba(251, 146, 60, 0.3)" stroke="rgba(251, 146, 60, 0.8)" strokeWidth="1.5" />
        <circle cx="16" cy="16" r="10" stroke="rgba(251, 146, 60, 0.3)" strokeWidth="1.5" fill="none" strokeDasharray="3 3" />
      </svg>
    );

    const CompatibilityIcon = ({ size = 28 }) => (
      <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
        <circle cx="11" cy="14" r="5" fill="rgba(6, 109, 177, 0.15)" stroke="#066DB1" strokeWidth="1.5" />
        <circle cx="21" cy="14" r="5" fill="rgba(118, 140, 18, 0.15)" stroke="#768C12" strokeWidth="1.5" />
        <path d="M14 18 Q16 22 18 18" stroke="rgba(255, 255, 255, 0.4)" strokeWidth="1.5" fill="none" strokeLinecap="round" />
        <line x1="14" y1="14" x2="18" y2="14" stroke="rgba(255, 255, 255, 0.5)" strokeWidth="1.5" strokeLinecap="round" />
      </svg>
    );

    // Card icons - generic types
    const WarningIcon = ({ size = 32 }) => (
      <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
        <path d="M16 4 L28 26 L4 26 Z" fill="rgba(251, 146, 60, 0.15)" stroke="rgba(251, 146, 60, 0.8)" strokeWidth="2" strokeLinejoin="round" />
        <line x1="16" y1="12" x2="16" y2="18" stroke="rgba(251, 146, 60, 0.9)" strokeWidth="2.5" strokeLinecap="round" />
        <circle cx="16" cy="22" r="1.5" fill="rgba(251, 146, 60, 0.9)" />
      </svg>
    );

    const BalanceIcon = ({ size = 32 }) => (
      <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
        <line x1="16" y1="6" x2="16" y2="26" stroke="rgba(118, 140, 18, 0.6)" strokeWidth="2" strokeLinecap="round" />
        <line x1="6" y1="12" x2="26" y2="12" stroke="rgba(118, 140, 18, 0.8)" strokeWidth="2" strokeLinecap="round" />
        <circle cx="8" cy="12" r="3" fill="rgba(118, 140, 18, 0.2)" stroke="#768C12" strokeWidth="1.5" />
        <circle cx="24" cy="12" r="3" fill="rgba(118, 140, 18, 0.2)" stroke="#768C12" strokeWidth="1.5" />
        <path d="M12 26 L16 22 L20 26" stroke="rgba(118, 140, 18, 0.6)" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" fill="none" />
      </svg>
    );

    const PartnerIcon = ({ size = 32 }) => (
      <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
        <circle cx="11" cy="12" r="5" fill="rgba(6, 109, 177, 0.15)" stroke="#066DB1" strokeWidth="1.5" />
        <circle cx="21" cy="12" r="5" fill="rgba(6, 109, 177, 0.15)" stroke="#066DB1" strokeWidth="1.5" />
        <path d="M6 26 C6 21 8 19 11 19 C13 19 14 20 16 20 C18 20 19 19 21 19 C24 19 26 21 26 26"
          stroke="#066DB1" strokeWidth="1.5" strokeLinecap="round" fill="rgba(6, 109, 177, 0.1)" />
      </svg>
    );

    const FrictionIcon = ({ size = 32 }) => (
      <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
        <circle cx="10" cy="16" r="6" fill="rgba(128, 43, 100, 0.1)" stroke="#802B64" strokeWidth="1.5" />
        <circle cx="22" cy="16" r="6" fill="rgba(128, 43, 100, 0.1)" stroke="#802B64" strokeWidth="1.5" />
        <path d="M14 13 L18 19 M18 13 L14 19" stroke="rgba(251, 146, 60, 0.7)" strokeWidth="2" strokeLinecap="round" />
      </svg>
    );

    // ============================================================================
    // CLUSTER ICONS - Custom SVG icons for each leadership engine
    // ============================================================================

    // Direction Cluster Icon - Compass pointing the way
    const DirectionClusterIcon = ({ size = 48, color = "#768C12" }) => (
      <svg width={size} height={size} viewBox="0 0 48 48" fill="none">
        <circle cx="24" cy="24" r="18" stroke={color} strokeWidth="2" strokeOpacity="0.3" fill="none" />
        <circle cx="24" cy="24" r="12" stroke={color} strokeWidth="1.5" strokeOpacity="0.5" fill="none" />
        <path d="M24 6 L26 18 L24 16 L22 18 Z" fill={color} fillOpacity="0.9" />
        <path d="M24 42 L22 30 L24 32 L26 30 Z" fill={color} fillOpacity="0.4" />
        <path d="M6 24 L18 22 L16 24 L18 26 Z" fill={color} fillOpacity="0.4" />
        <path d="M42 24 L30 26 L32 24 L30 22 Z" fill={color} fillOpacity="0.4" />
        <circle cx="24" cy="24" r="3" fill={color} />
      </svg>
    );

    // Trust Cluster Icon - Connected figures forming bond
    const TrustClusterIcon = ({ size = 48, color = "#066DB1" }) => (
      <svg width={size} height={size} viewBox="0 0 48 48" fill="none">
        <circle cx="16" cy="16" r="6" fill={color} fillOpacity="0.15" stroke={color} strokeWidth="1.5" />
        <circle cx="32" cy="16" r="6" fill={color} fillOpacity="0.15" stroke={color} strokeWidth="1.5" />
        <path d="M10 38 C10 30 13 26 16 26 C19 26 21 28 24 28 C27 28 29 26 32 26 C35 26 38 30 38 38"
          fill={color} fillOpacity="0.1" stroke={color} strokeWidth="1.5" strokeLinecap="round" />
        <path d="M20 20 Q24 24 28 20" stroke={color} strokeWidth="2" strokeLinecap="round" fill="none" />
        <circle cx="24" cy="32" r="3" fill={color} fillOpacity="0.6" />
      </svg>
    );

    // Execution Cluster Icon - Lightning bolt for action
    const ExecutionClusterIcon = ({ size = 48, color = "#802B64" }) => (
      <svg width={size} height={size} viewBox="0 0 48 48" fill="none">
        <path d="M28 4 L14 24 L22 24 L20 44 L34 22 L26 22 Z"
          fill={color} fillOpacity="0.2" stroke={color} strokeWidth="2" strokeLinejoin="round" />
        <path d="M24 18 L20 24 L24 24 L22 32" stroke={color} strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round" fill="none" />
        <circle cx="10" cy="12" r="2" fill={color} fillOpacity="0.4" />
        <circle cx="38" cy="36" r="2" fill={color} fillOpacity="0.4" />
        <circle cx="8" cy="32" r="1.5" fill={color} fillOpacity="0.3" />
        <circle cx="40" cy="14" r="1.5" fill={color} fillOpacity="0.3" />
      </svg>
    );

    // Development Cluster Icon - Growing plant/seedling
    const DevelopmentClusterIcon = ({ size = 48, color = "#768C12" }) => (
      <svg width={size} height={size} viewBox="0 0 48 48" fill="none">
        <path d="M24 42 L24 22" stroke={color} strokeWidth="2.5" strokeLinecap="round" />
        <path d="M24 28 Q16 28 14 20 Q14 14 24 18" fill={color} fillOpacity="0.2" stroke={color} strokeWidth="1.5" />
        <path d="M24 22 Q32 22 34 14 Q34 8 24 12" fill={color} fillOpacity="0.2" stroke={color} strokeWidth="1.5" />
        <path d="M24 16 Q28 12 32 8" stroke={color} strokeWidth="1.5" strokeLinecap="round" fill="none" />
        <circle cx="34" cy="6" r="2" fill={color} fillOpacity="0.6" />
        <ellipse cx="24" cy="44" rx="8" ry="2" fill={color} fillOpacity="0.2" />
      </svg>
    );

    // Adaptation Cluster Icon - Flowing cycle/waves
    const AdaptationClusterIcon = ({ size = 48, color = "#066DB1" }) => (
      <svg width={size} height={size} viewBox="0 0 48 48" fill="none">
        <path d="M8 24 Q8 12 20 12 L20 8 L28 14 L20 20 L20 16 Q12 16 12 24 Q12 32 20 32"
          stroke={color} strokeWidth="2" strokeLinecap="round" fill="none" />
        <path d="M40 24 Q40 36 28 36 L28 40 L20 34 L28 28 L28 32 Q36 32 36 24 Q36 16 28 16"
          stroke={color} strokeWidth="2" strokeLinecap="round" fill="none" />
        <circle cx="24" cy="24" r="4" fill={color} fillOpacity="0.3" stroke={color} strokeWidth="1.5" />
        <circle cx="24" cy="24" r="1.5" fill={color} />
      </svg>
    );

    // Map cluster to icon component
    const CLUSTER_ICONS = {
      DIRECTION: DirectionClusterIcon,
      TRUST: TrustClusterIcon,
      EXECUTION: ExecutionClusterIcon,
      DEVELOPMENT: DevelopmentClusterIcon,
      ADAPTATION: AdaptationClusterIcon
    };

    // Persona-specific icons for the library
    const PERSONA_ICONS = {
      'The Pathfinder': PathfinderIconSimple,
      'The Architect': ArchitectIconSimple,
      'The Guardian': GuardianIconSimple,
      'The Truth-Teller': TruthTellerIconSimple,
      'The Driver': DriverIconSimple,
      'The Optimizer': OptimizerIconSimple,
      'The Explorer': ExplorerIconSimple,
      'The Builder': BuilderIconSimple,
      'The Stabilizer': StabilizerIconSimple,
      'The Disruptor': DisruptorIconSimple
    };

    // ============================================================================
    // TIMELINE PREVIEW ILLUSTRATIONS
    // ============================================================================

    // Engine Illustration - Gear mechanism
    const EngineIllustration = () => (
      <svg width="48" height="48" viewBox="0 0 48 48" fill="none">
        {/* Outer gear ring */}
        <circle cx="24" cy="24" r="16" stroke="rgba(255, 255, 255, 0.5)" strokeWidth="2" fill="none">
          <animateTransform
            attributeName="transform"
            type="rotate"
            from="0 24 24"
            to="360 24 24"
            dur="20s"
            repeatCount="indefinite"
          />
        </circle>
        {/* Gear teeth */}
        {[0, 45, 90, 135, 180, 225, 270, 315].map((angle, i) => {
          const rad = (angle * Math.PI) / 180;
          const x = 24 + Math.cos(rad) * 16;
          const y = 24 + Math.sin(rad) * 16;
          return (
            <rect
              key={i}
              x={x - 2}
              y={y - 4}
              width="4"
              height="8"
              fill="rgba(255, 255, 255, 0.5)"
              rx="1"
              transform={`rotate(${angle}, ${x}, ${y})`}
            >
              <animateTransform
                attributeName="transform"
                type="rotate"
                from={`${angle} 24 24`}
                to={`${angle + 360} 24 24`}
                dur="20s"
                repeatCount="indefinite"
                additive="sum"
              />
            </rect>
          );
        })}
        {/* Inner circle */}
        <circle cx="24" cy="24" r="9" stroke="rgba(255, 255, 255, 0.7)" strokeWidth="2" fill="rgba(255, 255, 255, 0.1)">
          <animate
            attributeName="r"
            values="9;10;9"
            dur="2s"
            repeatCount="indefinite"
          />
        </circle>
        {/* Center dot */}
        <circle cx="24" cy="24" r="3" fill="rgba(255, 255, 255, 0.8)" />
      </svg>
    );

    // Style Illustration - Balance Scale
    const StyleIllustration = () => (
      <svg width="48" height="48" viewBox="0 0 48 48" fill="none">
        {/* Base */}
        <rect x="18" y="40" width="12" height="3" fill="rgba(255, 255, 255, 0.5)" rx="1.5" />
        {/* Pole */}
        <rect x="22.5" y="16" width="3" height="24" fill="rgba(255, 255, 255, 0.6)" rx="1.5" />
        {/* Balance beam */}
        <line x1="6" y1="16" x2="42" y2="16" stroke="rgba(255, 255, 255, 0.7)" strokeWidth="2.5" strokeLinecap="round" />
        {/* Fulcrum triangle */}
        <path d="M24 13 L20 18 L28 18 Z" fill="rgba(255, 255, 255, 0.6)" />
        {/* Left pan strings */}
        <path d="M6 16 L3 8 L9 8 Z" stroke="rgba(255, 255, 255, 0.5)" strokeWidth="1.5" fill="none" />
        {/* Left pan */}
        <ellipse cx="6" cy="8" rx="7" ry="2.5" fill="rgba(255, 255, 255, 0.15)" stroke="rgba(255, 255, 255, 0.5)" strokeWidth="1.5" />
        {/* Right pan strings */}
        <path d="M42 16 L39 8 L45 8 Z" stroke="rgba(255, 255, 255, 0.5)" strokeWidth="1.5" fill="none" />
        {/* Right pan */}
        <ellipse cx="42" cy="8" rx="7" ry="2.5" fill="rgba(255, 255, 255, 0.15)" stroke="rgba(255, 255, 255, 0.5)" strokeWidth="1.5" />
      </svg>
    );

    // Gifts Illustration - Spark/Star burst
    const GiftsIllustration = () => (
      <svg width="48" height="48" viewBox="0 0 48 48" fill="none">
        {/* Central circle */}
        <circle cx="24" cy="24" r="6" fill="rgba(255, 255, 255, 0.2)" stroke="rgba(255, 255, 255, 0.8)" strokeWidth="2" />
        {/* 8 radiating lines/sparks */}
        {[0, 45, 90, 135, 180, 225, 270, 315].map((angle, i) => {
          const rad = (angle * Math.PI) / 180;
          const x1 = 24 + Math.cos(rad) * 9;
          const y1 = 24 + Math.sin(rad) * 9;
          const x2 = 24 + Math.cos(rad) * 19;
          const y2 = 24 + Math.sin(rad) * 19;
          return (
            <line
              key={i}
              x1={x1} y1={y1}
              x2={x2} y2={y2}
              stroke="rgba(255, 255, 255, 0.6)"
              strokeWidth="2"
              strokeLinecap="round"
            />
          );
        })}
        {/* Outer glow ring */}
        <circle cx="24" cy="24" r="6" fill="none" stroke="rgba(255, 255, 255, 0.4)" strokeWidth="2">
          <animate
            attributeName="r"
            values="6;16;16"
            dur="2s"
            repeatCount="indefinite"
          />
          <animate
            attributeName="opacity"
            values="0.4;0;0"
            dur="2s"
            repeatCount="indefinite"
          />
        </circle>
      </svg>
    );

    // Pressure Illustration - Gauge/Warning
    const PressureIllustration = () => (
      <svg width="48" height="48" viewBox="0 0 48 48" fill="none">
        {/* Gauge arc background */}
        <path
          d="M 10 32 A 14 14 0 0 1 38 32"
          stroke="rgba(255, 255, 255, 0.3)"
          strokeWidth="3"
          strokeLinecap="round"
          fill="none"
        />
        {/* Warning section (red arc on right side) */}
        <path
          d="M 30 22 A 14 14 0 0 1 38 32"
          stroke="rgba(255, 100, 100, 0.6)"
          strokeWidth="3"
          strokeLinecap="round"
          fill="none"
        />
        {/* Gauge tick marks */}
        <line x1="10" y1="32" x2="13" y2="32" stroke="rgba(255, 255, 255, 0.5)" strokeWidth="2" strokeLinecap="round" />
        <line x1="14" y1="22" x2="16.5" y2="24" stroke="rgba(255, 255, 255, 0.5)" strokeWidth="2" strokeLinecap="round" />
        <line x1="24" y1="18" x2="24" y2="21" stroke="rgba(255, 255, 255, 0.5)" strokeWidth="2" strokeLinecap="round" />
        <line x1="34" y1="22" x2="31.5" y2="24" stroke="rgba(255, 100, 100, 0.5)" strokeWidth="2" strokeLinecap="round" />
        <line x1="38" y1="32" x2="35" y2="32" stroke="rgba(255, 100, 100, 0.5)" strokeWidth="2" strokeLinecap="round" />
        {/* Gauge needle */}
        <g>
          <line
            x1="24" y1="32"
            x2="24" y2="20"
            stroke="rgba(255, 255, 255, 0.9)"
            strokeWidth="2.5"
            strokeLinecap="round"
          >
            <animateTransform
              attributeName="transform"
              type="rotate"
              from="-45 24 32"
              to="0 24 32"
              dur="1.5s"
              fill="freeze"
            />
          </line>
        </g>
        {/* Center pivot */}
        <circle cx="24" cy="32" r="4" fill="rgba(255, 255, 255, 0.9)" />
        {/* Warning indicator */}
        <circle cx="24" cy="42" r="2.5" fill="rgba(255, 100, 100, 0.7)">
          <animate
            attributeName="opacity"
            values="0.7;1;0.7"
            dur="1.5s"
            repeatCount="indefinite"
          />
        </circle>
      </svg>
    );

    // People Illustration - Network/Connections
    const PeopleIllustration = () => {
      const nodes = [
        { x: 24, y: 12, size: 6 },
        { x: 10, y: 24, size: 5 },
        { x: 38, y: 24, size: 5 },
        { x: 14, y: 38, size: 4.5 },
        { x: 34, y: 38, size: 4.5 }
      ];

      const connections = [
        [0, 1], [0, 2], [1, 3], [2, 4], [1, 4], [2, 3], [3, 4]
      ];

      return (
        <svg width="48" height="48" viewBox="0 0 48 48" fill="none">
          {/* Connections */}
          {connections.map(([from, to], i) => (
            <line
              key={i}
              x1={nodes[from].x}
              y1={nodes[from].y}
              x2={nodes[to].x}
              y2={nodes[to].y}
              stroke="rgba(255, 255, 255, 0.35)"
              strokeWidth="1.5"
            />
          ))}
          {/* Nodes */}
          {nodes.map((node, i) => (
            <circle
              key={i}
              cx={node.x}
              cy={node.y}
              r={node.size}
              fill="rgba(255, 255, 255, 0.15)"
              stroke="rgba(255, 255, 255, 0.7)"
              strokeWidth="1.5"
            />
          ))}
          {/* Center node highlight pulse */}
          <circle cx={nodes[0].x} cy={nodes[0].y} r={nodes[0].size} fill="none" stroke="rgba(255, 255, 255, 0.5)" strokeWidth="1.5">
            <animate
              attributeName="r"
              values="6;12;12"
              dur="2s"
              repeatCount="indefinite"
            />
            <animate
              attributeName="opacity"
              values="0.5;0;0"
              dur="2s"
              repeatCount="indefinite"
            />
          </circle>
        </svg>
      );
    };

    // Timeline Preview Component
    const TimelinePreview = () => {
      const sections = [
        {
          id: 'engine',
          illustration: <EngineIllustration />,
          label: 'Engine',
          description: 'What drives you'
        },
        {
          id: 'style',
          illustration: <StyleIllustration />,
          label: 'Style',
          description: 'Where you lean'
        },
        {
          id: 'gifts',
          illustration: <GiftsIllustration />,
          label: 'Gifts',
          description: 'What makes you different'
        },
        {
          id: 'pressure',
          illustration: <PressureIllustration />,
          label: 'Pressure',
          description: 'Your shadow side'
        },
        {
          id: 'people',
          illustration: <PeopleIllustration />,
          label: 'People',
          description: 'Who you work well with'
        }
      ];

      return (
        <div className="timeline-preview">
          <h2 className="timeline-heading">Here's What You'll Discover</h2>

          <div className="timeline-container">
            <div className="timeline-line" />

            {sections.map((section, index) => (
              <div
                key={section.id}
                className="timeline-node"
              >
                <div className="node-dot">
                  {section.illustration}
                </div>
                <h3 className="node-label">{section.label}</h3>
                <p className="node-description">{section.description}</p>
              </div>
            ))}
          </div>
        </div>
      );
    };

    // Gift-specific icons (used in gift cards)
    const GIFT_ICONS = {
      // Direction icons
      target: ({ size = 32 }) => (
        <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
          <circle cx="16" cy="16" r="10" stroke="rgba(118, 140, 18, 0.4)" strokeWidth="1.5" fill="none" />
          <circle cx="16" cy="16" r="6" stroke="rgba(118, 140, 18, 0.5)" strokeWidth="1.5" fill="none" />
          <circle cx="16" cy="16" r="2" fill="#768C12" />
        </svg>
      ),
      rocket: ({ size = 32 }) => (
        <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
          <path d="M16 4 L20 12 L16 10 L12 12 Z" fill="rgba(118, 140, 18, 0.3)" stroke="#768C12" strokeWidth="1.5" />
          <rect x="13" y="12" width="6" height="10" rx="2" fill="rgba(118, 140, 18, 0.2)" stroke="#768C12" strokeWidth="1.5" />
          <path d="M10 26 L13 20 M22 26 L19 20" stroke="#768C12" strokeWidth="1.5" strokeLinecap="round" />
        </svg>
      ),
      lightning: ({ size = 32 }) => (
        <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
          <path d="M18 4 L10 16 L15 16 L14 28 L22 14 L17 14 Z" fill="rgba(118, 140, 18, 0.25)" stroke="#768C12" strokeWidth="1.5" strokeLinejoin="round" />
        </svg>
      ),
      spark: ({ size = 32 }) => (
        <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
          <path d="M16 4 L17 12 L24 10 L18 16 L26 18 L18 20 L20 28 L16 21 L12 28 L14 20 L6 18 L14 16 L8 10 L15 12 Z"
            fill="rgba(118, 140, 18, 0.2)" stroke="#768C12" strokeWidth="1.5" strokeLinejoin="round" />
        </svg>
      ),
      // Trust icons
      handshake: ({ size = 32 }) => (
        <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
          <path d="M4 14 L10 14 L14 18 L18 14 L22 18" stroke="#066DB1" strokeWidth="2" strokeLinecap="round" fill="none" />
          <path d="M28 14 L22 14" stroke="#066DB1" strokeWidth="2" strokeLinecap="round" />
          <circle cx="14" cy="18" r="2" fill="rgba(6, 109, 177, 0.3)" />
        </svg>
      ),
      building: ({ size = 32 }) => (
        <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
          <rect x="8" y="10" width="16" height="18" rx="1" fill="rgba(6, 109, 177, 0.15)" stroke="#066DB1" strokeWidth="1.5" />
          <rect x="11" y="14" width="4" height="4" fill="rgba(6, 109, 177, 0.3)" />
          <rect x="17" y="14" width="4" height="4" fill="rgba(6, 109, 177, 0.3)" />
          <rect x="11" y="20" width="4" height="4" fill="rgba(6, 109, 177, 0.3)" />
          <rect x="17" y="20" width="4" height="4" fill="rgba(6, 109, 177, 0.3)" />
          <path d="M8 10 L16 4 L24 10" stroke="#066DB1" strokeWidth="1.5" fill="none" />
        </svg>
      ),
      wave: ({ size = 32 }) => (
        <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
          <path d="M4 16 Q10 10, 16 16 T28 16" stroke="#066DB1" strokeWidth="2" fill="none" strokeLinecap="round" />
          <path d="M4 22 Q10 16, 16 22 T28 22" stroke="rgba(6, 109, 177, 0.5)" strokeWidth="1.5" fill="none" strokeLinecap="round" />
        </svg>
      ),
      compass: ({ size = 32 }) => (
        <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
          <circle cx="16" cy="16" r="10" stroke="#066DB1" strokeWidth="1.5" fill="rgba(6, 109, 177, 0.1)" />
          <path d="M16 16 L20 10 L16 12 L12 10 Z" fill="#066DB1" />
          <path d="M16 16 L12 22 L16 20 L20 22 Z" fill="rgba(6, 109, 177, 0.4)" />
        </svg>
      ),
      // More generic icons
      search: ({ size = 32 }) => (
        <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
          <circle cx="14" cy="14" r="8" stroke="#066DB1" strokeWidth="2" fill="rgba(6, 109, 177, 0.1)" />
          <line x1="20" y1="20" x2="26" y2="26" stroke="#066DB1" strokeWidth="2" strokeLinecap="round" />
        </svg>
      ),
      ruler: ({ size = 32 }) => (
        <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
          <rect x="4" y="12" width="24" height="8" rx="1" fill="rgba(6, 109, 177, 0.15)" stroke="#066DB1" strokeWidth="1.5" />
          <line x1="8" y1="12" x2="8" y2="16" stroke="#066DB1" strokeWidth="1.5" />
          <line x1="12" y1="12" x2="12" y2="14" stroke="#066DB1" strokeWidth="1" />
          <line x1="16" y1="12" x2="16" y2="16" stroke="#066DB1" strokeWidth="1.5" />
          <line x1="20" y1="12" x2="20" y2="14" stroke="#066DB1" strokeWidth="1" />
          <line x1="24" y1="12" x2="24" y2="16" stroke="#066DB1" strokeWidth="1.5" />
        </svg>
      ),
      diamond: ({ size = 32 }) => (
        <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
          <path d="M16 4 L26 14 L16 28 L6 14 Z" fill="rgba(6, 109, 177, 0.15)" stroke="#066DB1" strokeWidth="1.5" />
          <path d="M6 14 L16 18 L26 14" stroke="#066DB1" strokeWidth="1" fill="none" />
        </svg>
      ),
      scale: ({ size = 32 }) => (
        <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
          <line x1="16" y1="6" x2="16" y2="26" stroke="#066DB1" strokeWidth="2" />
          <line x1="6" y1="10" x2="26" y2="10" stroke="#066DB1" strokeWidth="2" />
          <path d="M6 10 L8 16 L4 16 Z" fill="rgba(6, 109, 177, 0.3)" stroke="#066DB1" strokeWidth="1" />
          <path d="M26 10 L28 16 L24 16 Z" fill="rgba(6, 109, 177, 0.3)" stroke="#066DB1" strokeWidth="1" />
        </svg>
      ),
      shield: ({ size = 32 }) => (
        <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
          <path d="M16 4 L26 8 L26 16 C26 22 21 26 16 28 C11 26 6 22 6 16 L6 8 Z"
            fill="rgba(6, 109, 177, 0.15)" stroke="#066DB1" strokeWidth="1.5" />
          <path d="M12 16 L15 19 L20 12" stroke="#066DB1" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" fill="none" />
        </svg>
      ),
      heart: ({ size = 32 }) => (
        <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
          <path d="M16 26 C10 22 4 17 4 11 C4 7 7 4 11 4 C13.5 4 15.5 5.5 16 7 C16.5 5.5 18.5 4 21 4 C25 4 28 7 28 11 C28 17 22 22 16 26 Z"
            fill="rgba(6, 109, 177, 0.2)" stroke="#066DB1" strokeWidth="1.5" />
        </svg>
      ),
      seedling: ({ size = 32 }) => (
        <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
          <path d="M16 28 L16 16" stroke="#768C12" strokeWidth="2" strokeLinecap="round" />
          <path d="M16 16 C16 12 12 10 8 10 C8 14 12 18 16 16" fill="rgba(118, 140, 18, 0.3)" stroke="#768C12" strokeWidth="1.5" />
          <path d="M16 12 C16 8 20 6 24 6 C24 10 20 14 16 12" fill="rgba(118, 140, 18, 0.3)" stroke="#768C12" strokeWidth="1.5" />
        </svg>
      ),
      hands: ({ size = 32 }) => (
        <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
          <path d="M8 20 C4 18 4 12 8 10 L12 14" stroke="#066DB1" strokeWidth="1.5" fill="none" strokeLinecap="round" />
          <path d="M24 20 C28 18 28 12 24 10 L20 14" stroke="#066DB1" strokeWidth="1.5" fill="none" strokeLinecap="round" />
          <circle cx="16" cy="16" r="4" fill="rgba(6, 109, 177, 0.2)" stroke="#066DB1" strokeWidth="1.5" />
        </svg>
      ),
      // Execution icons
      bolt: ({ size = 32 }) => (
        <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
          <path d="M18 4 L8 18 L14 18 L12 28 L24 12 L18 12 Z" fill="rgba(128, 43, 100, 0.25)" stroke="#802B64" strokeWidth="1.5" strokeLinejoin="round" />
        </svg>
      ),
      runner: ({ size = 32 }) => (
        <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
          <circle cx="20" cy="6" r="3" fill="rgba(128, 43, 100, 0.3)" stroke="#802B64" strokeWidth="1.5" />
          <path d="M12 28 L16 20 L12 16 L18 12 L24 14" stroke="#802B64" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" fill="none" />
          <path d="M8 18 L12 16" stroke="#802B64" strokeWidth="2" strokeLinecap="round" />
        </svg>
      ),
      bullseye: ({ size = 32 }) => (
        <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
          <circle cx="16" cy="16" r="12" stroke="rgba(128, 43, 100, 0.3)" strokeWidth="1.5" fill="none" />
          <circle cx="16" cy="16" r="8" stroke="rgba(128, 43, 100, 0.4)" strokeWidth="1.5" fill="none" />
          <circle cx="16" cy="16" r="4" stroke="rgba(128, 43, 100, 0.6)" strokeWidth="1.5" fill="none" />
          <circle cx="16" cy="16" r="2" fill="#802B64" />
        </svg>
      ),
      muscle: ({ size = 32 }) => (
        <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
          <path d="M8 24 L8 14 C8 10 12 8 16 10 C20 8 24 10 24 14 L24 24" stroke="#802B64" strokeWidth="2" strokeLinecap="round" fill="none" />
          <path d="M12 14 L12 20 M20 14 L20 20" stroke="#802B64" strokeWidth="2" strokeLinecap="round" />
        </svg>
      ),
      check: ({ size = 32 }) => (
        <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
          <circle cx="16" cy="16" r="12" fill="rgba(118, 140, 18, 0.15)" stroke="#768C12" strokeWidth="1.5" />
          <path d="M10 16 L14 20 L22 12" stroke="#768C12" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round" fill="none" />
        </svg>
      ),
      lock: ({ size = 32 }) => (
        <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
          <rect x="8" y="14" width="16" height="12" rx="2" fill="rgba(118, 140, 18, 0.15)" stroke="#768C12" strokeWidth="1.5" />
          <path d="M11 14 L11 10 C11 7 13 5 16 5 C19 5 21 7 21 10 L21 14" stroke="#768C12" strokeWidth="1.5" fill="none" />
          <circle cx="16" cy="20" r="2" fill="#768C12" />
        </svg>
      ),
      door: ({ size = 32 }) => (
        <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
          <rect x="8" y="4" width="16" height="24" rx="1" fill="rgba(118, 140, 18, 0.1)" stroke="#768C12" strokeWidth="1.5" />
          <circle cx="20" cy="16" r="1.5" fill="#768C12" />
          <path d="M8 28 L4 28 M24 28 L28 28" stroke="#768C12" strokeWidth="1.5" strokeLinecap="round" />
        </svg>
      ),
      refresh: ({ size = 32 }) => (
        <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
          <path d="M6 16 C6 10 10 6 16 6 C20 6 23 8 25 11" stroke="#768C12" strokeWidth="2" strokeLinecap="round" fill="none" />
          <path d="M26 16 C26 22 22 26 16 26 C12 26 9 24 7 21" stroke="#768C12" strokeWidth="2" strokeLinecap="round" fill="none" />
          <path d="M22 11 L26 11 L26 7" stroke="#768C12" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" fill="none" />
          <path d="M10 21 L6 21 L6 25" stroke="#768C12" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" fill="none" />
        </svg>
      ),
      // Development icons
      telescope: ({ size = 32 }) => (
        <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
          <path d="M4 20 L12 12 L16 16 L8 24 Z" fill="rgba(118, 140, 18, 0.2)" stroke="#768C12" strokeWidth="1.5" />
          <circle cx="22" cy="10" r="6" fill="rgba(118, 140, 18, 0.15)" stroke="#768C12" strokeWidth="1.5" />
          <line x1="16" y1="16" x2="18" y2="14" stroke="#768C12" strokeWidth="1.5" />
        </svg>
      ),
      galaxy: ({ size = 32 }) => (
        <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
          <ellipse cx="16" cy="16" rx="12" ry="6" stroke="#768C12" strokeWidth="1.5" fill="none" transform="rotate(-30 16 16)" />
          <ellipse cx="16" cy="16" rx="8" ry="4" stroke="rgba(118, 140, 18, 0.5)" strokeWidth="1" fill="none" transform="rotate(-30 16 16)" />
          <circle cx="16" cy="16" r="2" fill="#768C12" />
          <circle cx="22" cy="12" r="1" fill="rgba(118, 140, 18, 0.6)" />
          <circle cx="10" cy="18" r="1" fill="rgba(118, 140, 18, 0.6)" />
        </svg>
      ),
      lightbulb: ({ size = 32 }) => (
        <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
          <path d="M16 4 C10 4 6 9 6 14 C6 18 8 20 10 22 L10 26 L22 26 L22 22 C24 20 26 18 26 14 C26 9 22 4 16 4 Z"
            fill="rgba(118, 140, 18, 0.15)" stroke="#768C12" strokeWidth="1.5" />
          <line x1="11" y1="28" x2="21" y2="28" stroke="#768C12" strokeWidth="1.5" strokeLinecap="round" />
          <path d="M13 14 L16 18 L19 14" stroke="#768C12" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round" fill="none" />
        </svg>
      ),
      chart: ({ size = 32 }) => (
        <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
          <rect x="6" y="18" width="5" height="8" fill="rgba(118, 140, 18, 0.3)" stroke="#768C12" strokeWidth="1.5" />
          <rect x="13.5" y="12" width="5" height="14" fill="rgba(118, 140, 18, 0.4)" stroke="#768C12" strokeWidth="1.5" />
          <rect x="21" y="6" width="5" height="20" fill="rgba(118, 140, 18, 0.5)" stroke="#768C12" strokeWidth="1.5" />
        </svg>
      ),
      gear: ({ size = 32 }) => (
        <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
          <circle cx="16" cy="16" r="5" fill="rgba(118, 140, 18, 0.2)" stroke="#768C12" strokeWidth="1.5" />
          <path d="M16 4 L18 8 L14 8 Z M16 28 L14 24 L18 24 Z M4 16 L8 14 L8 18 Z M28 16 L24 18 L24 14 Z"
            fill="#768C12" />
          <path d="M7 7 L10 10 L8 12 Z M25 7 L22 10 L24 12 Z M7 25 L10 22 L8 20 Z M25 25 L22 22 L24 20 Z"
            fill="rgba(118, 140, 18, 0.6)" />
        </svg>
      ),
      trophy: ({ size = 32 }) => (
        <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
          <path d="M10 6 L22 6 L22 14 C22 18 19 22 16 22 C13 22 10 18 10 14 Z"
            fill="rgba(118, 140, 18, 0.2)" stroke="#768C12" strokeWidth="1.5" />
          <path d="M10 8 L6 8 L6 12 C6 14 8 16 10 16" stroke="#768C12" strokeWidth="1.5" fill="none" />
          <path d="M22 8 L26 8 L26 12 C26 14 24 16 22 16" stroke="#768C12" strokeWidth="1.5" fill="none" />
          <line x1="16" y1="22" x2="16" y2="26" stroke="#768C12" strokeWidth="1.5" />
          <rect x="12" y="26" width="8" height="2" fill="#768C12" />
        </svg>
      ),
      graduation: ({ size = 32 }) => (
        <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
          <path d="M4 14 L16 8 L28 14 L16 20 Z" fill="rgba(118, 140, 18, 0.2)" stroke="#768C12" strokeWidth="1.5" />
          <path d="M8 16 L8 22 C8 24 12 26 16 26 C20 26 24 24 24 22 L24 16" stroke="#768C12" strokeWidth="1.5" fill="none" />
          <line x1="28" y1="14" x2="28" y2="22" stroke="#768C12" strokeWidth="1.5" />
        </svg>
      ),
      // Adaptation icons
      anchor: ({ size = 32 }) => (
        <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
          <circle cx="16" cy="8" r="4" fill="rgba(6, 109, 177, 0.2)" stroke="#066DB1" strokeWidth="1.5" />
          <line x1="16" y1="12" x2="16" y2="28" stroke="#066DB1" strokeWidth="2" />
          <path d="M10 20 L16 28 L22 20" stroke="#066DB1" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" fill="none" />
          <line x1="10" y1="16" x2="22" y2="16" stroke="#066DB1" strokeWidth="2" strokeLinecap="round" />
        </svg>
      ),
      heartPulse: ({ size = 32 }) => (
        <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
          <path d="M16 26 C10 22 4 17 4 11 C4 7 7 4 11 4 C13.5 4 15.5 5.5 16 7 C16.5 5.5 18.5 4 21 4 C25 4 28 7 28 11 C28 17 22 22 16 26 Z"
            fill="rgba(6, 109, 177, 0.15)" stroke="#066DB1" strokeWidth="1.5" />
          <path d="M8 15 L12 15 L14 11 L16 19 L18 13 L20 15 L24 15" stroke="#066DB1" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round" fill="none" />
        </svg>
      ),
      temple: ({ size = 32 }) => (
        <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
          <path d="M6 26 L6 14 L16 6 L26 14 L26 26" fill="rgba(6, 109, 177, 0.1)" stroke="#066DB1" strokeWidth="1.5" />
          <line x1="10" y1="26" x2="10" y2="16" stroke="#066DB1" strokeWidth="1.5" />
          <line x1="16" y1="26" x2="16" y2="14" stroke="#066DB1" strokeWidth="1.5" />
          <line x1="22" y1="26" x2="22" y2="16" stroke="#066DB1" strokeWidth="1.5" />
          <line x1="4" y1="26" x2="28" y2="26" stroke="#066DB1" strokeWidth="2" />
        </svg>
      ),
      plant: ({ size = 32 }) => (
        <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
          <path d="M16 28 L16 14" stroke="#768C12" strokeWidth="2" strokeLinecap="round" />
          <path d="M16 20 C12 20 8 18 8 14 C8 10 12 8 16 10" fill="rgba(118, 140, 18, 0.3)" stroke="#768C12" strokeWidth="1.5" />
          <path d="M16 14 C20 14 24 12 24 8 C24 4 20 2 16 4" fill="rgba(118, 140, 18, 0.3)" stroke="#768C12" strokeWidth="1.5" />
        </svg>
      ),
      explosion: ({ size = 32 }) => (
        <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
          <path d="M16 4 L18 10 L24 6 L20 12 L28 14 L20 16 L24 22 L18 18 L16 26 L14 18 L8 22 L12 16 L4 14 L12 12 L8 6 L14 10 Z"
            fill="rgba(251, 146, 60, 0.2)" stroke="rgba(251, 146, 60, 0.8)" strokeWidth="1.5" strokeLinejoin="round" />
        </svg>
      ),
      fire: ({ size = 32 }) => (
        <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
          <path d="M16 4 C20 10 26 14 26 20 C26 24 22 28 16 28 C10 28 6 24 6 20 C6 14 12 10 16 4 Z"
            fill="rgba(251, 146, 60, 0.25)" stroke="rgba(251, 146, 60, 0.8)" strokeWidth="1.5" />
          <path d="M16 14 C18 18 20 20 20 22 C20 24 18 26 16 26 C14 26 12 24 12 22 C12 20 14 18 16 14 Z"
            fill="rgba(251, 146, 60, 0.4)" />
        </svg>
      ),
      tideWave: ({ size = 32 }) => (
        <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
          <path d="M4 20 Q8 14 12 18 T20 14 T28 18" stroke="#066DB1" strokeWidth="2" fill="none" strokeLinecap="round" />
          <path d="M4 14 Q8 8 12 12 T20 8 T28 12" stroke="rgba(6, 109, 177, 0.5)" strokeWidth="1.5" fill="none" strokeLinecap="round" />
          <path d="M4 26 Q8 20 12 24 T20 20 T28 24" stroke="rgba(6, 109, 177, 0.3)" strokeWidth="1.5" fill="none" strokeLinecap="round" />
        </svg>
      ),
      sword: ({ size = 32 }) => (
        <svg width={size} height={size} viewBox="0 0 32 32" fill="none">
          <path d="M20 4 L20 16 L16 20 L12 16 L12 4 Z" fill="rgba(128, 43, 100, 0.2)" stroke="#802B64" strokeWidth="1.5" />
          <line x1="16" y1="20" x2="16" y2="24" stroke="#802B64" strokeWidth="2" />
          <line x1="12" y1="24" x2="20" y2="24" stroke="#802B64" strokeWidth="2" strokeLinecap="round" />
          <line x1="16" y1="24" x2="16" y2="28" stroke="#802B64" strokeWidth="2" />
        </svg>
      )
    };

    // Map gift titles to icons
    const getGiftIcon = (title) => {
      const iconMap = {
        'Sets direction fast': GIFT_ICONS.target,
        'Rallies action': GIFT_ICONS.rocket,
        'Breaks drift': GIFT_ICONS.lightning,
        'Creates meaning': GIFT_ICONS.spark,
        'Earns buy-in': GIFT_ICONS.handshake,
        'Builds credibility': GIFT_ICONS.building,
        'Reduces resistance': GIFT_ICONS.wave,
        'Creates alignment': GIFT_ICONS.compass,
        'Surfaces issues': GIFT_ICONS.search,
        'Holds standards': GIFT_ICONS.ruler,
        'Creates transparency': GIFT_ICONS.diamond,
        'Builds accountability': GIFT_ICONS.scale,
        'Creates safety': GIFT_ICONS.shield,
        'Builds belonging': GIFT_ICONS.heart,
        'Protects capacity': GIFT_ICONS.seedling,
        'Enables honesty': GIFT_ICONS.hands,
        'Makes decisions': GIFT_ICONS.bolt,
        'Creates momentum': GIFT_ICONS.runner,
        'Gets outcomes': GIFT_ICONS.bullseye,
        'Owns it': GIFT_ICONS.muscle,
        'Ensures quality': GIFT_ICONS.check,
        'Reduces risk': GIFT_ICONS.lock,
        'Maintains options': GIFT_ICONS.door,
        'Adapts wisely': GIFT_ICONS.refresh,
        'Discovers possibilities': GIFT_ICONS.telescope,
        'Pushes boundaries': GIFT_ICONS.rocket,
        'Liberates thinking': GIFT_ICONS.galaxy,
        'Sparks curiosity': GIFT_ICONS.lightbulb,
        'Develops capability': GIFT_ICONS.chart,
        'Creates systems': GIFT_ICONS.gear,
        'Builds mastery': GIFT_ICONS.trophy,
        'Ensures practical impact': GIFT_ICONS.graduation,
        'Provides calm': GIFT_ICONS.anchor,
        'Protects wellbeing': GIFT_ICONS.heartPulse,
        'Preserves value': GIFT_ICONS.temple,
        'Creates sustainability': GIFT_ICONS.plant,
        'Breaks through': GIFT_ICONS.explosion,
        'Creates transformation': GIFT_ICONS.fire,
        'Maintains momentum': GIFT_ICONS.tideWave,
        'Tells hard truths': GIFT_ICONS.sword
      };
      return iconMap[title] || GIFT_ICONS.spark;
    };

    // ============================================================================
    // NEW RESULTS SECTION COMPONENTS
    // ============================================================================

    // Engine Section - Narrative + Cards
    const EngineSection = ({ cluster, clusterScores }) => {
      const narrative = ENGINE_NARRATIVES[cluster];
      const info = CLUSTER_INFO[cluster];
      const clusterName = CLUSTER_DESCRIPTIONS[cluster]?.name || cluster;

      const getClusterColor = (c) => {
        switch (c) {
          case 'DIRECTION': return COLORS.leadSelf;
          case 'TRUST': return COLORS.leadTeam;
          case 'EXECUTION': return COLORS.leadOrg;
          case 'DEVELOPMENT': return COLORS.leadSelf;
          case 'ADAPTATION': return COLORS.leadTeam;
          default: return COLORS.leadTeam;
        }
      };

      return (
        <section className="results-section">
          <div className="section-narrative">
            <h2 className="section-headline">
              <EngineIcon size={28} /> Your Engine: {clusterName}
            </h2>
            <p>{narrative.opening}</p>
            <p className="narrative-cost">{narrative.cost}</p>
            <p>{narrative.atBest}</p>
          </div>

          <p className="cards-eyebrow">What skills does this engine power?</p>
          <div className="section-cards three-col">
            {info.skills.map((skill, i) => {
              const domainClass = skill.domain === 'Lead Self' ? 'domain-lead-self' :
                                  skill.domain === 'Lead Team' ? 'domain-lead-team' : 'domain-lead-org';
              return (
                <div key={i} className={`summary-card gift-card ${domainClass} fade-in-up`} style={{ animationDelay: `${0.1 + i * 0.1}s` }}>
                  <span className="card-icon">
                    {skill.domain === 'Lead Self' ? <LeadSelfIcon size={32} /> :
                     skill.domain === 'Lead Team' ? <LeadTeamIcon size={32} /> :
                     <LeadOrgIcon size={32} />}
                  </span>
                  <div className="card-label">{skill.domain}</div>
                  <div className="card-title">{skill.name}</div>
                </div>
              );
            })}
          </div>
        </section>
      );
    };

    // Gifts Section - Narrative + Cards
    const GiftsSection = ({ persona }) => {
      const narrative = PERSONA_NARRATIVES[persona];
      const gifts = GIFTS_DATA[persona] || [];

      return (
        <section className="results-section">
          <div className="section-narrative">
            <h2 className="section-headline">
              <GiftsIcon size={28} /> What You Bring
            </h2>
            <p>{narrative.opening}</p>
            <p>{narrative.whatOthersSee}</p>
            <p className="narrative-cost">{narrative.theShadow}</p>
          </div>

          <p className="cards-eyebrow">What do others count on you for?</p>
          <div className="section-cards">
            {gifts.map((gift, i) => {
              const IconComponent = getGiftIcon(gift.title);
              return (
                <div key={i} className="summary-card gift-card fade-in-up" style={{ animationDelay: `${0.1 + i * 0.1}s` }}>
                  <span className="card-icon"><IconComponent size={32} /></span>
                  <div className="card-title">{gift.title}</div>
                  <div className="card-description">{gift.description}</div>
                </div>
              );
            })}
          </div>
        </section>
      );
    };

    // Style Section - Narrative + Axis Cards
    const StyleSection = ({ cluster, userAnswers }) => {
      const axes = AXIS_LABELS[cluster] || [];
      const questionIndices = PRIMARY_QUESTIONS[cluster] || [];

      return (
        <section className="results-section">
          <div className="section-narrative">
            <h2 className="section-headline">
              <TradeoffsIcon size={28} /> Your Leadership Tradeoffs
            </h2>
            <p>Every leadership decision involves tradeoffs between competing goods. There's no right answer—just your default pattern. Understanding where you naturally lean helps you recognize when to borrow from the other side.</p>
            <p>These aren't weaknesses to fix. They're tendencies to notice. The goal isn't balance for its own sake—it's knowing when your default serves you and when it doesn't.</p>
          </div>

          <p className="cards-eyebrow">Where do you default?</p>
          <div className="section-cards three-col">
            {axes.map((axis, i) => {
              const answer = userAnswers[questionIndices[i]];
              const isLeft = answer === 'A';
              const position = isLeft ? 18 : 82;

              return (
                <div key={i} className="summary-card axis-card fade-in-up" style={{ animationDelay: `${0.1 + i * 0.1}s` }}>
                  <div className="axis-skill-name">{axis.skill}</div>
                  <div className="axis-bar-container">
                    <span className={`axis-pole ${isLeft ? 'active' : ''}`}>{axis.left}</span>
                    <div className="axis-bar">
                      <div className="axis-marker" style={{ left: `${position}%` }} />
                    </div>
                    <span className={`axis-pole right ${!isLeft ? 'active' : ''}`}>{axis.right}</span>
                  </div>
                  <div className="axis-your-position">
                    {isLeft ? axis.leftSentence : axis.rightSentence}
                  </div>
                </div>
              );
            })}
          </div>
        </section>
      );
    };

    // Pressure Section - Narrative + Cards
    const PressureSection = ({ persona, pressurePersona }) => {
      const pressureNarrative = PRESSURE_NARRATIVES[pressurePersona];
      const warnings = WARNING_SIGNS[persona] || [];
      const personaData = Object.values(PERSONAS).flatMap(cluster => [cluster.A, cluster.B]).find(p => p.name === persona);
      const balanceMoves = personaData?.balanceMoves || [];

      return (
        <section className="results-section">
          <div className="section-narrative">
            <h2 className="section-headline">
              <PressureIcon size={28} /> Under Pressure: {pressurePersona}
            </h2>
            <p>{pressureNarrative}</p>
            <p>This isn't a flaw—it's your gift pushed too far. Under stress, we all over-rely on what usually works. The key is recognizing when you've crossed the line from strength to strain.</p>
          </div>

          <p className="cards-eyebrow">What to watch for and what to do?</p>
          <div className="section-cards">
            <div className="summary-card warning-card fade-in-up" style={{ animationDelay: '0.1s' }}>
              <span className="card-icon"><WarningIcon size={32} /></span>
              <div className="card-title">Warning Signs</div>
              <ul className="warning-list">
                {warnings.map((warning, i) => (
                  <li key={i}>
                    <span className="warning-icon">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                        <path d="M12 2L2 22h20L12 2z" stroke="#c9a227" strokeWidth="2" fill="none"/>
                        <path d="M12 10v4M12 18h.01" stroke="#c9a227" strokeWidth="2" strokeLinecap="round"/>
                      </svg>
                    </span>
                    {warning}
                  </li>
                ))}
              </ul>
            </div>

            <div className="summary-card balance-card fade-in-up" style={{ animationDelay: '0.2s' }}>
              <span className="card-icon"><BalanceIcon size={32} /></span>
              <div className="card-title">Moves to Stay Balanced</div>
              <ul className="balance-list">
                {balanceMoves.map((move, i) => (
                  <li key={i}>
                    <span className="balance-icon">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                        <path d="M5 12h14M12 5l7 7-7 7" stroke="#768C12" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
                      </svg>
                    </span>
                    {move}
                  </li>
                ))}
              </ul>
            </div>
          </div>
        </section>
      );
    };

    // Compatibility Section - Narrative + Cards
    const CompatSection = ({ persona, onViewPersonas }) => {
      const compatibility = COMPATIBILITY[persona];
      if (!compatibility) return null;

      const { worksWellWith, mayClashWith } = compatibility;

      // Handle clicking on a partner persona name
      const handlePersonaClick = (partnerPersona) => {
        if (onViewPersonas) {
          // Navigate to personas page with this persona pre-selected
          window.history.pushState({}, '', `?open=${encodeURIComponent(partnerPersona)}`);
          onViewPersonas();
        }
      };

      return (
        <section className="results-section">
          <div className="section-narrative">
            <h2 className="section-headline">
              <CompatibilityIcon size={28} /> Who You Work With
            </h2>
            <p>Your leadership style creates natural chemistry with some personas and friction with others. Neither is good or bad—awareness is what matters. Your best partnerships often come from people who complement your blind spots.</p>
            <p>The personas you clash with aren't wrong—they're just optimizing for different things. Understanding their lens helps you bridge the gap.</p>
          </div>

          <p className="cards-eyebrow">Who brings out your best — and tests your patience?</p>
          <div className="section-cards">
            <div className="summary-card partner-card fade-in-up" style={{ animationDelay: '0.1s' }}>
              <span className="card-icon"><PartnerIcon size={32} /></span>
              <div className="card-title">Natural Partners</div>
              {worksWellWith.slice(0, 2).map((partner, i) => (
                <div key={i} style={{ marginTop: i > 0 ? '1.25rem' : '0.75rem', paddingTop: i > 0 ? '1.25rem' : '0', borderTop: i > 0 ? '1px solid rgba(255,255,255,0.08)' : 'none' }}>
                  <div
                    className="compat-persona clickable-persona"
                    onClick={() => handlePersonaClick(partner.persona)}
                    style={{ cursor: 'pointer' }}
                  >
                    {partner.persona} →
                  </div>
                  <div className="compat-why">{partner.why}</div>
                </div>
              ))}
            </div>

            <div className="summary-card tension-card fade-in-up" style={{ animationDelay: '0.2s' }}>
              <span className="card-icon"><FrictionIcon size={32} /></span>
              <div className="card-title">Potential Friction</div>
              {mayClashWith.slice(0, 2).map((clash, i) => (
                <div key={i} style={{ marginTop: i > 0 ? '1.25rem' : '0.75rem', paddingTop: i > 0 ? '1.25rem' : '0', borderTop: i > 0 ? '1px solid rgba(255,255,255,0.08)' : 'none' }}>
                  <div
                    className="compat-persona clickable-persona"
                    onClick={() => handlePersonaClick(clash.persona)}
                    style={{ cursor: 'pointer' }}
                  >
                    {clash.persona} →
                  </div>
                  <div className="compat-why">{clash.why}</div>
                </div>
              ))}
            </div>
          </div>
        </section>
      );
    };

    // Custom useInView hook using native Intersection Observer
    const useInView = (options = {}) => {
      const [inView, setInView] = React.useState(false);
      const [hasTriggered, setHasTriggered] = React.useState(false);
      const ref = React.useRef(null);

      React.useEffect(() => {
        const element = ref.current;
        if (!element || (options.triggerOnce && hasTriggered)) return;

        const observer = new IntersectionObserver(
          ([entry]) => {
            if (entry.isIntersecting) {
              setInView(true);
              if (options.triggerOnce) {
                setHasTriggered(true);
                observer.unobserve(element);
              }
            } else if (!options.triggerOnce) {
              setInView(false);
            }
          },
          { threshold: options.threshold || 0.2 }
        );

        observer.observe(element);
        return () => observer.unobserve(element);
      }, [options.threshold, options.triggerOnce, hasTriggered]);

      return { ref, inView };
    };

    // Animated Card Wrapper
    const AnimatedCard = ({ children, delay = 0, className = '' }) => {
      const { ref, inView } = useInView({ threshold: 0.2, triggerOnce: true });

      return (
        <div
          ref={ref}
          className={`transition-all duration-700 ${className}`}
          style={{
            opacity: inView ? 1 : 0,
            transform: inView ? 'translateY(0)' : 'translateY(30px)',
            transitionDelay: `${delay}ms`
          }}
        >
          {children}
        </div>
      );
    };

    // Fixed Results Header
    const ResultsHeader = ({ persona, cluster }) => {
      const [isScrolled, setIsScrolled] = React.useState(false);

      React.useEffect(() => {
        const handleScroll = () => setIsScrolled(window.scrollY > 100);
        window.addEventListener('scroll', handleScroll);
        return () => window.removeEventListener('scroll', handleScroll);
      }, []);

      const getClusterColor = () => {
        switch (cluster) {
          case 'DIRECTION': return COLORS.leadSelf;
          case 'TRUST': return COLORS.leadTeam;
          case 'EXECUTION': return COLORS.leadOrg;
          case 'DEVELOPMENT': return COLORS.leadSelf;
          case 'ADAPTATION': return COLORS.leadTeam;
          default: return COLORS.leadTeam;
        }
      };

      return (
        <header
          className={`fixed top-0 left-0 right-0 z-50 transition-all duration-300 ${
            isScrolled ? 'bg-[#101322]/95 backdrop-blur-md shadow-lg' : 'bg-transparent'
          }`}
          style={{ padding: isScrolled ? '0.75rem 0' : '1rem 0' }}
        >
          <div className="max-w-4xl mx-auto px-6 flex justify-between items-center">
            <div className="flex items-center gap-3">
              <span className="text-white font-semibold spectral italic">{persona}</span>
              <span
                className="px-3 py-1 rounded-full text-xs font-medium uppercase tracking-wider"
                style={{
                  background: `${getClusterColor()}20`,
                  color: getClusterColor(),
                  border: `1px solid ${getClusterColor()}`
                }}
              >
                {cluster}
              </span>
            </div>
            <button
              className="px-4 py-2 rounded-lg text-sm font-medium text-white bg-white/10 border border-white/20 hover:bg-white/15 transition-colors"
              onClick={() => {
                const text = `I'm "${persona}" - my leadership engine is ${cluster}. Take the Leadership Tradeoffs Assessment!`;
                const url = window.location.href;
                window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(url)}&summary=${encodeURIComponent(text)}`, '_blank');
              }}
            >
              Share Results
            </button>
          </div>
        </header>
      );
    };

    // Persona Hero Card
    const PersonaHeroCard = ({ persona, cluster, clusterInfo }) => {
      const getClusterColor = () => {
        switch (cluster) {
          case 'DIRECTION': return COLORS.leadSelf;
          case 'TRUST': return COLORS.leadTeam;
          case 'EXECUTION': return COLORS.leadOrg;
          case 'DEVELOPMENT': return COLORS.leadSelf;
          case 'ADAPTATION': return COLORS.leadTeam;
          default: return COLORS.leadTeam;
        }
      };

      const ClusterIcon = CLUSTER_ICONS[cluster];

      return (
        <div className="min-h-screen flex flex-col justify-center items-center text-center relative overflow-hidden pt-20 pb-12 px-6">
          <div className="relative z-10 max-w-3xl">
            <p className="text-sm uppercase tracking-[0.2em] text-gray-400 mb-4 fustat">Your Leadership Persona</p>
            <h1
              className="text-5xl md:text-6xl lg:text-7xl font-bold mb-4"
              style={{
                fontFamily: "'Spectral', serif",
                fontStyle: 'italic',
                background: `linear-gradient(135deg, #ffffff, rgba(255,255,255,0.8))`,
                WebkitBackgroundClip: 'text',
                WebkitTextFillColor: 'transparent'
              }}
            >
              {persona}
            </h1>
            <p className="text-xl md:text-2xl text-gray-300 mb-8 spectral italic">{PERSONA_MOTTOS[persona]}</p>
            <div className="inline-flex items-center gap-3 px-6 py-3 rounded-full bg-white/10 border border-white/20 mb-12">
              <span className="text-gray-400 text-sm">Engine:</span>
              <span className="text-white font-semibold">{clusterInfo.name}</span>
              <span className="flex items-center">
                {ClusterIcon && <ClusterIcon size={32} color={getClusterColor()} />}
              </span>
            </div>
            <div className="flex flex-col items-center gap-2 text-gray-500 animate-bounce">
              <span className="text-sm">Scroll to explore</span>
              <span className="text-2xl">↓</span>
            </div>
          </div>
        </div>
      );
    };

    // Your Engine Card
    const YourEngineCard = ({ cluster, clusterScores }) => {
      const info = CLUSTER_INFO[cluster];
      const getClusterColor = (c) => {
        switch (c) {
          case 'DIRECTION': return COLORS.leadSelf;
          case 'TRUST': return COLORS.leadTeam;
          case 'EXECUTION': return COLORS.leadOrg;
          case 'DEVELOPMENT': return COLORS.leadSelf;
          case 'ADAPTATION': return COLORS.leadTeam;
          default: return COLORS.leadTeam;
        }
      };
      const getDomainColor = (domain) => {
        switch (domain) {
          case 'Lead Self': return COLORS.leadSelf;
          case 'Lead Team': return COLORS.leadTeam;
          case 'Lead the Org': return COLORS.leadOrg;
          default: return COLORS.leadTeam;
        }
      };

      return (
        <div className="p-8 md:p-10 rounded-3xl bg-white/5 backdrop-blur-sm border border-white/10 mb-8">
          <h2 className="text-2xl md:text-3xl font-bold mb-2 spectral italic">Your Leadership Engine</h2>
          <h3 className="text-xl font-bold mb-4" style={{ color: getClusterColor(cluster) }}>{cluster}</h3>
          <p className="text-gray-300 text-lg leading-relaxed mb-8 fustat">{info.description}</p>
          <div className="p-6 rounded-2xl bg-white/5 mb-8">
            <h4 className="text-lg font-semibold mb-6 text-white">Your Pattern Match</h4>
            <div className="space-y-4">
              {Object.entries(clusterScores).map(([clusterName, score]) => (
                <div key={clusterName}>
                  <div className="flex justify-between mb-2">
                    <span className="text-sm text-gray-400 capitalize">{clusterName.toLowerCase()}</span>
                    <span className="text-sm text-gray-500">{score}/15</span>
                  </div>
                  <div className="h-2 bg-white/10 rounded-full overflow-hidden">
                    <div
                      className="h-full rounded-full transition-all duration-1000"
                      style={{
                        width: `${(score / 15) * 100}%`,
                        background: `linear-gradient(90deg, ${getClusterColor(clusterName)}, ${getClusterColor(clusterName)}cc)`
                      }}
                    />
                  </div>
                </div>
              ))}
            </div>
          </div>
          <h4 className="text-lg font-semibold mb-4 text-white">Your Core Skills</h4>
          <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
            {info.skills.map((skill, i) => (
              <div key={i} className="p-5 rounded-xl bg-white/5 border border-white/10 text-center hover:bg-white/10 transition-colors">
                <div
                  className="w-12 h-12 mx-auto mb-3 rounded-full flex items-center justify-center"
                  style={{ background: `${getDomainColor(skill.domain)}20`, border: `2px solid ${getDomainColor(skill.domain)}` }}
                >
                  <span className="text-xl">{skill.domain === 'Lead Self' ? '👤' : skill.domain === 'Lead Team' ? '👥' : '🏢'}</span>
                </div>
                <p className="font-semibold text-white mb-1">{skill.name}</p>
                <p className="text-sm text-gray-500">{skill.domain}</p>
              </div>
            ))}
          </div>
        </div>
      );
    };

    // Your Gifts Card
    const YourGiftsCard = ({ persona }) => {
      const gifts = GIFTS_DATA[persona] || [];
      return (
        <div className="p-8 md:p-10 rounded-3xl bg-white/5 backdrop-blur-sm border border-white/10 mb-8">
          <h2 className="text-2xl md:text-3xl font-bold mb-8 spectral italic">✨ What You Bring at Your Best</h2>
          <div className="grid grid-cols-1 md:grid-cols-2 gap-5">
            {gifts.map((gift, i) => (
              <div key={i} className="p-6 rounded-2xl bg-white/5 border border-white/10 hover:bg-white/10 hover:border-white/20 hover:-translate-y-1 transition-all duration-300">
                <span className="text-4xl mb-4 block">{gift.icon}</span>
                <h3 className="text-lg font-bold text-white mb-2">{gift.title}</h3>
                <p className="text-gray-400 fustat">{gift.description}</p>
              </div>
            ))}
          </div>
        </div>
      );
    };

    // Your Risks Card
    const YourRisksCard = ({ persona }) => {
      const personaData = Object.values(PERSONAS).flatMap(cluster => [cluster.A, cluster.B]).find(p => p.name === persona);
      return (
        <div className="p-8 md:p-10 rounded-3xl bg-red-500/10 border border-red-500/20 mb-8">
          <h2 className="text-2xl md:text-3xl font-bold mb-6 text-red-400 spectral italic">⚠️ Watch For</h2>
          <p className="text-gray-300 text-lg leading-relaxed fustat">{personaData?.risks}</p>
        </div>
      );
    };

    // Your Style Card
    const YourStyleCard = ({ cluster, userAnswers }) => {
      const axes = AXIS_LABELS[cluster] || [];
      const questionIndices = PRIMARY_QUESTIONS[cluster] || [];

      return (
        <div className="p-8 md:p-10 rounded-3xl bg-white/5 backdrop-blur-sm border border-white/10 mb-8">
          <h2 className="text-2xl md:text-3xl font-bold mb-3 spectral italic">📊 Your Leadership Tradeoffs</h2>
          <p className="text-gray-400 mb-8 fustat">These patterns define your style. Neither pole is right or wrong—understanding your defaults helps you stay balanced.</p>
          <div className="space-y-8">
            {axes.map((axis, i) => {
              const answer = userAnswers[questionIndices[i]];
              const isLeft = answer === 'A';
              const position = isLeft ? 15 : 85;
              return (
                <div key={i} className="p-5 rounded-xl bg-white/5">
                  <div className="flex justify-between items-center mb-4">
                    <h3 className="text-lg font-semibold text-white spectral italic">{axis.skill}</h3>
                    <span className="px-3 py-1 rounded-full bg-white/10 text-sm text-gray-300">{isLeft ? axis.left : axis.right}</span>
                  </div>
                  <div className="flex items-center gap-4">
                    <span className={`text-sm min-w-[80px] ${isLeft ? 'text-white font-bold' : 'text-gray-500'}`}>{axis.left}</span>
                    <div className="flex-1 relative h-2 bg-white/15 rounded-full">
                      <div className="absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-0.5 h-4 bg-white/30" />
                      <div
                        className="absolute top-1/2 -translate-y-1/2 w-5 h-5 rounded-full shadow-lg transition-all duration-700"
                        style={{
                          left: `${position}%`,
                          transform: 'translate(-50%, -50%)',
                          background: `linear-gradient(135deg, ${COLORS.leadSelf}, ${COLORS.leadTeam}, ${COLORS.leadOrg})`,
                          boxShadow: '0 0 0 4px rgba(255,255,255,0.2), 0 4px 12px rgba(0,0,0,0.3)'
                        }}
                      />
                    </div>
                    <span className={`text-sm min-w-[80px] text-right ${!isLeft ? 'text-white font-bold' : 'text-gray-500'}`}>{axis.right}</span>
                  </div>
                </div>
              );
            })}
          </div>
        </div>
      );
    };

    // Under Pressure Card
    const UnderPressureCard = ({ persona, pressurePersona }) => {
      const pressureDesc = PRESSURE_DESCRIPTIONS[pressurePersona];
      const warnings = WARNING_SIGNS[persona] || [];
      return (
        <div className="p-8 md:p-10 rounded-3xl bg-orange-500/10 border border-orange-500/20 mb-8">
          <h2 className="text-2xl md:text-3xl font-bold mb-8 text-orange-400 spectral italic">🔥 Under Pressure</h2>
          <div className="grid grid-cols-1 md:grid-cols-3 gap-4 items-center mb-8">
            <div className="p-6 rounded-2xl bg-gradient-to-br from-green-500/20 to-blue-500/20 border border-white/10 text-center">
              <p className="text-xs uppercase tracking-wider text-gray-400 mb-2">At Your Best</p>
              <p className="text-xl font-bold text-white spectral italic">{persona}</p>
            </div>
            <div className="text-center text-3xl text-gray-500 hidden md:block">→</div>
            <div className="text-center text-2xl text-gray-500 md:hidden rotate-90">→</div>
            <div className="p-6 rounded-2xl bg-gradient-to-br from-orange-500/20 to-red-500/20 border border-orange-500/30 text-center">
              <p className="text-xs uppercase tracking-wider text-gray-400 mb-2">Under Stress</p>
              <p className="text-xl font-bold text-orange-400 spectral italic">{pressurePersona}</p>
            </div>
          </div>
          <div className="p-5 rounded-xl bg-orange-500/10 border-l-4 border-orange-500 mb-8">
            <p className="text-gray-300 text-lg leading-relaxed fustat">{pressureDesc}</p>
          </div>
          <h3 className="text-lg font-semibold text-white mb-4">Early Warning Signs</h3>
          <div className="space-y-3">
            {warnings.map((sign, i) => (
              <div key={i} className="flex items-start gap-4 p-4 rounded-xl bg-white/5">
                <span className="text-xl">⚠️</span>
                <p className="text-gray-300 fustat">{sign}</p>
              </div>
            ))}
          </div>
        </div>
      );
    };

    // Persona emoji mapping
    const PERSONA_EMOJIS = {
      'The Pathfinder': '🧭',
      'The Architect': '🏗️',
      'The Truth-Teller': '💎',
      'The Guardian': '🛡️',
      'The Driver': '🎯',
      'The Optimizer': '⚙️',
      'The Explorer': '🔭',
      'The Builder': '🔨',
      'The Stabilizer': '⚓',
      'The Disruptor': '💥'
    };

    // Expandable Compatibility Card Component
    const CompatibilityCard = ({ partnerPersona, relationship, data, userPersona }) => {
      const [isExpanded, setIsExpanded] = React.useState(false);
      const bgHover = relationship === 'partnership' ? 'hover:bg-blue-500/10' : 'hover:bg-purple-500/10';

      return (
        <div
          className={`rounded-2xl bg-white/5 border border-white/10 overflow-hidden transition-all duration-300 ${
            isExpanded ? 'bg-white/8 border-white/20' : ''
          } ${relationship === 'partnership' ? 'border-l-4 border-l-blue-500' : 'border-l-4 border-l-purple-500'}`}
        >
          <div className={`p-5 cursor-pointer transition-colors ${bgHover}`} onClick={() => setIsExpanded(!isExpanded)}>
            <div className="flex items-center gap-3 mb-3 pb-3 border-b border-white/10">
              <span className="text-3xl">{PERSONA_EMOJIS[partnerPersona]}</span>
              <span className="text-lg font-semibold text-white spectral italic">{partnerPersona}</span>
            </div>
            <p className={`text-sm text-gray-400 mb-4 fustat ${isExpanded ? '' : 'line-clamp-2'}`}>{data.why}</p>
            <button className="w-full py-2 px-4 rounded-lg bg-white/5 border border-white/10 text-sm font-medium text-gray-300 flex items-center justify-center gap-2 transition-all hover:bg-white/10 hover:border-white/20">
              <span>{isExpanded ? 'Show Less' : 'Learn More'}</span>
              <span className={`transition-transform duration-300 ${isExpanded ? 'rotate-180' : ''}`}>▼</span>
            </button>
          </div>
          {isExpanded && (
            <div className="px-5 pb-5 space-y-4">
              {relationship === 'partnership' ? (
                <React.Fragment>
                  <div>
                    <p className="text-xs uppercase tracking-wider text-gray-500 mb-1">What makes it work</p>
                    <p className="text-gray-300 text-sm fustat">{data.complementary}</p>
                  </div>
                  <div className="p-4 rounded-lg bg-white/5 border-l-2 border-blue-400/50">
                    <p className="text-gray-300 text-sm italic spectral">"{data.dynamic}"</p>
                  </div>
                  <div>
                    <p className="text-xs uppercase tracking-wider text-gray-500 mb-1">In action</p>
                    <p className="text-gray-400 text-sm fustat">{data.example}</p>
                  </div>
                </React.Fragment>
              ) : (
                <React.Fragment>
                  <div>
                    <p className="text-xs uppercase tracking-wider text-gray-500 mb-1">Competing priorities</p>
                    <p className="text-gray-300 text-sm fustat">{data.competing}</p>
                  </div>
                  <div>
                    <p className="text-xs uppercase tracking-wider text-gray-500 mb-2">What each needs to understand</p>
                    <div className="grid grid-cols-1 gap-2">
                      <div className="p-3 rounded-lg bg-green-500/10 border border-green-500/20">
                        <p className="text-xs font-semibold text-green-400 mb-1">You:</p>
                        <p className="text-xs text-gray-300 fustat">{data.yourNeed}</p>
                      </div>
                      <div className="p-3 rounded-lg bg-blue-500/10 border border-blue-500/20">
                        <p className="text-xs font-semibold text-blue-400 mb-1">Them:</p>
                        <p className="text-xs text-gray-300 fustat">{data.theirNeed}</p>
                      </div>
                    </div>
                  </div>
                  <div className="p-4 rounded-lg bg-white/5 border-l-2 border-green-400/50">
                    <p className="text-xs uppercase tracking-wider text-green-400 mb-1">How to bridge</p>
                    <p className="text-gray-300 text-sm fustat">{data.bridge}</p>
                  </div>
                </React.Fragment>
              )}
            </div>
          )}
        </div>
      );
    };

    // Unified Compatibility Section
    const CompatibilitySection = ({ persona }) => {
      const compatibility = COMPATIBILITY[persona];
      if (!compatibility) return null;

      return (
        <div className="p-8 md:p-10 rounded-3xl bg-white/5 backdrop-blur-sm border border-white/10 mb-8">
          <div className="text-center mb-10">
            <h2 className="text-2xl md:text-3xl font-bold mb-3 spectral italic">Your Leadership Relationships</h2>
            <p className="text-gray-400 fustat">Understanding these dynamics helps you build stronger partnerships and bridge gaps</p>
          </div>

          <div className="mb-10">
            <div className="text-center mb-6 pb-6 border-b border-white/10">
              <span className="text-4xl mb-3 block">🤝</span>
              <h3 className="text-xl font-bold text-blue-400 mb-2 spectral italic">Personas You Work Well With</h3>
              <p className="text-sm text-gray-500">These personas complement your strengths</p>
            </div>
            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
              {compatibility.worksWellWith.map((partner, i) => (
                <CompatibilityCard key={i} partnerPersona={partner.persona} relationship="partnership" data={partner} userPersona={persona} />
              ))}
            </div>
          </div>

          <div>
            <div className="text-center mb-6 pb-6 border-b border-white/10">
              <span className="text-4xl mb-3 block">⚡</span>
              <h3 className="text-xl font-bold text-purple-400 mb-2 spectral italic">Personas You May Clash With</h3>
              <p className="text-sm text-gray-500">Awareness helps you navigate these dynamics</p>
            </div>
            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
              {compatibility.mayClashWith.map((clash, i) => (
                <CompatibilityCard key={i} partnerPersona={clash.persona} relationship="tension" data={clash} userPersona={persona} />
              ))}
            </div>
          </div>
        </div>
      );
    };

    // Shareable Card Component
    const ShareableCard = ({ persona, cluster, clusterInfo, pressureInsight, cardRef }) => {
      const getClusterColor = () => {
        switch (cluster) {
          case 'DIRECTION': return COLORS.leadSelf;
          case 'TRUST': return COLORS.leadTeam;
          case 'EXECUTION': return COLORS.leadOrg;
          case 'DEVELOPMENT': return COLORS.leadSelf;
          case 'ADAPTATION': return COLORS.leadTeam;
          default: return COLORS.leadTeam;
        }
      };

      const clusterColor = getClusterColor();
      const ClusterIcon = CLUSTER_ICONS[cluster];

      return (
        <div
          ref={cardRef}
          className="shareable-card"
          style={{ background: `linear-gradient(135deg, rgba(16, 19, 34, 0.98), rgba(16, 19, 34, 0.92))` }}
        >
          {/* Gradient Overlay */}
          <div
            className="card-gradient-overlay"
            style={{ background: `linear-gradient(135deg, ${clusterColor}45 0%, ${clusterColor}12 100%)` }}
          />

          {/* Decorative Corner Elements */}
          <div className="corner-decoration top-left" />
          <div className="corner-decoration bottom-right" />

          {/* Cluster Accent Bar */}
          <div className="cluster-accent-bar" style={{ background: clusterColor }} />

          {/* Card Content */}
          <div className="card-inner">
            <div className="card-icon">
              {ClusterIcon && <ClusterIcon size={56} color="#ffffff" />}
            </div>
            <h1 className="card-persona-name">{persona}</h1>
            <p className="card-cluster-name">{clusterInfo.name}</p>

            {/* Enhanced Divider */}
            <div className="card-divider-wrapper">
              <div className="card-divider" />
              <div
                className="divider-accent"
                style={{ background: `linear-gradient(90deg, transparent 0%, ${clusterColor} 50%, transparent 100%)` }}
              />
            </div>

            <p className="card-insight">"{pressureInsight}"</p>
          </div>

          {/* Footer */}
          <div className="card-footer">
            <span className="card-brand">leaderfactor.com</span>
          </div>
        </div>
      );
    };

    // Share Section Component
    const ShareSection = ({ persona, cluster, clusterInfo, onRestart }) => {
      const [copySuccess, setCopySuccess] = React.useState(false);
      const [downloadSuccess, setDownloadSuccess] = React.useState(false);
      const cardRef = React.useRef(null);

      const pressureInsight = getPressureInsight(persona);
      const assessmentUrl = "https://leaderfactor.com/assessment";

      const getClusterColor = () => {
        switch (cluster) {
          case 'DIRECTION': return COLORS.leadSelf;
          case 'TRUST': return COLORS.leadTeam;
          case 'EXECUTION': return COLORS.leadOrg;
          case 'DEVELOPMENT': return COLORS.leadSelf;
          case 'ADAPTATION': return COLORS.leadTeam;
          default: return COLORS.leadTeam;
        }
      };

      // Download card as PNG using canvas
      const handleDownloadCard = async () => {
        if (!cardRef.current) return;

        try {
          const canvas = document.createElement('canvas');
          const ctx = canvas.getContext('2d');

          // Set canvas size - taller card (1200x720 for better aspect ratio)
          canvas.width = 1200;
          canvas.height = 720;

          const clusterColor = getClusterColor();

          // Draw background gradient
          const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
          gradient.addColorStop(0, '#101322');
          gradient.addColorStop(1, '#1a1d2e');
          ctx.fillStyle = gradient;
          ctx.fillRect(0, 0, canvas.width, canvas.height);

          // Draw cluster color overlay
          const overlayGradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
          overlayGradient.addColorStop(0, clusterColor + '50');
          overlayGradient.addColorStop(1, clusterColor + '15');
          ctx.fillStyle = overlayGradient;
          ctx.fillRect(0, 0, canvas.width, canvas.height);

          // Draw vignette effect
          const vignetteGradient = ctx.createRadialGradient(
            canvas.width / 2, canvas.height / 2, 0,
            canvas.width / 2, canvas.height / 2, canvas.width * 0.7
          );
          vignetteGradient.addColorStop(0, 'transparent');
          vignetteGradient.addColorStop(1, 'rgba(0, 0, 0, 0.25)');
          ctx.fillStyle = vignetteGradient;
          ctx.fillRect(0, 0, canvas.width, canvas.height);

          // Draw accent bar on left
          ctx.fillStyle = clusterColor;
          ctx.globalAlpha = 0.6;
          ctx.fillRect(0, 0, 6, canvas.height);
          ctx.globalAlpha = 1;

          // Draw corner decorations
          ctx.strokeStyle = 'rgba(255, 255, 255, 0.12)';
          ctx.lineWidth = 3;

          // Top-left corner
          ctx.beginPath();
          ctx.moveTo(40, 90);
          ctx.lineTo(40, 40);
          ctx.lineTo(90, 40);
          ctx.stroke();

          // Bottom-right corner
          ctx.beginPath();
          ctx.moveTo(canvas.width - 40, canvas.height - 90);
          ctx.lineTo(canvas.width - 40, canvas.height - 40);
          ctx.lineTo(canvas.width - 90, canvas.height - 40);
          ctx.stroke();

          // Draw cluster icon with glow effect
          ctx.shadowColor = 'rgba(255, 255, 255, 0.3)';
          ctx.shadowBlur = 30;
          const iconCenterX = canvas.width / 2;
          const iconCenterY = 130;
          const iconSize = 80;

          // Draw the appropriate cluster icon
          ctx.save();
          ctx.translate(iconCenterX - iconSize/2, iconCenterY - iconSize/2);

          if (cluster === 'DIRECTION') {
            // Compass icon
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.3)';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.arc(iconSize/2, iconSize/2, iconSize * 0.38, 0, Math.PI * 2);
            ctx.stroke();
            ctx.beginPath();
            ctx.arc(iconSize/2, iconSize/2, iconSize * 0.25, 0, Math.PI * 2);
            ctx.stroke();
            // North pointer
            ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';
            ctx.beginPath();
            ctx.moveTo(iconSize/2, iconSize * 0.12);
            ctx.lineTo(iconSize/2 + 4, iconSize * 0.38);
            ctx.lineTo(iconSize/2, iconSize * 0.33);
            ctx.lineTo(iconSize/2 - 4, iconSize * 0.38);
            ctx.closePath();
            ctx.fill();
            // South pointer
            ctx.fillStyle = 'rgba(255, 255, 255, 0.4)';
            ctx.beginPath();
            ctx.moveTo(iconSize/2, iconSize * 0.88);
            ctx.lineTo(iconSize/2 - 4, iconSize * 0.62);
            ctx.lineTo(iconSize/2, iconSize * 0.67);
            ctx.lineTo(iconSize/2 + 4, iconSize * 0.62);
            ctx.closePath();
            ctx.fill();
            // Center dot
            ctx.fillStyle = '#ffffff';
            ctx.beginPath();
            ctx.arc(iconSize/2, iconSize/2, 5, 0, Math.PI * 2);
            ctx.fill();
          } else if (cluster === 'TRUST') {
            // Connected figures icon
            ctx.fillStyle = 'rgba(255, 255, 255, 0.15)';
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.8)';
            ctx.lineWidth = 2;
            // Left head
            ctx.beginPath();
            ctx.arc(iconSize * 0.33, iconSize * 0.33, iconSize * 0.12, 0, Math.PI * 2);
            ctx.fill();
            ctx.stroke();
            // Right head
            ctx.beginPath();
            ctx.arc(iconSize * 0.67, iconSize * 0.33, iconSize * 0.12, 0, Math.PI * 2);
            ctx.fill();
            ctx.stroke();
            // Connection curve
            ctx.beginPath();
            ctx.moveTo(iconSize * 0.42, iconSize * 0.42);
            ctx.quadraticCurveTo(iconSize/2, iconSize * 0.52, iconSize * 0.58, iconSize * 0.42);
            ctx.stroke();
            // Body path
            ctx.fillStyle = 'rgba(255, 255, 255, 0.1)';
            ctx.beginPath();
            ctx.moveTo(iconSize * 0.2, iconSize * 0.8);
            ctx.quadraticCurveTo(iconSize * 0.2, iconSize * 0.6, iconSize * 0.33, iconSize * 0.55);
            ctx.quadraticCurveTo(iconSize * 0.45, iconSize * 0.58, iconSize/2, iconSize * 0.58);
            ctx.quadraticCurveTo(iconSize * 0.55, iconSize * 0.58, iconSize * 0.67, iconSize * 0.55);
            ctx.quadraticCurveTo(iconSize * 0.8, iconSize * 0.6, iconSize * 0.8, iconSize * 0.8);
            ctx.fill();
            ctx.stroke();
            // Center heart/connection dot
            ctx.fillStyle = 'rgba(255, 255, 255, 0.6)';
            ctx.beginPath();
            ctx.arc(iconSize/2, iconSize * 0.67, 5, 0, Math.PI * 2);
            ctx.fill();
          } else if (cluster === 'EXECUTION') {
            // Lightning bolt icon
            ctx.fillStyle = 'rgba(255, 255, 255, 0.2)';
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.9)';
            ctx.lineWidth = 2.5;
            ctx.beginPath();
            ctx.moveTo(iconSize * 0.58, iconSize * 0.08);
            ctx.lineTo(iconSize * 0.29, iconSize * 0.5);
            ctx.lineTo(iconSize * 0.46, iconSize * 0.5);
            ctx.lineTo(iconSize * 0.42, iconSize * 0.92);
            ctx.lineTo(iconSize * 0.71, iconSize * 0.46);
            ctx.lineTo(iconSize * 0.54, iconSize * 0.46);
            ctx.closePath();
            ctx.fill();
            ctx.stroke();
            // Spark dots
            ctx.fillStyle = 'rgba(255, 255, 255, 0.4)';
            ctx.beginPath();
            ctx.arc(iconSize * 0.2, iconSize * 0.25, 3, 0, Math.PI * 2);
            ctx.fill();
            ctx.beginPath();
            ctx.arc(iconSize * 0.8, iconSize * 0.75, 3, 0, Math.PI * 2);
            ctx.fill();
          } else if (cluster === 'DEVELOPMENT') {
            // Growing plant icon
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.9)';
            ctx.lineWidth = 3;
            // Stem
            ctx.beginPath();
            ctx.moveTo(iconSize/2, iconSize * 0.88);
            ctx.lineTo(iconSize/2, iconSize * 0.46);
            ctx.stroke();
            // Left leaf
            ctx.fillStyle = 'rgba(255, 255, 255, 0.2)';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(iconSize/2, iconSize * 0.58);
            ctx.quadraticCurveTo(iconSize * 0.33, iconSize * 0.58, iconSize * 0.29, iconSize * 0.42);
            ctx.quadraticCurveTo(iconSize * 0.29, iconSize * 0.29, iconSize/2, iconSize * 0.38);
            ctx.fill();
            ctx.stroke();
            // Right leaf
            ctx.beginPath();
            ctx.moveTo(iconSize/2, iconSize * 0.46);
            ctx.quadraticCurveTo(iconSize * 0.67, iconSize * 0.46, iconSize * 0.71, iconSize * 0.29);
            ctx.quadraticCurveTo(iconSize * 0.71, iconSize * 0.17, iconSize/2, iconSize * 0.25);
            ctx.fill();
            ctx.stroke();
            // Top bud
            ctx.fillStyle = 'rgba(255, 255, 255, 0.6)';
            ctx.beginPath();
            ctx.arc(iconSize * 0.71, iconSize * 0.12, 4, 0, Math.PI * 2);
            ctx.fill();
          } else if (cluster === 'ADAPTATION') {
            // Flowing cycle icon
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.8)';
            ctx.lineWidth = 2.5;
            // Top arrow curve
            ctx.beginPath();
            ctx.moveTo(iconSize * 0.17, iconSize/2);
            ctx.quadraticCurveTo(iconSize * 0.17, iconSize * 0.25, iconSize * 0.42, iconSize * 0.25);
            ctx.stroke();
            // Top arrow head
            ctx.beginPath();
            ctx.moveTo(iconSize * 0.42, iconSize * 0.17);
            ctx.lineTo(iconSize * 0.58, iconSize * 0.29);
            ctx.lineTo(iconSize * 0.42, iconSize * 0.33);
            ctx.stroke();
            // Bottom arrow curve
            ctx.beginPath();
            ctx.moveTo(iconSize * 0.83, iconSize/2);
            ctx.quadraticCurveTo(iconSize * 0.83, iconSize * 0.75, iconSize * 0.58, iconSize * 0.75);
            ctx.stroke();
            // Bottom arrow head
            ctx.beginPath();
            ctx.moveTo(iconSize * 0.58, iconSize * 0.83);
            ctx.lineTo(iconSize * 0.42, iconSize * 0.71);
            ctx.lineTo(iconSize * 0.58, iconSize * 0.67);
            ctx.stroke();
            // Center circle
            ctx.fillStyle = 'rgba(255, 255, 255, 0.3)';
            ctx.beginPath();
            ctx.arc(iconSize/2, iconSize/2, 8, 0, Math.PI * 2);
            ctx.fill();
            ctx.stroke();
            ctx.fillStyle = '#ffffff';
            ctx.beginPath();
            ctx.arc(iconSize/2, iconSize/2, 3, 0, Math.PI * 2);
            ctx.fill();
          }

          ctx.restore();
          ctx.shadowBlur = 0;

          // Draw persona name with text shadow
          ctx.shadowColor = 'rgba(0, 0, 0, 0.3)';
          ctx.shadowBlur = 12;
          ctx.shadowOffsetY = 2;
          ctx.font = 'italic bold 64px Spectral, Georgia, serif';
          ctx.fillStyle = '#ffffff';
          ctx.fillText(persona, canvas.width / 2, 270);
          ctx.shadowBlur = 0;
          ctx.shadowOffsetY = 0;

          // Draw cluster name
          ctx.font = '500 26px Fustat, sans-serif';
          ctx.fillStyle = 'rgba(255, 255, 255, 0.65)';
          ctx.fillText(clusterInfo.name.toUpperCase(), canvas.width / 2, 320);

          // Draw enhanced divider with gradient accent
          const dividerY = 380;
          ctx.beginPath();
          ctx.moveTo(canvas.width * 0.2, dividerY);
          ctx.lineTo(canvas.width * 0.8, dividerY);
          ctx.strokeStyle = 'rgba(255, 255, 255, 0.12)';
          ctx.lineWidth = 1;
          ctx.stroke();

          // Gradient accent on divider
          const accentGradient = ctx.createLinearGradient(canvas.width * 0.35, 0, canvas.width * 0.65, 0);
          accentGradient.addColorStop(0, 'transparent');
          accentGradient.addColorStop(0.5, clusterColor);
          accentGradient.addColorStop(1, 'transparent');
          ctx.beginPath();
          ctx.moveTo(canvas.width * 0.35, dividerY);
          ctx.lineTo(canvas.width * 0.65, dividerY);
          ctx.strokeStyle = accentGradient;
          ctx.lineWidth = 3;
          ctx.stroke();

          // Draw pressure insight with text shadow
          ctx.shadowColor = 'rgba(0, 0, 0, 0.2)';
          ctx.shadowBlur = 6;
          ctx.shadowOffsetY = 1;
          ctx.font = 'italic 32px Fustat, sans-serif';
          ctx.fillStyle = 'rgba(255, 255, 255, 0.92)';
          const insightText = '"' + pressureInsight + '"';
          ctx.fillText(insightText, canvas.width / 2, 460);
          ctx.shadowBlur = 0;
          ctx.shadowOffsetY = 0;

          // Draw footer line
          ctx.beginPath();
          ctx.moveTo(canvas.width * 0.3, 620);
          ctx.lineTo(canvas.width * 0.7, 620);
          ctx.strokeStyle = 'rgba(255, 255, 255, 0.08)';
          ctx.lineWidth = 1;
          ctx.stroke();

          // Draw footer text
          ctx.font = '500 22px Fustat, sans-serif';
          ctx.fillStyle = 'rgba(255, 255, 255, 0.5)';
          ctx.fillText('leaderfactor.com', canvas.width / 2, 665);

          // Download
          const link = document.createElement('a');
          link.download = 'my-leadership-pattern.png';
          link.href = canvas.toDataURL('image/png');
          link.click();

          setDownloadSuccess(true);
          setTimeout(() => setDownloadSuccess(false), 3000);
        } catch (error) {
          console.error('Download failed:', error);
        }
      };

      // Copy message to clipboard
      const handleCopyMessage = async () => {
        const message = `I just discovered I am ${persona}—my leadership engine is ${clusterInfo.name.toUpperCase()}.

${pressureInsight}

Want to discover your pattern? Takes 5 minutes:
${assessmentUrl}`;

        try {
          await navigator.clipboard.writeText(message);
          setCopySuccess(true);
          setTimeout(() => setCopySuccess(false), 3000);
        } catch (err) {
          const textArea = document.createElement('textarea');
          textArea.value = message;
          document.body.appendChild(textArea);
          textArea.select();
          document.execCommand('copy');
          document.body.removeChild(textArea);
          setCopySuccess(true);
          setTimeout(() => setCopySuccess(false), 3000);
        }
      };

      return (
        <section className="share-section">
          <div className="share-content">
            <h2 className="share-heading">Share Your Pattern</h2>

            {/* Card Preview */}
            <div className="card-preview-wrapper">
              <ShareableCard
                cardRef={cardRef}
                persona={persona}
                cluster={cluster}
                clusterInfo={clusterInfo}
                pressureInsight={pressureInsight}
              />
            </div>

            {/* Actions */}
            <div className="share-actions">
              <p className="share-prompt">Know someone who should discover their pattern?</p>

              <div className="action-buttons">
                <button className="share-button primary" onClick={handleDownloadCard}>
                  <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                    <path d="M10 3v10M10 13l-4-4M10 13l4-4M3 17h14" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
                  </svg>
                  Download Card
                </button>

                <button className="share-button secondary" onClick={handleCopyMessage}>
                  <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                    <rect x="6" y="6" width="10" height="10" rx="2" stroke="currentColor" strokeWidth="1.5" fill="none"/>
                    <path d="M4 14V4a2 2 0 012-2h10" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round"/>
                  </svg>
                  Copy Message
                </button>
              </div>

              {/* Success messages */}
              {downloadSuccess && (
                <div className="success-toast">
                  ✓ Card downloaded!
                </div>
              )}

              {copySuccess && (
                <div className="success-toast">
                  ✓ Message copied! Paste in LinkedIn, Slack, or email
                </div>
              )}
            </div>

            {/* Continue Section */}
            <div className="continue-section">
              <div className="continue-card">
                <h3 className="continue-title">Want to Go Deeper?</h3>
                <p className="continue-text">This mini-assessment reveals your patterns. LeaderFactor helps you develop them.</p>
                <a
                  href="https://www.leaderfactor.com"
                  target="_blank"
                  rel="noopener noreferrer"
                  className="continue-link"
                >
                  Explore LeaderFactor →
                </a>
                <button onClick={onRestart} className="retake-button">← Retake Assessment</button>
              </div>
            </div>

            <div className="share-footer">
              <p>© {new Date().getFullYear()} LeaderFactor. All rights reserved.</p>
            </div>
          </div>
        </section>
      );
    };

    // Floating Share Button
    const FloatingShareButton = ({ persona, cluster }) => {
      const [copied, setCopied] = React.useState(false);
      const assessmentUrl = window.location.href.split('?')[0];
      const shareMessage = `I just discovered I'm "${persona}" - take this 2-minute assessment to find your leadership pattern:`;

      const handleCopyLink = async () => {
        try {
          await navigator.clipboard.writeText(`${shareMessage}\n${assessmentUrl}`);
          setCopied(true);
          setTimeout(() => setCopied(false), 2000);
        } catch (err) {
          const textArea = document.createElement('textarea');
          textArea.value = `${shareMessage}\n${assessmentUrl}`;
          document.body.appendChild(textArea);
          textArea.select();
          document.execCommand('copy');
          document.body.removeChild(textArea);
          setCopied(true);
          setTimeout(() => setCopied(false), 2000);
        }
      };

      return (
        <div className="fixed bottom-6 right-6 z-40">
          <button
            onClick={handleCopyLink}
            className="w-14 h-14 rounded-full flex items-center justify-center text-white text-2xl shadow-lg transition-all hover:scale-110"
            style={{ background: copied ? '#22c55e' : `linear-gradient(135deg, ${COLORS.leadSelf}, ${COLORS.leadTeam}, ${COLORS.leadOrg})`, boxShadow: '0 8px 24px rgba(0,0,0,0.3)' }}
            title="Copy link to share"
          >
            {copied ? '✓' : '📋'}
          </button>
        </div>
      );
    };

    // Results Page Component - Scrollytelling Version
    const ResultsPage = ({ results, userName, onShare, onRestart, onViewPersonas }) => {
      const { persona, primaryCluster, clusterInfo, clusterScores, answers } = results;

      // Get user answers as array
      const getUserAnswersArray = () => {
        const storedAnswers = answers || [];
        const arr = [];
        for (let i = 1; i <= 15; i++) {
          const answer = storedAnswers.find((a) => a.questionId === i);
          arr.push(answer?.answer || 'A');
        }
        return arr;
      };

      // Get page gradient based on cluster
      const getPageGradient = () => {
        switch (primaryCluster) {
          case 'DIRECTION': return `linear-gradient(135deg, ${COLORS.leadSelf}30, ${COLORS.leadTeam}20)`;
          case 'TRUST': return `linear-gradient(135deg, ${COLORS.leadTeam}30, ${COLORS.leadSelf}20)`;
          case 'EXECUTION': return `linear-gradient(135deg, ${COLORS.leadOrg}30, ${COLORS.leadTeam}20)`;
          case 'DEVELOPMENT': return `linear-gradient(135deg, ${COLORS.leadSelf}30, ${COLORS.leadOrg}20)`;
          case 'ADAPTATION': return `linear-gradient(135deg, ${COLORS.leadTeam}30, ${COLORS.leadOrg}20)`;
          default: return `linear-gradient(135deg, ${COLORS.leadTeam}30, ${COLORS.leadSelf}20)`;
        }
      };

      // Scroll to top on mount
      React.useEffect(() => {
        window.scrollTo({ top: 0, behavior: 'smooth' });
      }, []);

      return (
        <div className="min-h-screen bg-[#101322] text-white relative">
          {/* Page-wide gradient background */}
          <div
            className="fixed inset-0 opacity-40 pointer-events-none"
            style={{ background: getPageGradient() }}
          />
          {/* Fixed Header */}
          <ResultsHeader persona={persona.name} cluster={primaryCluster} />

          {/* Floating Share Button */}
          <FloatingShareButton persona={persona.name} cluster={primaryCluster} />

          {/* Hero Card - Full Screen */}
          <PersonaHeroCard
            persona={persona.name}
            cluster={primaryCluster}
            clusterInfo={clusterInfo}
          />

          {/* Timeline Preview - What You'll Discover */}
          <TimelinePreview />

          {/* Results Sections - Narrative + Cards */}
          <div className="max-w-4xl mx-auto px-6 pb-12">
            <AnimatedCard delay={0}>
              <EngineSection
                cluster={primaryCluster}
                clusterScores={clusterScores}
              />
            </AnimatedCard>

            <AnimatedCard delay={100}>
              <GiftsSection persona={persona.name} />
            </AnimatedCard>

            <AnimatedCard delay={200}>
              <StyleSection
                cluster={primaryCluster}
                userAnswers={getUserAnswersArray()}
              />
            </AnimatedCard>

            <AnimatedCard delay={300}>
              <PressureSection
                persona={persona.name}
                pressurePersona={persona.pressurePersona}
              />
            </AnimatedCard>

            {COMPATIBILITY[persona.name] && (
              <AnimatedCard delay={400}>
                <CompatSection persona={persona.name} onViewPersonas={onViewPersonas} />
              </AnimatedCard>
            )}

            <AnimatedCard delay={500}>
              <ShareSection
                persona={persona.name}
                cluster={primaryCluster}
                clusterInfo={clusterInfo}
                onRestart={onRestart}
              />
            </AnimatedCard>
          </div>
        </div>
      );
    };

    // ============================================================================
    // EDUCATION SCREENS
    // ============================================================================

    // Cluster details for post-assessment reveals
    const CLUSTER_DETAILS = {
      DIRECTION: {
        tagline: "You're wired to set direction, rally action, and move toward the future",
        description: "You see where others should go and why it matters. You cut through drift with clarity and rally people toward a compelling future. At your best, you give teams purpose and momentum.",
        skills: ['Purpose (Lead Self)', 'Alignment (Lead Team)', 'Vision (Lead the Org)']
      },
      TRUST: {
        tagline: "You're wired to build safety, tell the truth, and create the conditions for trust",
        description: "You create environments where people can be honest and take risks. You balance care with accountability and build cultures where people feel they belong. At your best, you create psychological safety.",
        skills: ['Integrity (Lead Self)', 'Psychological Safety (Lead Team)', 'Culture (Lead the Org)']
      },
      EXECUTION: {
        tagline: "You're wired to own it, decide well, and deliver outcomes",
        description: "You turn strategy into action and get things done. You make decisions with incomplete information and drive accountability. At your best, you create focused momentum.",
        skills: ['Accountability (Lead Self)', 'Decision Making (Lead Team)', 'Strategy (Lead the Org)']
      },
      DEVELOPMENT: {
        tagline: "You're wired to learn, grow others, and build capability",
        description: "You develop people and systems for the long term. You balance exploration with proven methods and create conditions for innovation. At your best, you multiply capacity.",
        skills: ['Learning (Lead Self)', 'Coaching (Lead Team)', 'Innovation (Lead the Org)']
      },
      ADAPTATION: {
        tagline: "You're wired to stay steady, stay connected, and move people through change",
        description: "You read the room and respond to what's needed. You balance grit with recovery and help people navigate transitions. At your best, you create resilient teams.",
        skills: ['Resilience (Lead Self)', 'Emotional Intelligence (Lead Team)', 'Change (Lead the Org)']
      }
    };

    // Persona essences for reveals
    const PERSONA_ESSENCES = {
      'The Pathfinder': 'You set direction fast, rally action, and break drift.',
      'The Architect': 'You earn commitment, keep vision believable, and reduce resistance.',
      'The Truth-Teller': 'You surface real issues, hold standards high, and create honest environments.',
      'The Guardian': 'You protect psychological safety, build belonging, and create trust.',
      'The Driver': 'You make decisions, create momentum, and get outcomes.',
      'The Optimizer': 'You ensure quality, reduce risk, and make decisions that last.',
      'The Explorer': 'You discover new possibilities, expand options, and push creative boundaries.',
      'The Builder': 'You develop capability, create systems, and build for the long term.',
      'The Stabilizer': 'You maintain calm, protect capacity, and help people stay grounded.',
      'The Disruptor': 'You break through barriers, push past obstacles, and create transformation.'
    };

    // Pressure descriptions for reveals
    const PRESSURE_DESCRIPTIONS = {
      'The Crusader': 'Your meaning becomes mission at all costs. Your boldness becomes recklessness. Your clarity becomes rigidity.',
      'The Diplomat': 'Your buy-in becomes consensus paralysis. Your credibility becomes conservative. Your usefulness becomes transactional.',
      'The Enforcer': 'Your honesty becomes bluntness. Your courage becomes combativeness. Your standards become impossible bars.',
      'The Peacekeeper': 'Your care becomes over-protection. Your loyalty becomes enabling. Your belonging becomes conflict avoidance.',
      'The Steamroller': 'Your decisiveness becomes control. Your speed becomes rushing. Your focus becomes tunnel vision.',
      'The Perfectionist': 'Your thoroughness becomes paralysis. Your certainty-seeking becomes stalling. Your options become indecision.',
      'The Wanderer': 'Your curiosity becomes distraction. Your freedom becomes abandonment. Your novelty becomes scattered energy.',
      'The Taskmaster': 'Your structure becomes rigidity. Your standards become demands. Your practicality becomes narrow-mindedness.',
      'The Protector': 'Your stability becomes resistance to change. Your empathy becomes over-identification. Your preservation becomes stagnation.',
      'The Bulldozer': 'Your disruption becomes destruction. Your grit becomes grinding. Your directness becomes insensitivity.'
    };

    // ============================================================================
    // PERSONAS LIBRARY PAGE
    // ============================================================================

    // Persona Modal Component
    const PersonaModal = ({ persona, personaData, clusterColor, onClose }) => {
      // Close on ESC key
      useEffect(() => {
        const handleEsc = (e) => {
          if (e.key === 'Escape') onClose();
        };
        document.addEventListener('keydown', handleEsc);
        document.body.style.overflow = 'hidden';
        return () => {
          document.removeEventListener('keydown', handleEsc);
          document.body.style.overflow = '';
        };
      }, [onClose]);

      // Get persona and cluster icon components
      const PersonaIcon = PERSONA_ICONS[persona];
      const ClusterIcon = CLUSTER_ICONS[personaData.cluster];
      const clusterName = CLUSTER_DESCRIPTIONS[personaData.cluster]?.name || personaData.cluster;

      // Get pressure insight
      const pressureInsight = getPressureInsight(persona);

      return (
        <div className="persona-modal-overlay" onClick={onClose}>
          <div
            className="persona-modal"
            style={{ '--cluster-color': clusterColor }}
            onClick={(e) => e.stopPropagation()}
          >
            <button className="modal-close-btn" onClick={onClose}>
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M18 6L6 18M6 6l12 12" />
              </svg>
            </button>

            <div className="modal-content">
              {/* Hero Section */}
              <div className="modal-hero">
                {/* Main persona illustration - highest visual hierarchy */}
                <div className="modal-hero-icon">
                  {PersonaIcon && <PersonaIcon color={clusterColor} />}
                </div>
                <h1 className="modal-hero-name">{persona}</h1>
                {/* Cluster icon next to cluster name */}
                <div className="modal-hero-cluster-row">
                  <span className="modal-hero-cluster-icon">
                    {ClusterIcon && <ClusterIcon size={20} color={clusterColor} />}
                  </span>
                  <p className="modal-hero-cluster">{clusterName}</p>
                </div>
                <p className="modal-hero-tagline">"{personaData.tagline}"</p>
              </div>

              {/* Engine Section */}
              <div className="modal-section">
                <h2 className="modal-section-title">Engine: {clusterName}</h2>
                <p className="modal-section-text">{personaData.engineDescription}</p>
              </div>

              {/* Core Skills Section */}
              <div className="modal-section">
                <h2 className="modal-section-title">3 Core Skills That Drive This Engine</h2>
                <div className="modal-skills-grid">
                  {personaData.coreSkills.map((skill, i) => (
                    <div key={i} className="modal-skill-card">
                      <h3 className="modal-skill-name">{skill.name}</h3>
                      <p className="modal-skill-desc">{skill.description}</p>
                    </div>
                  ))}
                </div>
              </div>

              {/* Where They Lean Section */}
              <div className="modal-section">
                <h2 className="modal-section-title">Where They Lean</h2>
                <div className="modal-axis-list">
                  {personaData.axisPositions.map((axis, i) => {
                    const isLeft = axis.position === 'left';
                    const markerPosition = isLeft ? 20 : 80;
                    return (
                      <div key={i} className="modal-axis-item">
                        <p className="modal-axis-skill">{axis.skill}</p>
                        <div className="modal-axis-bar-container">
                          <span className={`modal-axis-pole ${isLeft ? 'active' : ''}`}>{axis.left}</span>
                          <div className="modal-axis-bar">
                            <div
                              className="modal-axis-marker"
                              style={{ left: `${markerPosition}%`, '--cluster-color': clusterColor }}
                            />
                          </div>
                          <span className={`modal-axis-pole right ${!isLeft ? 'active' : ''}`}>{axis.right}</span>
                        </div>
                      </div>
                    );
                  })}
                </div>
              </div>

              {/* Under Pressure Section */}
              <div className="modal-section">
                <h2 className="modal-section-title">Under Pressure</h2>
                <p className="modal-section-text">{personaData.pressureExplanation}</p>
                <div className="modal-warning-signs">
                  <p className="modal-warning-label">Warning signs:</p>
                  <ul className="modal-warning-list">
                    {personaData.warningSigns.map((sign, i) => (
                      <li key={i} className="modal-warning-item">{sign}</li>
                    ))}
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      );
    };

    // Personas Library Grid Card
    const PersonaLibraryCard = ({ persona, personaData, clusterColor, isUserPersona, onClick, delay }) => {
      const PersonaIcon = PERSONA_ICONS[persona];
      const ClusterIcon = CLUSTER_ICONS[personaData.cluster];
      const clusterName = CLUSTER_DESCRIPTIONS[personaData.cluster]?.name || personaData.cluster;

      return (
        <div
          className={`library-grid-card ${isUserPersona ? 'is-user-persona' : ''}`}
          style={{
            '--cluster-color': clusterColor,
            '--cluster-color-glow': clusterColor + '40',
            animationDelay: `${delay}s`
          }}
          onClick={onClick}
        >
          {isUserPersona && <span className="user-persona-badge">You</span>}
          {/* Main persona illustration - highest visual hierarchy */}
          <div className="library-card-persona-icon">
            {PersonaIcon && <PersonaIcon color={clusterColor} />}
          </div>
          <h3 className="library-card-name">{persona}</h3>
          {/* Engine icon next to cluster name */}
          <div className="library-card-cluster-row">
            <span className="library-card-cluster-icon">
              {ClusterIcon && <ClusterIcon size={20} color={clusterColor} />}
            </span>
            <p className="library-card-cluster">{clusterName}</p>
          </div>
        </div>
      );
    };

    // Personas Page Component
    const PersonasPage = ({ userPersona, onBack }) => {
      const [selectedPersona, setSelectedPersona] = useState(null);

      // Get cluster color helper
      const getClusterColor = (cluster) => {
        switch (cluster) {
          case 'DIRECTION': return COLORS.leadSelf;
          case 'TRUST': return COLORS.leadTeam;
          case 'EXECUTION': return COLORS.leadOrg;
          case 'DEVELOPMENT': return COLORS.leadSelf;
          case 'ADAPTATION': return COLORS.leadTeam;
          default: return COLORS.leadTeam;
        }
      };

      // All personas in order
      const allPersonas = [
        'The Pathfinder', 'The Architect',
        'The Guardian', 'The Truth-Teller',
        'The Driver', 'The Optimizer',
        'The Explorer', 'The Builder',
        'The Stabilizer', 'The Disruptor'
      ];

      // Check URL for pre-loaded persona on mount
      useEffect(() => {
        const params = new URLSearchParams(window.location.search);
        const openPersona = params.get('open');
        if (openPersona && PERSONA_LIBRARY[openPersona]) {
          setSelectedPersona(openPersona);
        }
      }, []);

      // Update URL when modal opens/closes
      useEffect(() => {
        if (selectedPersona) {
          const url = new URL(window.location);
          url.searchParams.set('open', selectedPersona);
          window.history.pushState({}, '', url);
        } else {
          const url = new URL(window.location);
          url.searchParams.delete('open');
          window.history.pushState({}, '', url);
        }
      }, [selectedPersona]);

      // Handle browser back/forward
      useEffect(() => {
        const handlePopState = () => {
          const params = new URLSearchParams(window.location.search);
          const openPersona = params.get('open');
          if (openPersona && PERSONA_LIBRARY[openPersona]) {
            setSelectedPersona(openPersona);
          } else {
            setSelectedPersona(null);
          }
        };
        window.addEventListener('popstate', handlePopState);
        return () => window.removeEventListener('popstate', handlePopState);
      }, []);

      return (
        <div className="personas-page">
          {/* Animated Background */}
          <div className="animated-background">
            <div className="bg-orb orb-1" />
            <div className="bg-orb orb-2" />
            <div className="bg-orb orb-3" />
          </div>

          <div className="personas-page-header">
            <button className="personas-back-link" onClick={onBack} type="button">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M19 12H5M12 19l-7-7 7-7" />
              </svg>
              Back to Your Results
            </button>
            <p className="personas-page-title">Understand Your Team</p>
            <h1 className="personas-page-subtitle">All 10 Leadership Personas</h1>
          </div>

          <div className="personas-library-grid">
            {allPersonas.map((persona, index) => {
              const personaData = PERSONA_LIBRARY[persona];
              if (!personaData) return null;
              const clusterColor = getClusterColor(personaData.cluster);
              return (
                <PersonaLibraryCard
                  key={persona}
                  persona={persona}
                  personaData={personaData}
                  clusterColor={clusterColor}
                  isUserPersona={persona === userPersona}
                  onClick={() => setSelectedPersona(persona)}
                  delay={index * 0.05}
                />
              );
            })}
          </div>

          {/* Modal */}
          {selectedPersona && PERSONA_LIBRARY[selectedPersona] && (
            <PersonaModal
              persona={selectedPersona}
              personaData={PERSONA_LIBRARY[selectedPersona]}
              clusterColor={getClusterColor(PERSONA_LIBRARY[selectedPersona].cluster)}
              onClose={() => setSelectedPersona(null)}
            />
          )}
        </div>
      );
    };

    // ============================================================================
    // MAIN APP
    // ============================================================================

    function App() {
      const [view, setView] = useState('landing');
      const [currentQuestion, setCurrentQuestion] = useState(0);
      const [answers, setAnswers] = useState([]);
      const [userData, setUserData] = useState({ name: '', email: '' });
      const [results, setResults] = useState(null);
      const [isTransitioning, setIsTransitioning] = useState(false);

      // Navigate to next view with transition
      const navigateTo = (nextView) => {
        setIsTransitioning(true);
        setTimeout(() => {
          setView(nextView);
          setIsTransitioning(false);
        }, 300);
      };

      const handleStart = () => {
        navigateTo('pre-1');
      };

      const handleAnswer = useCallback(
        (answer) => {
          const question = QUESTIONS[currentQuestion];
          const newAnswer = {
            questionId: question.id,
            skill: question.skill,
            domain: question.domain,
            axis: question.axis,
            answer: answer,
            pole: answer === 'A' ? question.poleA : question.poleB,
          };

          const existingIndex = answers.findIndex((a) => a.questionId === question.id);
          let newAnswers;
          if (existingIndex >= 0) {
            newAnswers = [...answers];
            newAnswers[existingIndex] = newAnswer;
          } else {
            newAnswers = [...answers, newAnswer];
          }
          setAnswers(newAnswers);

          setTimeout(() => {
            if (currentQuestion < QUESTIONS.length - 1) {
              setIsTransitioning(true);
              setTimeout(() => {
                setCurrentQuestion(currentQuestion + 1);
                setIsTransitioning(false);
              }, 200);
            } else {
              // Calculate results and go to post-assessment screens
              const calculatedResults = calculateResults(newAnswers);
              setResults(calculatedResults);
              navigateTo('calculating');
            }
          }, 400);
        },
        [currentQuestion, answers]
      );

      const handleShare = (platform, text) => {
        const url = window.location.href;
        let shareUrl;

        if (platform === 'linkedin') {
          shareUrl = `https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(url)}&summary=${encodeURIComponent(text)}`;
        } else if (platform === 'twitter') {
          shareUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(url)}`;
        }

        window.open(shareUrl, '_blank', 'width=600,height=400');
      };

      const handleRestart = () => {
        setIsTransitioning(true);
        setTimeout(() => {
          setView('landing');
          setCurrentQuestion(0);
          setAnswers([]);
          setResults(null);
          setIsTransitioning(false);
        }, 300);
      };

      // Handle going back to previous question or exiting assessment
      const handleQuestionBack = () => {
        if (currentQuestion === 0) {
          // Exit to last pre-assessment screen
          navigateTo('pre-3');
        } else {
          // Go to previous question
          setIsTransitioning(true);
          setTimeout(() => {
            setCurrentQuestion(currentQuestion - 1);
            setIsTransitioning(false);
          }, 200);
        }
      };

      const getCurrentAnswer = () => {
        const answer = answers.find((a) => a.questionId === QUESTIONS[currentQuestion]?.id);
        return answer?.answer || null;
      };

      return (
        <div
          className={`transition-opacity duration-300 ${isTransitioning ? 'opacity-0' : 'opacity-100'}`}
          style={{ fontFamily: "'Fustat', sans-serif" }}
        >
          {view === 'landing' && (
            <LandingPage onStart={handleStart} userData={userData} setUserData={setUserData} />
          )}

          {view === 'pre-1' && (
            <PreAssessmentScreen
              screenNumber={1}
              onContinue={() => navigateTo('pre-2')}
              onBack={() => navigateTo('landing')}
            />
          )}

          {view === 'pre-2' && (
            <PreAssessmentScreen
              screenNumber={2}
              onContinue={() => navigateTo('pre-3')}
              onBack={() => navigateTo('pre-1')}
            />
          )}

          {view === 'pre-3' && (
            <PreAssessmentScreen
              screenNumber={3}
              onContinue={() => navigateTo('assessment')}
              onBack={() => navigateTo('pre-2')}
            />
          )}

          {view === 'assessment' && (
            <QuestionView
              question={QUESTIONS[currentQuestion]}
              questionNumber={currentQuestion + 1}
              totalQuestions={QUESTIONS.length}
              onAnswer={handleAnswer}
              currentAnswer={getCurrentAnswer()}
              onBack={handleQuestionBack}
            />
          )}

          {view === 'calculating' && (
            <CalculatingScreen onComplete={() => navigateTo('progressive-reveal')} />
          )}

          {view === 'progressive-reveal' && results && (
            <ProgressiveRevealScreen userCluster={results.primaryCluster} onContinue={() => navigateTo('results')} />
          )}

          {view === 'results' && results && (
            <ResultsPage
              results={results}
              userName={userData.name}
              onShare={handleShare}
              onRestart={handleRestart}
              onViewPersonas={() => navigateTo('personas')}
            />
          )}

          {view === 'personas' && results && (
            <PersonasPage
              userPersona={results.persona.name}
              onBack={() => navigateTo('results')}
            />
          )}
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
